import{b2 as kv,b3 as xi,b5 as Wv,b7 as nd,bJ as Gv}from"./index-0fa04194.js";import{e as $r,D as Zc}from"./events-7d4b95ce.js";import{r as Kr,s as eu,a as tu,d as ru,f as Pa,g as iu,c as Yv,b as Ta,e as sd,h as nu}from"./index-19d165f1.js";import{c as su,g as ad,a as Jv,b as Xv}from"./index-fe16ceb5.js";import"./tslib.es6-c2094241.js";let Qv=class{};class Zv extends Qv{constructor(){super()}}class em extends Zv{constructor(t){super()}}const tm="^https?:",rm="^wss?:";function im(n){const t=n.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function od(n,t){const r=im(n);return typeof r>"u"?!1:new RegExp(t).test(r)}function xl(n){return od(n,tm)}function Ol(n){return od(n,rm)}function nm(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function cd(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function au(n){return cd(n)&&"method"in n}function Na(n){return cd(n)&&(di(n)||Hr(n))}function di(n){return"result"in n}function Hr(n){return"error"in n}var ou={},Ua={},$e={},ud={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function t(f,w){var O=f>>>16&65535,I=f&65535,P=w>>>16&65535,$=w&65535;return I*$+(O*$+I*P<<16>>>0)|0}n.mul=Math.imul||t;function r(f,w){return f+w|0}n.add=r;function s(f,w){return f-w|0}n.sub=s;function o(f,w){return f<<w|f>>>32-w}n.rotl=o;function l(f,w){return f<<32-w|f>>>w}n.rotr=l;function m(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}n.isInteger=Number.isInteger||m,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(f){return n.isInteger(f)&&f>=-n.MAX_SAFE_INTEGER&&f<=n.MAX_SAFE_INTEGER}})(ud);Object.defineProperty($e,"__esModule",{value:!0});var hd=ud;function sm(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])<<16>>16}$e.readInt16BE=sm;function am(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])>>>0}$e.readUint16BE=am;function om(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])<<16>>16}$e.readInt16LE=om;function cm(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])>>>0}$e.readUint16LE=cm;function ld(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>8,t[r+1]=n>>>0,t}$e.writeUint16BE=ld;$e.writeInt16BE=ld;function fd(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t}$e.writeUint16LE=fd;$e.writeInt16LE=fd;function Rc(n,t){return t===void 0&&(t=0),n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]}$e.readInt32BE=Rc;function Fc(n,t){return t===void 0&&(t=0),(n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3])>>>0}$e.readUint32BE=Fc;function $c(n,t){return t===void 0&&(t=0),n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]}$e.readInt32LE=$c;function Lc(n,t){return t===void 0&&(t=0),(n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t])>>>0}$e.readUint32LE=Lc;function Sa(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>24,t[r+1]=n>>>16,t[r+2]=n>>>8,t[r+3]=n>>>0,t}$e.writeUint32BE=Sa;$e.writeInt32BE=Sa;function Ia(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t[r+2]=n>>>16,t[r+3]=n>>>24,t}$e.writeUint32LE=Ia;$e.writeInt32LE=Ia;function um(n,t){t===void 0&&(t=0);var r=Rc(n,t),s=Rc(n,t+4);return r*4294967296+s-(s>>31)*4294967296}$e.readInt64BE=um;function hm(n,t){t===void 0&&(t=0);var r=Fc(n,t),s=Fc(n,t+4);return r*4294967296+s}$e.readUint64BE=hm;function lm(n,t){t===void 0&&(t=0);var r=$c(n,t),s=$c(n,t+4);return s*4294967296+r-(r>>31)*4294967296}$e.readInt64LE=lm;function fm(n,t){t===void 0&&(t=0);var r=Lc(n,t),s=Lc(n,t+4);return s*4294967296+r}$e.readUint64LE=fm;function dd(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Sa(n/4294967296>>>0,t,r),Sa(n>>>0,t,r+4),t}$e.writeUint64BE=dd;$e.writeInt64BE=dd;function pd(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Ia(n>>>0,t,r),Ia(n/4294967296>>>0,t,r+4),t}$e.writeUint64LE=pd;$e.writeInt64LE=pd;function dm(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,l=n/8+r-1;l>=r;l--)s+=t[l]*o,o*=256;return s}$e.readUintBE=dm;function pm(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,l=r;l<r+n/8;l++)s+=t[l]*o,o*=256;return s}$e.readUintLE=pm;function gm(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!hd.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var o=1,l=n/8+s-1;l>=s;l--)r[l]=t/o&255,o*=256;return r}$e.writeUintBE=gm;function ym(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!hd.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var o=1,l=s;l<s+n/8;l++)r[l]=t/o&255,o*=256;return r}$e.writeUintLE=ym;function _m(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t)}$e.readFloat32BE=_m;function vm(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t,!0)}$e.readFloat32LE=vm;function mm(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t)}$e.readFloat64BE=mm;function bm(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t,!0)}$e.readFloat64LE=bm;function wm(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n),t}$e.writeFloat32BE=wm;function Em(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n,!0),t}$e.writeFloat32LE=Em;function Dm(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n),t}$e.writeFloat64BE=Dm;function Sm(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n,!0),t}$e.writeFloat64LE=Sm;var Dr={};Object.defineProperty(Dr,"__esModule",{value:!0});function Im(n){for(var t=0;t<n.length;t++)n[t]=0;return n}Dr.wipe=Im;Object.defineProperty(Ua,"__esModule",{value:!0});var Qt=$e,Mc=Dr,xm=20;function Om(n,t,r){for(var s=1634760805,o=857760878,l=2036477234,m=1797285236,f=r[3]<<24|r[2]<<16|r[1]<<8|r[0],w=r[7]<<24|r[6]<<16|r[5]<<8|r[4],O=r[11]<<24|r[10]<<16|r[9]<<8|r[8],I=r[15]<<24|r[14]<<16|r[13]<<8|r[12],P=r[19]<<24|r[18]<<16|r[17]<<8|r[16],$=r[23]<<24|r[22]<<16|r[21]<<8|r[20],R=r[27]<<24|r[26]<<16|r[25]<<8|r[24],N=r[31]<<24|r[30]<<16|r[29]<<8|r[28],z=t[3]<<24|t[2]<<16|t[1]<<8|t[0],L=t[7]<<24|t[6]<<16|t[5]<<8|t[4],Q=t[11]<<24|t[10]<<16|t[9]<<8|t[8],d=t[15]<<24|t[14]<<16|t[13]<<8|t[12],b=s,y=o,v=l,p=m,c=f,_=w,K=O,G=I,se=P,ce=$,de=R,S=N,C=z,te=L,X=Q,k=d,W=0;W<xm;W+=2)b=b+c|0,C^=b,C=C>>>32-16|C<<16,se=se+C|0,c^=se,c=c>>>32-12|c<<12,y=y+_|0,te^=y,te=te>>>32-16|te<<16,ce=ce+te|0,_^=ce,_=_>>>32-12|_<<12,v=v+K|0,X^=v,X=X>>>32-16|X<<16,de=de+X|0,K^=de,K=K>>>32-12|K<<12,p=p+G|0,k^=p,k=k>>>32-16|k<<16,S=S+k|0,G^=S,G=G>>>32-12|G<<12,v=v+K|0,X^=v,X=X>>>32-8|X<<8,de=de+X|0,K^=de,K=K>>>32-7|K<<7,p=p+G|0,k^=p,k=k>>>32-8|k<<8,S=S+k|0,G^=S,G=G>>>32-7|G<<7,y=y+_|0,te^=y,te=te>>>32-8|te<<8,ce=ce+te|0,_^=ce,_=_>>>32-7|_<<7,b=b+c|0,C^=b,C=C>>>32-8|C<<8,se=se+C|0,c^=se,c=c>>>32-7|c<<7,b=b+_|0,k^=b,k=k>>>32-16|k<<16,de=de+k|0,_^=de,_=_>>>32-12|_<<12,y=y+K|0,C^=y,C=C>>>32-16|C<<16,S=S+C|0,K^=S,K=K>>>32-12|K<<12,v=v+G|0,te^=v,te=te>>>32-16|te<<16,se=se+te|0,G^=se,G=G>>>32-12|G<<12,p=p+c|0,X^=p,X=X>>>32-16|X<<16,ce=ce+X|0,c^=ce,c=c>>>32-12|c<<12,v=v+G|0,te^=v,te=te>>>32-8|te<<8,se=se+te|0,G^=se,G=G>>>32-7|G<<7,p=p+c|0,X^=p,X=X>>>32-8|X<<8,ce=ce+X|0,c^=ce,c=c>>>32-7|c<<7,y=y+K|0,C^=y,C=C>>>32-8|C<<8,S=S+C|0,K^=S,K=K>>>32-7|K<<7,b=b+_|0,k^=b,k=k>>>32-8|k<<8,de=de+k|0,_^=de,_=_>>>32-7|_<<7;Qt.writeUint32LE(b+s|0,n,0),Qt.writeUint32LE(y+o|0,n,4),Qt.writeUint32LE(v+l|0,n,8),Qt.writeUint32LE(p+m|0,n,12),Qt.writeUint32LE(c+f|0,n,16),Qt.writeUint32LE(_+w|0,n,20),Qt.writeUint32LE(K+O|0,n,24),Qt.writeUint32LE(G+I|0,n,28),Qt.writeUint32LE(se+P|0,n,32),Qt.writeUint32LE(ce+$|0,n,36),Qt.writeUint32LE(de+R|0,n,40),Qt.writeUint32LE(S+N|0,n,44),Qt.writeUint32LE(C+z|0,n,48),Qt.writeUint32LE(te+L|0,n,52),Qt.writeUint32LE(X+Q|0,n,56),Qt.writeUint32LE(k+d|0,n,60)}function gd(n,t,r,s,o){if(o===void 0&&(o=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<r.length)throw new Error("ChaCha: destination is shorter than source");var l,m;if(o===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");l=new Uint8Array(16),m=l.length-t.length,l.set(t,m)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");l=t,m=o}for(var f=new Uint8Array(64),w=0;w<r.length;w+=64){Om(f,l,n);for(var O=w;O<w+64&&O<r.length;O++)s[O]=r[O]^f[O-w];Cm(l,0,m)}return Mc.wipe(f),o===0&&Mc.wipe(l),s}Ua.streamXOR=gd;function Am(n,t,r,s){return s===void 0&&(s=0),Mc.wipe(r),gd(n,t,r,r,s)}Ua.stream=Am;function Cm(n,t,r){for(var s=1;r--;)s=s+(n[t]&255)|0,n[t]=s&255,s>>>=8,t++;if(s>0)throw new Error("ChaCha: counter overflow")}var yd={},Ai={};Object.defineProperty(Ai,"__esModule",{value:!0});function Pm(n,t,r){return~(n-1)&t|n-1&r}Ai.select=Pm;function Tm(n,t){return(n|0)-(t|0)-1>>>31&1}Ai.lessOrEqual=Tm;function _d(n,t){if(n.length!==t.length)return 0;for(var r=0,s=0;s<n.length;s++)r|=n[s]^t[s];return 1&r-1>>>8}Ai.compare=_d;function Nm(n,t){return n.length===0||t.length===0?!1:_d(n,t)!==0}Ai.equal=Nm;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Ai,r=Dr;n.DIGEST_LENGTH=16;var s=function(){function m(f){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var w=f[0]|f[1]<<8;this._r[0]=w&8191;var O=f[2]|f[3]<<8;this._r[1]=(w>>>13|O<<3)&8191;var I=f[4]|f[5]<<8;this._r[2]=(O>>>10|I<<6)&7939;var P=f[6]|f[7]<<8;this._r[3]=(I>>>7|P<<9)&8191;var $=f[8]|f[9]<<8;this._r[4]=(P>>>4|$<<12)&255,this._r[5]=$>>>1&8190;var R=f[10]|f[11]<<8;this._r[6]=($>>>14|R<<2)&8191;var N=f[12]|f[13]<<8;this._r[7]=(R>>>11|N<<5)&8065;var z=f[14]|f[15]<<8;this._r[8]=(N>>>8|z<<8)&8191,this._r[9]=z>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return m.prototype._blocks=function(f,w,O){for(var I=this._fin?0:2048,P=this._h[0],$=this._h[1],R=this._h[2],N=this._h[3],z=this._h[4],L=this._h[5],Q=this._h[6],d=this._h[7],b=this._h[8],y=this._h[9],v=this._r[0],p=this._r[1],c=this._r[2],_=this._r[3],K=this._r[4],G=this._r[5],se=this._r[6],ce=this._r[7],de=this._r[8],S=this._r[9];O>=16;){var C=f[w+0]|f[w+1]<<8;P+=C&8191;var te=f[w+2]|f[w+3]<<8;$+=(C>>>13|te<<3)&8191;var X=f[w+4]|f[w+5]<<8;R+=(te>>>10|X<<6)&8191;var k=f[w+6]|f[w+7]<<8;N+=(X>>>7|k<<9)&8191;var W=f[w+8]|f[w+9]<<8;z+=(k>>>4|W<<12)&8191,L+=W>>>1&8191;var J=f[w+10]|f[w+11]<<8;Q+=(W>>>14|J<<2)&8191;var ie=f[w+12]|f[w+13]<<8;d+=(J>>>11|ie<<5)&8191;var be=f[w+14]|f[w+15]<<8;b+=(ie>>>8|be<<8)&8191,y+=be>>>5|I;var ae=0,we=ae;we+=P*v,we+=$*(5*S),we+=R*(5*de),we+=N*(5*ce),we+=z*(5*se),ae=we>>>13,we&=8191,we+=L*(5*G),we+=Q*(5*K),we+=d*(5*_),we+=b*(5*c),we+=y*(5*p),ae+=we>>>13,we&=8191;var le=ae;le+=P*p,le+=$*v,le+=R*(5*S),le+=N*(5*de),le+=z*(5*ce),ae=le>>>13,le&=8191,le+=L*(5*se),le+=Q*(5*G),le+=d*(5*K),le+=b*(5*_),le+=y*(5*c),ae+=le>>>13,le&=8191;var _e=ae;_e+=P*c,_e+=$*p,_e+=R*v,_e+=N*(5*S),_e+=z*(5*de),ae=_e>>>13,_e&=8191,_e+=L*(5*ce),_e+=Q*(5*se),_e+=d*(5*G),_e+=b*(5*K),_e+=y*(5*_),ae+=_e>>>13,_e&=8191;var H=ae;H+=P*_,H+=$*c,H+=R*p,H+=N*v,H+=z*(5*S),ae=H>>>13,H&=8191,H+=L*(5*de),H+=Q*(5*ce),H+=d*(5*se),H+=b*(5*G),H+=y*(5*K),ae+=H>>>13,H&=8191;var B=ae;B+=P*K,B+=$*_,B+=R*c,B+=N*p,B+=z*v,ae=B>>>13,B&=8191,B+=L*(5*S),B+=Q*(5*de),B+=d*(5*ce),B+=b*(5*se),B+=y*(5*G),ae+=B>>>13,B&=8191;var F=ae;F+=P*G,F+=$*K,F+=R*_,F+=N*c,F+=z*p,ae=F>>>13,F&=8191,F+=L*v,F+=Q*(5*S),F+=d*(5*de),F+=b*(5*ce),F+=y*(5*se),ae+=F>>>13,F&=8191;var h=ae;h+=P*se,h+=$*G,h+=R*K,h+=N*_,h+=z*c,ae=h>>>13,h&=8191,h+=L*p,h+=Q*v,h+=d*(5*S),h+=b*(5*de),h+=y*(5*ce),ae+=h>>>13,h&=8191;var T=ae;T+=P*ce,T+=$*se,T+=R*G,T+=N*K,T+=z*_,ae=T>>>13,T&=8191,T+=L*c,T+=Q*p,T+=d*v,T+=b*(5*S),T+=y*(5*de),ae+=T>>>13,T&=8191;var oe=ae;oe+=P*de,oe+=$*ce,oe+=R*se,oe+=N*G,oe+=z*K,ae=oe>>>13,oe&=8191,oe+=L*_,oe+=Q*c,oe+=d*p,oe+=b*v,oe+=y*(5*S),ae+=oe>>>13,oe&=8191;var fe=ae;fe+=P*S,fe+=$*de,fe+=R*ce,fe+=N*se,fe+=z*G,ae=fe>>>13,fe&=8191,fe+=L*K,fe+=Q*_,fe+=d*c,fe+=b*p,fe+=y*v,ae+=fe>>>13,fe&=8191,ae=(ae<<2)+ae|0,ae=ae+we|0,we=ae&8191,ae=ae>>>13,le+=ae,P=we,$=le,R=_e,N=H,z=B,L=F,Q=h,d=T,b=oe,y=fe,w+=16,O-=16}this._h[0]=P,this._h[1]=$,this._h[2]=R,this._h[3]=N,this._h[4]=z,this._h[5]=L,this._h[6]=Q,this._h[7]=d,this._h[8]=b,this._h[9]=y},m.prototype.finish=function(f,w){w===void 0&&(w=0);var O=new Uint16Array(10),I,P,$,R;if(this._leftover){for(R=this._leftover,this._buffer[R++]=1;R<16;R++)this._buffer[R]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(I=this._h[1]>>>13,this._h[1]&=8191,R=2;R<10;R++)this._h[R]+=I,I=this._h[R]>>>13,this._h[R]&=8191;for(this._h[0]+=I*5,I=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=I,I=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=I,O[0]=this._h[0]+5,I=O[0]>>>13,O[0]&=8191,R=1;R<10;R++)O[R]=this._h[R]+I,I=O[R]>>>13,O[R]&=8191;for(O[9]-=8192,P=(I^1)-1,R=0;R<10;R++)O[R]&=P;for(P=~P,R=0;R<10;R++)this._h[R]=this._h[R]&P|O[R];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,$=this._h[0]+this._pad[0],this._h[0]=$&65535,R=1;R<8;R++)$=(this._h[R]+this._pad[R]|0)+($>>>16)|0,this._h[R]=$&65535;return f[w+0]=this._h[0]>>>0,f[w+1]=this._h[0]>>>8,f[w+2]=this._h[1]>>>0,f[w+3]=this._h[1]>>>8,f[w+4]=this._h[2]>>>0,f[w+5]=this._h[2]>>>8,f[w+6]=this._h[3]>>>0,f[w+7]=this._h[3]>>>8,f[w+8]=this._h[4]>>>0,f[w+9]=this._h[4]>>>8,f[w+10]=this._h[5]>>>0,f[w+11]=this._h[5]>>>8,f[w+12]=this._h[6]>>>0,f[w+13]=this._h[6]>>>8,f[w+14]=this._h[7]>>>0,f[w+15]=this._h[7]>>>8,this._finished=!0,this},m.prototype.update=function(f){var w=0,O=f.length,I;if(this._leftover){I=16-this._leftover,I>O&&(I=O);for(var P=0;P<I;P++)this._buffer[this._leftover+P]=f[w+P];if(O-=I,w+=I,this._leftover+=I,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(O>=16&&(I=O-O%16,this._blocks(f,w,I),w+=I,O-=I),O){for(var P=0;P<O;P++)this._buffer[this._leftover+P]=f[w+P];this._leftover+=O}return this},m.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},m.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},m}();n.Poly1305=s;function o(m,f){var w=new s(m);w.update(f);var O=w.digest();return w.clean(),O}n.oneTimeAuth=o;function l(m,f){return m.length!==n.DIGEST_LENGTH||f.length!==n.DIGEST_LENGTH?!1:t.equal(m,f)}n.equal=l})(yd);(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Ua,r=yd,s=Dr,o=$e,l=Ai;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var m=new Uint8Array(16),f=function(){function w(O){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,O.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(O)}return w.prototype.seal=function(O,I,P,$){if(O.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var R=new Uint8Array(16);R.set(O,R.length-O.length);var N=new Uint8Array(32);t.stream(this._key,R,N,4);var z=I.length+this.tagLength,L;if($){if($.length!==z)throw new Error("ChaCha20Poly1305: incorrect destination length");L=$}else L=new Uint8Array(z);return t.streamXOR(this._key,R,I,L,4),this._authenticate(L.subarray(L.length-this.tagLength,L.length),N,L.subarray(0,L.length-this.tagLength),P),s.wipe(R),L},w.prototype.open=function(O,I,P,$){if(O.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(I.length<this.tagLength)return null;var R=new Uint8Array(16);R.set(O,R.length-O.length);var N=new Uint8Array(32);t.stream(this._key,R,N,4);var z=new Uint8Array(this.tagLength);if(this._authenticate(z,N,I.subarray(0,I.length-this.tagLength),P),!l.equal(z,I.subarray(I.length-this.tagLength,I.length)))return null;var L=I.length-this.tagLength,Q;if($){if($.length!==L)throw new Error("ChaCha20Poly1305: incorrect destination length");Q=$}else Q=new Uint8Array(L);return t.streamXOR(this._key,R,I.subarray(0,I.length-this.tagLength),Q,4),s.wipe(R),Q},w.prototype.clean=function(){return s.wipe(this._key),this},w.prototype._authenticate=function(O,I,P,$){var R=new r.Poly1305(I);$&&(R.update($),$.length%16>0&&R.update(m.subarray($.length%16))),R.update(P),P.length%16>0&&R.update(m.subarray(P.length%16));var N=new Uint8Array(8);$&&o.writeUint64LE($.length,N),R.update(N),o.writeUint64LE(P.length,N),R.update(N);for(var z=R.digest(),L=0;L<z.length;L++)O[L]=z[L];R.clean(),s.wipe(z),s.wipe(N)},w}();n.ChaCha20Poly1305=f})(ou);var vd={},os={},cu={};Object.defineProperty(cu,"__esModule",{value:!0});function Um(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}cu.isSerializableHash=Um;Object.defineProperty(os,"__esModule",{value:!0});var Xr=cu,Rm=Ai,Fm=Dr,md=function(){function n(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(s).clean():s.set(r);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),Xr.isSerializableHash(this._inner)&&Xr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Fm.wipe(s)}return n.prototype.reset=function(){if(!Xr.isSerializableHash(this._inner)||!Xr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){Xr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Xr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(t){return this._inner.update(t),this},n.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},n.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},n.prototype.saveState=function(){if(!Xr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(t){if(!Xr.isSerializableHash(this._inner)||!Xr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(t){if(!Xr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},n}();os.HMAC=md;function $m(n,t,r){var s=new md(n,t);s.update(r);var o=s.digest();return s.clean(),o}os.hmac=$m;os.equal=Rm.equal;Object.defineProperty(vd,"__esModule",{value:!0});var Al=os,Cl=Dr,Lm=function(){function n(t,r,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=o;var l=Al.hmac(this._hash,s,r);this._hmac=new Al.HMAC(t,l),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(t){for(var r=new Uint8Array(t),s=0;s<r.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[s]=this._buffer[this._bufpos++];return r},n.prototype.clean=function(){this._hmac.clean(),Cl.wipe(this._buffer),Cl.wipe(this._counter),this._bufpos=0},n}(),Mm=vd.HKDF=Lm,In={},Ra={},Fa={};Object.defineProperty(Fa,"__esModule",{value:!0});Fa.BrowserRandomSource=void 0;const Pl=65536;class jm{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(t);for(let s=0;s<r.length;s+=Pl)this._crypto.getRandomValues(r.subarray(s,s+Math.min(r.length-s,Pl)));return r}}Fa.BrowserRandomSource=jm;function qm(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var $a={};Object.defineProperty($a,"__esModule",{value:!0});$a.NodeRandomSource=void 0;const Bm=Dr;class zm{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof qm<"u"){const t=kv;t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(t);for(let o=0;o<s.length;o++)s[o]=r[o];return(0,Bm.wipe)(r),s}}$a.NodeRandomSource=zm;Object.defineProperty(Ra,"__esModule",{value:!0});Ra.SystemRandomSource=void 0;const Hm=Fa,Km=$a;class Vm{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Hm.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Km.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}Ra.SystemRandomSource=Vm;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const t=Ra,r=$e,s=Dr;n.defaultRandomSource=new t.SystemRandomSource;function o(O,I=n.defaultRandomSource){return I.randomBytes(O)}n.randomBytes=o;function l(O=n.defaultRandomSource){const I=o(4,O),P=(0,r.readUint32LE)(I);return(0,s.wipe)(I),P}n.randomUint32=l;const m="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(O,I=m,P=n.defaultRandomSource){if(I.length<2)throw new Error("randomString charset is too short");if(I.length>256)throw new Error("randomString charset is too long");let $="";const R=I.length,N=256-256%R;for(;O>0;){const z=o(Math.ceil(O*256/N),P);for(let L=0;L<z.length&&O>0;L++){const Q=z[L];Q<N&&($+=I.charAt(Q%R),O--)}(0,s.wipe)(z)}return $}n.randomString=f;function w(O,I=m,P=n.defaultRandomSource){const $=Math.ceil(O/(Math.log(I.length)/Math.LN2));return f($,I,P)}n.randomStringForEntropy=w})(In);var La={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=$e,r=Dr;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},f.prototype.update=function(w,O){if(O===void 0&&(O=w.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var I=0;if(this._bytesHashed+=O,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&O>0;)this._buffer[this._bufferLength++]=w[I++],O--;this._bufferLength===this.blockSize&&(l(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(O>=this.blockSize&&(I=l(this._temp,this._state,w,I,O),O%=this.blockSize);O>0;)this._buffer[this._bufferLength++]=w[I++],O--;return this},f.prototype.finish=function(w){if(!this._finished){var O=this._bytesHashed,I=this._bufferLength,P=O/536870912|0,$=O<<3,R=O%64<56?64:128;this._buffer[I]=128;for(var N=I+1;N<R-8;N++)this._buffer[N]=0;t.writeUint32BE(P,this._buffer,R-8),t.writeUint32BE($,this._buffer,R-4),l(this._temp,this._state,this._buffer,0,R),this._finished=!0}for(var N=0;N<this.digestLength/4;N++)t.writeUint32BE(this._state[N],w,N*4);return this},f.prototype.digest=function(){var w=new Uint8Array(this.digestLength);return this.finish(w),w},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(w){return this._state.set(w.state),this._bufferLength=w.bufferLength,w.buffer&&this._buffer.set(w.buffer),this._bytesHashed=w.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(w){r.wipe(w.state),w.buffer&&r.wipe(w.buffer),w.bufferLength=0,w.bytesHashed=0},f}();n.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function l(f,w,O,I,P){for(;P>=64;){for(var $=w[0],R=w[1],N=w[2],z=w[3],L=w[4],Q=w[5],d=w[6],b=w[7],y=0;y<16;y++){var v=I+y*4;f[y]=t.readUint32BE(O,v)}for(var y=16;y<64;y++){var p=f[y-2],c=(p>>>17|p<<32-17)^(p>>>19|p<<32-19)^p>>>10;p=f[y-15];var _=(p>>>7|p<<32-7)^(p>>>18|p<<32-18)^p>>>3;f[y]=(c+f[y-7]|0)+(_+f[y-16]|0)}for(var y=0;y<64;y++){var c=(((L>>>6|L<<26)^(L>>>11|L<<21)^(L>>>25|L<<7))+(L&Q^~L&d)|0)+(b+(o[y]+f[y]|0)|0)|0,_=(($>>>2|$<<32-2)^($>>>13|$<<32-13)^($>>>22|$<<32-22))+($&R^$&N^R&N)|0;b=d,d=Q,Q=L,L=z+c|0,z=N,N=R,R=$,$=c+_|0}w[0]+=$,w[1]+=R,w[2]+=N,w[3]+=z,w[4]+=L,w[5]+=Q,w[6]+=d,w[7]+=b,I+=64,P-=64}return I}function m(f){var w=new s;w.update(f);var O=w.digest();return w.clean(),O}n.hash=m})(La);var uu={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const t=In,r=Dr;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function s(y){const v=new Float64Array(16);if(y)for(let p=0;p<y.length;p++)v[p]=y[p];return v}const o=new Uint8Array(32);o[0]=9;const l=s([56129,1]);function m(y){let v=1;for(let p=0;p<16;p++){let c=y[p]+v+65535;v=Math.floor(c/65536),y[p]=c-v*65536}y[0]+=v-1+37*(v-1)}function f(y,v,p){const c=~(p-1);for(let _=0;_<16;_++){const K=c&(y[_]^v[_]);y[_]^=K,v[_]^=K}}function w(y,v){const p=s(),c=s();for(let _=0;_<16;_++)c[_]=v[_];m(c),m(c),m(c);for(let _=0;_<2;_++){p[0]=c[0]-65517;for(let G=1;G<15;G++)p[G]=c[G]-65535-(p[G-1]>>16&1),p[G-1]&=65535;p[15]=c[15]-32767-(p[14]>>16&1);const K=p[15]>>16&1;p[14]&=65535,f(c,p,1-K)}for(let _=0;_<16;_++)y[2*_]=c[_]&255,y[2*_+1]=c[_]>>8}function O(y,v){for(let p=0;p<16;p++)y[p]=v[2*p]+(v[2*p+1]<<8);y[15]&=32767}function I(y,v,p){for(let c=0;c<16;c++)y[c]=v[c]+p[c]}function P(y,v,p){for(let c=0;c<16;c++)y[c]=v[c]-p[c]}function $(y,v,p){let c,_,K=0,G=0,se=0,ce=0,de=0,S=0,C=0,te=0,X=0,k=0,W=0,J=0,ie=0,be=0,ae=0,we=0,le=0,_e=0,H=0,B=0,F=0,h=0,T=0,oe=0,fe=0,Ie=0,ze=0,Ve=0,Le=0,dt=0,pt=0,je=p[0],xe=p[1],Ue=p[2],Re=p[3],qe=p[4],Ae=p[5],Fe=p[6],Se=p[7],Ce=p[8],He=p[9],Oe=p[10],ke=p[11],Ge=p[12],et=p[13],tt=p[14],Je=p[15];c=v[0],K+=c*je,G+=c*xe,se+=c*Ue,ce+=c*Re,de+=c*qe,S+=c*Ae,C+=c*Fe,te+=c*Se,X+=c*Ce,k+=c*He,W+=c*Oe,J+=c*ke,ie+=c*Ge,be+=c*et,ae+=c*tt,we+=c*Je,c=v[1],G+=c*je,se+=c*xe,ce+=c*Ue,de+=c*Re,S+=c*qe,C+=c*Ae,te+=c*Fe,X+=c*Se,k+=c*Ce,W+=c*He,J+=c*Oe,ie+=c*ke,be+=c*Ge,ae+=c*et,we+=c*tt,le+=c*Je,c=v[2],se+=c*je,ce+=c*xe,de+=c*Ue,S+=c*Re,C+=c*qe,te+=c*Ae,X+=c*Fe,k+=c*Se,W+=c*Ce,J+=c*He,ie+=c*Oe,be+=c*ke,ae+=c*Ge,we+=c*et,le+=c*tt,_e+=c*Je,c=v[3],ce+=c*je,de+=c*xe,S+=c*Ue,C+=c*Re,te+=c*qe,X+=c*Ae,k+=c*Fe,W+=c*Se,J+=c*Ce,ie+=c*He,be+=c*Oe,ae+=c*ke,we+=c*Ge,le+=c*et,_e+=c*tt,H+=c*Je,c=v[4],de+=c*je,S+=c*xe,C+=c*Ue,te+=c*Re,X+=c*qe,k+=c*Ae,W+=c*Fe,J+=c*Se,ie+=c*Ce,be+=c*He,ae+=c*Oe,we+=c*ke,le+=c*Ge,_e+=c*et,H+=c*tt,B+=c*Je,c=v[5],S+=c*je,C+=c*xe,te+=c*Ue,X+=c*Re,k+=c*qe,W+=c*Ae,J+=c*Fe,ie+=c*Se,be+=c*Ce,ae+=c*He,we+=c*Oe,le+=c*ke,_e+=c*Ge,H+=c*et,B+=c*tt,F+=c*Je,c=v[6],C+=c*je,te+=c*xe,X+=c*Ue,k+=c*Re,W+=c*qe,J+=c*Ae,ie+=c*Fe,be+=c*Se,ae+=c*Ce,we+=c*He,le+=c*Oe,_e+=c*ke,H+=c*Ge,B+=c*et,F+=c*tt,h+=c*Je,c=v[7],te+=c*je,X+=c*xe,k+=c*Ue,W+=c*Re,J+=c*qe,ie+=c*Ae,be+=c*Fe,ae+=c*Se,we+=c*Ce,le+=c*He,_e+=c*Oe,H+=c*ke,B+=c*Ge,F+=c*et,h+=c*tt,T+=c*Je,c=v[8],X+=c*je,k+=c*xe,W+=c*Ue,J+=c*Re,ie+=c*qe,be+=c*Ae,ae+=c*Fe,we+=c*Se,le+=c*Ce,_e+=c*He,H+=c*Oe,B+=c*ke,F+=c*Ge,h+=c*et,T+=c*tt,oe+=c*Je,c=v[9],k+=c*je,W+=c*xe,J+=c*Ue,ie+=c*Re,be+=c*qe,ae+=c*Ae,we+=c*Fe,le+=c*Se,_e+=c*Ce,H+=c*He,B+=c*Oe,F+=c*ke,h+=c*Ge,T+=c*et,oe+=c*tt,fe+=c*Je,c=v[10],W+=c*je,J+=c*xe,ie+=c*Ue,be+=c*Re,ae+=c*qe,we+=c*Ae,le+=c*Fe,_e+=c*Se,H+=c*Ce,B+=c*He,F+=c*Oe,h+=c*ke,T+=c*Ge,oe+=c*et,fe+=c*tt,Ie+=c*Je,c=v[11],J+=c*je,ie+=c*xe,be+=c*Ue,ae+=c*Re,we+=c*qe,le+=c*Ae,_e+=c*Fe,H+=c*Se,B+=c*Ce,F+=c*He,h+=c*Oe,T+=c*ke,oe+=c*Ge,fe+=c*et,Ie+=c*tt,ze+=c*Je,c=v[12],ie+=c*je,be+=c*xe,ae+=c*Ue,we+=c*Re,le+=c*qe,_e+=c*Ae,H+=c*Fe,B+=c*Se,F+=c*Ce,h+=c*He,T+=c*Oe,oe+=c*ke,fe+=c*Ge,Ie+=c*et,ze+=c*tt,Ve+=c*Je,c=v[13],be+=c*je,ae+=c*xe,we+=c*Ue,le+=c*Re,_e+=c*qe,H+=c*Ae,B+=c*Fe,F+=c*Se,h+=c*Ce,T+=c*He,oe+=c*Oe,fe+=c*ke,Ie+=c*Ge,ze+=c*et,Ve+=c*tt,Le+=c*Je,c=v[14],ae+=c*je,we+=c*xe,le+=c*Ue,_e+=c*Re,H+=c*qe,B+=c*Ae,F+=c*Fe,h+=c*Se,T+=c*Ce,oe+=c*He,fe+=c*Oe,Ie+=c*ke,ze+=c*Ge,Ve+=c*et,Le+=c*tt,dt+=c*Je,c=v[15],we+=c*je,le+=c*xe,_e+=c*Ue,H+=c*Re,B+=c*qe,F+=c*Ae,h+=c*Fe,T+=c*Se,oe+=c*Ce,fe+=c*He,Ie+=c*Oe,ze+=c*ke,Ve+=c*Ge,Le+=c*et,dt+=c*tt,pt+=c*Je,K+=38*le,G+=38*_e,se+=38*H,ce+=38*B,de+=38*F,S+=38*h,C+=38*T,te+=38*oe,X+=38*fe,k+=38*Ie,W+=38*ze,J+=38*Ve,ie+=38*Le,be+=38*dt,ae+=38*pt,_=1,c=K+_+65535,_=Math.floor(c/65536),K=c-_*65536,c=G+_+65535,_=Math.floor(c/65536),G=c-_*65536,c=se+_+65535,_=Math.floor(c/65536),se=c-_*65536,c=ce+_+65535,_=Math.floor(c/65536),ce=c-_*65536,c=de+_+65535,_=Math.floor(c/65536),de=c-_*65536,c=S+_+65535,_=Math.floor(c/65536),S=c-_*65536,c=C+_+65535,_=Math.floor(c/65536),C=c-_*65536,c=te+_+65535,_=Math.floor(c/65536),te=c-_*65536,c=X+_+65535,_=Math.floor(c/65536),X=c-_*65536,c=k+_+65535,_=Math.floor(c/65536),k=c-_*65536,c=W+_+65535,_=Math.floor(c/65536),W=c-_*65536,c=J+_+65535,_=Math.floor(c/65536),J=c-_*65536,c=ie+_+65535,_=Math.floor(c/65536),ie=c-_*65536,c=be+_+65535,_=Math.floor(c/65536),be=c-_*65536,c=ae+_+65535,_=Math.floor(c/65536),ae=c-_*65536,c=we+_+65535,_=Math.floor(c/65536),we=c-_*65536,K+=_-1+37*(_-1),_=1,c=K+_+65535,_=Math.floor(c/65536),K=c-_*65536,c=G+_+65535,_=Math.floor(c/65536),G=c-_*65536,c=se+_+65535,_=Math.floor(c/65536),se=c-_*65536,c=ce+_+65535,_=Math.floor(c/65536),ce=c-_*65536,c=de+_+65535,_=Math.floor(c/65536),de=c-_*65536,c=S+_+65535,_=Math.floor(c/65536),S=c-_*65536,c=C+_+65535,_=Math.floor(c/65536),C=c-_*65536,c=te+_+65535,_=Math.floor(c/65536),te=c-_*65536,c=X+_+65535,_=Math.floor(c/65536),X=c-_*65536,c=k+_+65535,_=Math.floor(c/65536),k=c-_*65536,c=W+_+65535,_=Math.floor(c/65536),W=c-_*65536,c=J+_+65535,_=Math.floor(c/65536),J=c-_*65536,c=ie+_+65535,_=Math.floor(c/65536),ie=c-_*65536,c=be+_+65535,_=Math.floor(c/65536),be=c-_*65536,c=ae+_+65535,_=Math.floor(c/65536),ae=c-_*65536,c=we+_+65535,_=Math.floor(c/65536),we=c-_*65536,K+=_-1+37*(_-1),y[0]=K,y[1]=G,y[2]=se,y[3]=ce,y[4]=de,y[5]=S,y[6]=C,y[7]=te,y[8]=X,y[9]=k,y[10]=W,y[11]=J,y[12]=ie,y[13]=be,y[14]=ae,y[15]=we}function R(y,v){$(y,v,v)}function N(y,v){const p=s();for(let c=0;c<16;c++)p[c]=v[c];for(let c=253;c>=0;c--)R(p,p),c!==2&&c!==4&&$(p,p,v);for(let c=0;c<16;c++)y[c]=p[c]}function z(y,v){const p=new Uint8Array(32),c=new Float64Array(80),_=s(),K=s(),G=s(),se=s(),ce=s(),de=s();for(let X=0;X<31;X++)p[X]=y[X];p[31]=y[31]&127|64,p[0]&=248,O(c,v);for(let X=0;X<16;X++)K[X]=c[X];_[0]=se[0]=1;for(let X=254;X>=0;--X){const k=p[X>>>3]>>>(X&7)&1;f(_,K,k),f(G,se,k),I(ce,_,G),P(_,_,G),I(G,K,se),P(K,K,se),R(se,ce),R(de,_),$(_,G,_),$(G,K,ce),I(ce,_,G),P(_,_,G),R(K,_),P(G,se,de),$(_,G,l),I(_,_,se),$(G,G,_),$(_,se,de),$(se,K,c),R(K,ce),f(_,K,k),f(G,se,k)}for(let X=0;X<16;X++)c[X+16]=_[X],c[X+32]=G[X],c[X+48]=K[X],c[X+64]=se[X];const S=c.subarray(32),C=c.subarray(16);N(S,S),$(C,C,S);const te=new Uint8Array(32);return w(te,C),te}n.scalarMult=z;function L(y){return z(y,o)}n.scalarMultBase=L;function Q(y){if(y.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const v=new Uint8Array(y);return{publicKey:L(v),secretKey:v}}n.generateKeyPairFromSeed=Q;function d(y){const v=(0,t.randomBytes)(32,y),p=Q(v);return(0,r.wipe)(v),p}n.generateKeyPair=d;function b(y,v,p=!1){if(y.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(v.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const c=z(y,v);if(p){let _=0;for(let K=0;K<c.length;K++)_|=c[K];if(_===0)throw new Error("X25519: invalid shared key")}return c}n.sharedKey=b})(uu);function hu(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function bd(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?hu(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function jc(n,t){t||(t=n.reduce((o,l)=>o+l.length,0));const r=bd(t);let s=0;for(const o of n)r.set(o,s),s+=o.length;return hu(r)}function km(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var o=0;o<n.length;o++){var l=n.charAt(o),m=l.charCodeAt(0);if(r[m]!==255)throw new TypeError(l+" is ambiguous");r[m]=o}var f=n.length,w=n.charAt(0),O=Math.log(f)/Math.log(256),I=Math.log(256)/Math.log(f);function P(N){if(N instanceof Uint8Array||(ArrayBuffer.isView(N)?N=new Uint8Array(N.buffer,N.byteOffset,N.byteLength):Array.isArray(N)&&(N=Uint8Array.from(N))),!(N instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(N.length===0)return"";for(var z=0,L=0,Q=0,d=N.length;Q!==d&&N[Q]===0;)Q++,z++;for(var b=(d-Q)*I+1>>>0,y=new Uint8Array(b);Q!==d;){for(var v=N[Q],p=0,c=b-1;(v!==0||p<L)&&c!==-1;c--,p++)v+=256*y[c]>>>0,y[c]=v%f>>>0,v=v/f>>>0;if(v!==0)throw new Error("Non-zero carry");L=p,Q++}for(var _=b-L;_!==b&&y[_]===0;)_++;for(var K=w.repeat(z);_<b;++_)K+=n.charAt(y[_]);return K}function $(N){if(typeof N!="string")throw new TypeError("Expected String");if(N.length===0)return new Uint8Array;var z=0;if(N[z]!==" "){for(var L=0,Q=0;N[z]===w;)L++,z++;for(var d=(N.length-z)*O+1>>>0,b=new Uint8Array(d);N[z];){var y=r[N.charCodeAt(z)];if(y===255)return;for(var v=0,p=d-1;(y!==0||v<Q)&&p!==-1;p--,v++)y+=f*b[p]>>>0,b[p]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");Q=v,z++}if(N[z]!==" "){for(var c=d-Q;c!==d&&b[c]===0;)c++;for(var _=new Uint8Array(L+(d-c)),K=L;c!==d;)_[K++]=b[c++];return _}}}function R(N){var z=$(N);if(z)return z;throw new Error(`Non-${t} character`)}return{encode:P,decodeUnsafe:$,decode:R}}var Wm=km,Gm=Wm;const Ym=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},Jm=n=>new TextEncoder().encode(n),Xm=n=>new TextDecoder().decode(n);class Qm{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Zm{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return wd(this,t)}}class eb{constructor(t){this.decoders=t}or(t){return wd(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const wd=(n,t)=>new eb({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class tb{constructor(t,r,s,o){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=o,this.encoder=new Qm(t,r,s),this.decoder=new Zm(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Ma=({name:n,prefix:t,encode:r,decode:s})=>new tb(n,t,r,s),cs=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:o}=Gm(r,t);return Ma({prefix:n,name:t,encode:s,decode:l=>Ym(o(l))})},rb=(n,t,r,s)=>{const o={};for(let I=0;I<t.length;++I)o[t[I]]=I;let l=n.length;for(;n[l-1]==="=";)--l;const m=new Uint8Array(l*r/8|0);let f=0,w=0,O=0;for(let I=0;I<l;++I){const P=o[n[I]];if(P===void 0)throw new SyntaxError(`Non-${s} character`);w=w<<r|P,f+=r,f>=8&&(f-=8,m[O++]=255&w>>f)}if(f>=r||255&w<<8-f)throw new SyntaxError("Unexpected end of data");return m},ib=(n,t,r)=>{const s=t[t.length-1]==="=",o=(1<<r)-1;let l="",m=0,f=0;for(let w=0;w<n.length;++w)for(f=f<<8|n[w],m+=8;m>r;)m-=r,l+=t[o&f>>m];if(m&&(l+=t[o&f<<r-m]),s)for(;l.length*r&7;)l+="=";return l},Gt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Ma({prefix:t,name:n,encode(o){return ib(o,s,r)},decode(o){return rb(o,s,r,n)}}),nb=Ma({prefix:"\0",name:"identity",encode:n=>Xm(n),decode:n=>Jm(n)}),sb=Object.freeze(Object.defineProperty({__proto__:null,identity:nb},Symbol.toStringTag,{value:"Module"})),ab=Gt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),ob=Object.freeze(Object.defineProperty({__proto__:null,base2:ab},Symbol.toStringTag,{value:"Module"})),cb=Gt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),ub=Object.freeze(Object.defineProperty({__proto__:null,base8:cb},Symbol.toStringTag,{value:"Module"})),hb=cs({prefix:"9",name:"base10",alphabet:"0123456789"}),lb=Object.freeze(Object.defineProperty({__proto__:null,base10:hb},Symbol.toStringTag,{value:"Module"})),fb=Gt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),db=Gt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),pb=Object.freeze(Object.defineProperty({__proto__:null,base16:fb,base16upper:db},Symbol.toStringTag,{value:"Module"})),gb=Gt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),yb=Gt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_b=Gt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),vb=Gt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),mb=Gt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),bb=Gt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),wb=Gt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Eb=Gt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Db=Gt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Sb=Object.freeze(Object.defineProperty({__proto__:null,base32:gb,base32hex:mb,base32hexpad:wb,base32hexpadupper:Eb,base32hexupper:bb,base32pad:_b,base32padupper:vb,base32upper:yb,base32z:Db},Symbol.toStringTag,{value:"Module"})),Ib=cs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),xb=cs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Ob=Object.freeze(Object.defineProperty({__proto__:null,base36:Ib,base36upper:xb},Symbol.toStringTag,{value:"Module"})),Ab=cs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Cb=cs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Pb=Object.freeze(Object.defineProperty({__proto__:null,base58btc:Ab,base58flickr:Cb},Symbol.toStringTag,{value:"Module"})),Tb=Gt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Nb=Gt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ub=Gt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Rb=Gt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Fb=Object.freeze(Object.defineProperty({__proto__:null,base64:Tb,base64pad:Nb,base64url:Ub,base64urlpad:Rb},Symbol.toStringTag,{value:"Module"})),Ed=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),$b=Ed.reduce((n,t,r)=>(n[r]=t,n),[]),Lb=Ed.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function Mb(n){return n.reduce((t,r)=>(t+=$b[r],t),"")}function jb(n){const t=[];for(const r of n){const s=Lb[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const qb=Ma({prefix:"ðŸš€",name:"base256emoji",encode:Mb,decode:jb}),Bb=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:qb},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Tl={...sb,...ob,...ub,...lb,...pb,...Sb,...Ob,...Pb,...Fb,...Bb};function Dd(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const Nl=Dd("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),dc=Dd("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=bd(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),Sd={utf8:Nl,"utf-8":Nl,hex:Tl.base16,latin1:dc,ascii:dc,binary:dc,...Tl};function yr(n,t="utf8"){const r=Sd[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?hu(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}function cr(n,t="utf8"){const r=Sd[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):r.encoder.encode(n).substring(1)}var ve={},pc={},kn={},Ul;function zb(){if(Ul)return kn;Ul=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.delay=void 0;function n(t){return new Promise(r=>{setTimeout(()=>{r(!0)},t)})}return kn.delay=n,kn}var Vi={},gc={},ki={},Rl;function Hb(){return Rl||(Rl=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.ONE_THOUSAND=ki.ONE_HUNDRED=void 0,ki.ONE_HUNDRED=100,ki.ONE_THOUSAND=1e3),ki}var yc={},Fl;function Kb(){return Fl||(Fl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(yc)),yc}var $l;function Id(){return $l||($l=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Kr;t.__exportStar(Hb(),n),t.__exportStar(Kb(),n)}(gc)),gc}var Ll;function Vb(){if(Ll)return Vi;Ll=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.fromMiliseconds=Vi.toMiliseconds=void 0;const n=Id();function t(s){return s*n.ONE_THOUSAND}Vi.toMiliseconds=t;function r(s){return Math.floor(s/n.ONE_THOUSAND)}return Vi.fromMiliseconds=r,Vi}var Ml;function kb(){return Ml||(Ml=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Kr;t.__exportStar(zb(),n),t.__exportStar(Vb(),n)}(pc)),pc}var wn={},jl;function Wb(){if(jl)return wn;jl=1,Object.defineProperty(wn,"__esModule",{value:!0}),wn.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const s=this.get(r);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const o=Date.now()-s.started;this.timestamps.set(r,{started:s.started,elapsed:o})}get(r){const s=this.timestamps.get(r);if(typeof s>"u")throw new Error(`No timestamp found for label: ${r}`);return s}elapsed(r){const s=this.get(r);return s.elapsed||Date.now()-s.started}}return wn.Watch=n,wn.default=n,wn}var _c={},Wn={},ql;function Gb(){if(ql)return Wn;ql=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.IWatch=void 0;class n{}return Wn.IWatch=n,Wn}var Bl;function Yb(){return Bl||(Bl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Kr.__exportStar(Gb(),n)}(_c)),_c}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Kr;t.__exportStar(kb(),n),t.__exportStar(Wb(),n),t.__exportStar(Yb(),n),t.__exportStar(Id(),n)})(ve);var lu={};Object.defineProperty(lu,"__esModule",{value:!0});lu.getWindowMetadata=void 0;const zl=su;function Jb(){let n,t;try{n=zl.getDocumentOrThrow(),t=zl.getLocationOrThrow()}catch{return null}function r(){const P=n.getElementsByTagName("link"),$=[];for(let R=0;R<P.length;R++){const N=P[R],z=N.getAttribute("rel");if(z&&z.toLowerCase().indexOf("icon")>-1){const L=N.getAttribute("href");if(L)if(L.toLowerCase().indexOf("https:")===-1&&L.toLowerCase().indexOf("http:")===-1&&L.indexOf("//")!==0){let Q=t.protocol+"//"+t.host;if(L.indexOf("/")===0)Q+=L;else{const d=t.pathname.split("/");d.pop();const b=d.join("/");Q+=b+"/"+L}$.push(Q)}else if(L.indexOf("//")===0){const Q=t.protocol+L;$.push(Q)}else $.push(L)}}return $}function s(...P){const $=n.getElementsByTagName("meta");for(let R=0;R<$.length;R++){const N=$[R],z=["itemprop","property","name"].map(L=>N.getAttribute(L)).filter(L=>L?P.includes(L):!1);if(z.length&&z){const L=N.getAttribute("content");if(L)return L}}return""}function o(){let P=s("name","og:site_name","og:title","twitter:title");return P||(P=n.title),P}function l(){return s("description","og:description","twitter:description","keywords")}const m=o(),f=l(),w=t.origin,O=r();return{description:f,url:w,icons:O,name:m}}lu.getWindowMetadata=Jb;var Xb={},fu=function(n,t){for(var r={},s=Object.keys(n),o=Array.isArray(t),l=0;l<s.length;l++){var m=s[l],f=n[m];(o?t.indexOf(m)!==-1:t(m,f,n))&&(r[m]=f)}return r};(function(n){const t=tu,r=ru,s=eu,o=fu,l=d=>d==null,m=Symbol("encodeFragmentIdentifier");function f(d){switch(d.arrayFormat){case"index":return b=>(y,v)=>{const p=y.length;return v===void 0||d.skipNull&&v===null||d.skipEmptyString&&v===""?y:v===null?[...y,[I(b,d),"[",p,"]"].join("")]:[...y,[I(b,d),"[",I(p,d),"]=",I(v,d)].join("")]};case"bracket":return b=>(y,v)=>v===void 0||d.skipNull&&v===null||d.skipEmptyString&&v===""?y:v===null?[...y,[I(b,d),"[]"].join("")]:[...y,[I(b,d),"[]=",I(v,d)].join("")];case"colon-list-separator":return b=>(y,v)=>v===void 0||d.skipNull&&v===null||d.skipEmptyString&&v===""?y:v===null?[...y,[I(b,d),":list="].join("")]:[...y,[I(b,d),":list=",I(v,d)].join("")];case"comma":case"separator":case"bracket-separator":{const b=d.arrayFormat==="bracket-separator"?"[]=":"=";return y=>(v,p)=>p===void 0||d.skipNull&&p===null||d.skipEmptyString&&p===""?v:(p=p===null?"":p,v.length===0?[[I(y,d),b,I(p,d)].join("")]:[[v,I(p,d)].join(d.arrayFormatSeparator)])}default:return b=>(y,v)=>v===void 0||d.skipNull&&v===null||d.skipEmptyString&&v===""?y:v===null?[...y,I(b,d)]:[...y,[I(b,d),"=",I(v,d)].join("")]}}function w(d){let b;switch(d.arrayFormat){case"index":return(y,v,p)=>{if(b=/\[(\d*)\]$/.exec(y),y=y.replace(/\[\d*\]$/,""),!b){p[y]=v;return}p[y]===void 0&&(p[y]={}),p[y][b[1]]=v};case"bracket":return(y,v,p)=>{if(b=/(\[\])$/.exec(y),y=y.replace(/\[\]$/,""),!b){p[y]=v;return}if(p[y]===void 0){p[y]=[v];return}p[y]=[].concat(p[y],v)};case"colon-list-separator":return(y,v,p)=>{if(b=/(:list)$/.exec(y),y=y.replace(/:list$/,""),!b){p[y]=v;return}if(p[y]===void 0){p[y]=[v];return}p[y]=[].concat(p[y],v)};case"comma":case"separator":return(y,v,p)=>{const c=typeof v=="string"&&v.includes(d.arrayFormatSeparator),_=typeof v=="string"&&!c&&P(v,d).includes(d.arrayFormatSeparator);v=_?P(v,d):v;const K=c||_?v.split(d.arrayFormatSeparator).map(G=>P(G,d)):v===null?v:P(v,d);p[y]=K};case"bracket-separator":return(y,v,p)=>{const c=/(\[\])$/.test(y);if(y=y.replace(/\[\]$/,""),!c){p[y]=v&&P(v,d);return}const _=v===null?[]:v.split(d.arrayFormatSeparator).map(K=>P(K,d));if(p[y]===void 0){p[y]=_;return}p[y]=[].concat(p[y],_)};default:return(y,v,p)=>{if(p[y]===void 0){p[y]=v;return}p[y]=[].concat(p[y],v)}}}function O(d){if(typeof d!="string"||d.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function I(d,b){return b.encode?b.strict?t(d):encodeURIComponent(d):d}function P(d,b){return b.decode?r(d):d}function $(d){return Array.isArray(d)?d.sort():typeof d=="object"?$(Object.keys(d)).sort((b,y)=>Number(b)-Number(y)).map(b=>d[b]):d}function R(d){const b=d.indexOf("#");return b!==-1&&(d=d.slice(0,b)),d}function N(d){let b="";const y=d.indexOf("#");return y!==-1&&(b=d.slice(y)),b}function z(d){d=R(d);const b=d.indexOf("?");return b===-1?"":d.slice(b+1)}function L(d,b){return b.parseNumbers&&!Number.isNaN(Number(d))&&typeof d=="string"&&d.trim()!==""?d=Number(d):b.parseBooleans&&d!==null&&(d.toLowerCase()==="true"||d.toLowerCase()==="false")&&(d=d.toLowerCase()==="true"),d}function Q(d,b){b=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},b),O(b.arrayFormatSeparator);const y=w(b),v=Object.create(null);if(typeof d!="string"||(d=d.trim().replace(/^[?#&]/,""),!d))return v;for(const p of d.split("&")){if(p==="")continue;let[c,_]=s(b.decode?p.replace(/\+/g," "):p,"=");_=_===void 0?null:["comma","separator","bracket-separator"].includes(b.arrayFormat)?_:P(_,b),y(P(c,b),_,v)}for(const p of Object.keys(v)){const c=v[p];if(typeof c=="object"&&c!==null)for(const _ of Object.keys(c))c[_]=L(c[_],b);else v[p]=L(c,b)}return b.sort===!1?v:(b.sort===!0?Object.keys(v).sort():Object.keys(v).sort(b.sort)).reduce((p,c)=>{const _=v[c];return _&&typeof _=="object"&&!Array.isArray(_)?p[c]=$(_):p[c]=_,p},Object.create(null))}n.extract=z,n.parse=Q,n.stringify=(d,b)=>{if(!d)return"";b=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},b),O(b.arrayFormatSeparator);const y=_=>b.skipNull&&l(d[_])||b.skipEmptyString&&d[_]==="",v=f(b),p={};for(const _ of Object.keys(d))y(_)||(p[_]=d[_]);const c=Object.keys(p);return b.sort!==!1&&c.sort(b.sort),c.map(_=>{const K=d[_];return K===void 0?"":K===null?I(_,b):Array.isArray(K)?K.length===0&&b.arrayFormat==="bracket-separator"?I(_,b)+"[]":K.reduce(v(_),[]).join("&"):I(_,b)+"="+I(K,b)}).filter(_=>_.length>0).join("&")},n.parseUrl=(d,b)=>{b=Object.assign({decode:!0},b);const[y,v]=s(d,"#");return Object.assign({url:y.split("?")[0]||"",query:Q(z(d),b)},b&&b.parseFragmentIdentifier&&v?{fragmentIdentifier:P(v,b)}:{})},n.stringifyUrl=(d,b)=>{b=Object.assign({encode:!0,strict:!0,[m]:!0},b);const y=R(d.url).split("?")[0]||"",v=n.extract(d.url),p=n.parse(v,{sort:!1}),c=Object.assign(p,d.query);let _=n.stringify(c,b);_&&(_=`?${_}`);let K=N(d.url);return d.fragmentIdentifier&&(K=`#${b[m]?I(d.fragmentIdentifier,b):d.fragmentIdentifier}`),`${y}${_}${K}`},n.pick=(d,b,y)=>{y=Object.assign({parseFragmentIdentifier:!0,[m]:!1},y);const{url:v,query:p,fragmentIdentifier:c}=n.parseUrl(d,y);return n.stringifyUrl({url:v,query:o(p,b),fragmentIdentifier:c},y)},n.exclude=(d,b,y)=>{const v=Array.isArray(b)?p=>!b.includes(p):(p,c)=>!b(p,c);return n.pick(d,v,y)}})(Xb);const Qb={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function Zb(n,t=[]){const r=[];return Object.keys(n).forEach(s=>{if(t.length&&!t.includes(s))return;const o=n[s];r.push(...o.accounts)}),r}const ew={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function tw(n,t){const{message:r,code:s}=ew[n];return{message:t?`${r} ${t}`:r,code:s}}function qc(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}var ja={},us={};Object.defineProperty(us,"__esModule",{value:!0});function rw(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return JSON.parse(n)}catch{return n}}us.safeJsonParse=rw;function iw(n){return typeof n=="string"?n:JSON.stringify(n,(t,r)=>typeof r>"u"?null:r)}us.safeJsonStringify=iw;var Gn={exports:{}},Hl;function nw(){return Hl||(Hl=1,function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof xi<"u"&&xi.localStorage?Gn.exports=xi.localStorage:typeof window<"u"&&window.localStorage?Gn.exports=window.localStorage:Gn.exports=new t}()),Gn.exports}var vc={},Yn={},Kl;function sw(){if(Kl)return Yn;Kl=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.IKeyValueStorage=void 0;class n{}return Yn.IKeyValueStorage=n,Yn}var Jn={},Vl;function aw(){if(Vl)return Jn;Vl=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.parseEntry=void 0;const n=us;function t(r){var s;return[r[0],n.safeJsonParse((s=r[1])!==null&&s!==void 0?s:"")]}return Jn.parseEntry=t,Jn}var kl;function ow(){return kl||(kl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Kr;t.__exportStar(sw(),n),t.__exportStar(aw(),n)}(vc)),vc}Object.defineProperty(ja,"__esModule",{value:!0});ja.KeyValueStorage=void 0;const En=Kr,Wl=us,cw=En.__importDefault(nw()),uw=ow();class xd{constructor(){this.localStorage=cw.default}getKeys(){return En.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return En.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(uw.parseEntry)})}getItem(t){return En.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return Wl.safeJsonParse(r)})}setItem(t,r){return En.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,Wl.safeJsonStringify(r))})}removeItem(t){return En.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}ja.KeyValueStorage=xd;var hw=ja.default=xd,hs={},Xn={},mc={},Qn={};class Xi{}const lw=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Xi},Symbol.toStringTag,{value:"Module"})),fw=Wv(lw);var Gl;function dw(){if(Gl)return Qn;Gl=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.IHeartBeat=void 0;const n=fw;class t extends n.IEvents{constructor(s){super()}}return Qn.IHeartBeat=t,Qn}var Yl;function Od(){return Yl||(Yl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Kr.__exportStar(dw(),n)}(mc)),mc}var bc={},Wi={},Jl;function pw(){if(Jl)return Wi;Jl=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.HEARTBEAT_EVENTS=Wi.HEARTBEAT_INTERVAL=void 0;const n=ve;return Wi.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,Wi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Wi}var Xl;function Ad(){return Xl||(Xl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Kr.__exportStar(pw(),n)}(bc)),bc}var Ql;function gw(){if(Ql)return Xn;Ql=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.HeartBeat=void 0;const n=Kr,t=$r,r=ve,s=Od(),o=Ad();class l extends s.IHeartBeat{constructor(f){super(f),this.events=new t.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||o.HEARTBEAT_INTERVAL}static init(f){return n.__awaiter(this,void 0,void 0,function*(){const w=new l(f);return yield w.init(),w})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,w){this.events.on(f,w)}once(f,w){this.events.once(f,w)}off(f,w){this.events.off(f,w)}removeListener(f,w){this.events.removeListener(f,w)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Xn.HeartBeat=l,Xn}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Kr;t.__exportStar(gw(),n),t.__exportStar(Od(),n),t.__exportStar(Ad(),n)})(hs);var Ze={},wc,Zl;function yw(){if(Zl)return wc;Zl=1;function n(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}wc=t;function t(r,s,o){var l=o&&o.stringify||n,m=1;if(typeof r=="object"&&r!==null){var f=s.length+m;if(f===1)return r;var w=new Array(f);w[0]=l(r);for(var O=1;O<f;O++)w[O]=l(s[O]);return w.join(" ")}if(typeof r!="string")return r;var I=s.length;if(I===0)return r;for(var P="",$=1-m,R=-1,N=r&&r.length||0,z=0;z<N;){if(r.charCodeAt(z)===37&&z+1<N){switch(R=R>-1?R:0,r.charCodeAt(z+1)){case 100:case 102:if($>=I||s[$]==null)break;R<z&&(P+=r.slice(R,z)),P+=Number(s[$]),R=z+2,z++;break;case 105:if($>=I||s[$]==null)break;R<z&&(P+=r.slice(R,z)),P+=Math.floor(Number(s[$])),R=z+2,z++;break;case 79:case 111:case 106:if($>=I||s[$]===void 0)break;R<z&&(P+=r.slice(R,z));var L=typeof s[$];if(L==="string"){P+="'"+s[$]+"'",R=z+2,z++;break}if(L==="function"){P+=s[$].name||"<anonymous>",R=z+2,z++;break}P+=l(s[$]),R=z+2,z++;break;case 115:if($>=I)break;R<z&&(P+=r.slice(R,z)),P+=String(s[$]),R=z+2,z++;break;case 37:R<z&&(P+=r.slice(R,z)),P+="%",R=z+2,z++,$--;break}++$}++z}return R===-1?r:(R<N&&(P+=r.slice(R)),P)}return wc}var Ec,ef;function _w(){if(ef)return Ec;ef=1;const n=yw();Ec=o;const t=v().console||{},r={mapHttpRequest:N,mapHttpResponse:N,wrapRequestSerializer:z,wrapResponseSerializer:z,wrapErrorSerializer:z,req:N,res:N,err:$};function s(p,c){return Array.isArray(p)?p.filter(function(K){return K!=="!stdSerializers.err"}):p===!0?Object.keys(c):!1}function o(p){p=p||{},p.browser=p.browser||{};const c=p.browser.transmit;if(c&&typeof c.send!="function")throw Error("pino: transmit option must have a send function");const _=p.browser.write||t;p.browser.write&&(p.browser.asObject=!0);const K=p.serializers||{},G=s(p.browser.serialize,K);let se=p.browser.serialize;Array.isArray(p.browser.serialize)&&p.browser.serialize.indexOf("!stdSerializers.err")>-1&&(se=!1);const ce=["error","fatal","warn","info","debug","trace"];typeof _=="function"&&(_.error=_.fatal=_.warn=_.info=_.debug=_.trace=_),p.enabled===!1&&(p.level="silent");const de=p.level||"info",S=Object.create(_);S.log||(S.log=L),Object.defineProperty(S,"levelVal",{get:te}),Object.defineProperty(S,"level",{get:X,set:k});const C={transmit:c,serialize:G,asObject:p.browser.asObject,levels:ce,timestamp:R(p)};S.levels=o.levels,S.level=de,S.setMaxListeners=S.getMaxListeners=S.emit=S.addListener=S.on=S.prependListener=S.once=S.prependOnceListener=S.removeListener=S.removeAllListeners=S.listeners=S.listenerCount=S.eventNames=S.write=S.flush=L,S.serializers=K,S._serialize=G,S._stdErrSerialize=se,S.child=W,c&&(S._logEvent=P());function te(){return this.level==="silent"?1/0:this.levels.values[this.level]}function X(){return this._level}function k(J){if(J!=="silent"&&!this.levels.values[J])throw Error("unknown level "+J);this._level=J,l(C,S,"error","log"),l(C,S,"fatal","error"),l(C,S,"warn","error"),l(C,S,"info","log"),l(C,S,"debug","log"),l(C,S,"trace","log")}function W(J,ie){if(!J)throw new Error("missing bindings for child Pino");ie=ie||{},G&&J.serializers&&(ie.serializers=J.serializers);const be=ie.serializers;if(G&&be){var ae=Object.assign({},K,be),we=p.browser.serialize===!0?Object.keys(ae):G;delete J.serializers,w([J],we,ae,this._stdErrSerialize)}function le(_e){this._childLevel=(_e._childLevel|0)+1,this.error=O(_e,J,"error"),this.fatal=O(_e,J,"fatal"),this.warn=O(_e,J,"warn"),this.info=O(_e,J,"info"),this.debug=O(_e,J,"debug"),this.trace=O(_e,J,"trace"),ae&&(this.serializers=ae,this._serialize=we),c&&(this._logEvent=P([].concat(_e._logEvent.bindings,J)))}return le.prototype=this,new le(this)}return S}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=r,o.stdTimeFunctions=Object.assign({},{nullTime:Q,epochTime:d,unixTime:b,isoTime:y});function l(p,c,_,K){const G=Object.getPrototypeOf(c);c[_]=c.levelVal>c.levels.values[_]?L:G[_]?G[_]:t[_]||t[K]||L,m(p,c,_)}function m(p,c,_){!p.transmit&&c[_]===L||(c[_]=function(K){return function(){const se=p.timestamp(),ce=new Array(arguments.length),de=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var S=0;S<ce.length;S++)ce[S]=arguments[S];if(p.serialize&&!p.asObject&&w(ce,this._serialize,this.serializers,this._stdErrSerialize),p.asObject?K.call(de,f(this,_,ce,se)):K.apply(de,ce),p.transmit){const C=p.transmit.level||c.level,te=o.levels.values[C],X=o.levels.values[_];if(X<te)return;I(this,{ts:se,methodLevel:_,methodValue:X,transmitLevel:C,transmitValue:o.levels.values[p.transmit.level||c.level],send:p.transmit.send,val:c.levelVal},ce)}}}(c[_]))}function f(p,c,_,K){p._serialize&&w(_,p._serialize,p.serializers,p._stdErrSerialize);const G=_.slice();let se=G[0];const ce={};K&&(ce.time=K),ce.level=o.levels.values[c];let de=(p._childLevel|0)+1;if(de<1&&(de=1),se!==null&&typeof se=="object"){for(;de--&&typeof G[0]=="object";)Object.assign(ce,G.shift());se=G.length?n(G.shift(),G):void 0}else typeof se=="string"&&(se=n(G.shift(),G));return se!==void 0&&(ce.msg=se),ce}function w(p,c,_,K){for(const G in p)if(K&&p[G]instanceof Error)p[G]=o.stdSerializers.err(p[G]);else if(typeof p[G]=="object"&&!Array.isArray(p[G]))for(const se in p[G])c&&c.indexOf(se)>-1&&se in _&&(p[G][se]=_[se](p[G][se]))}function O(p,c,_){return function(){const K=new Array(1+arguments.length);K[0]=c;for(var G=1;G<K.length;G++)K[G]=arguments[G-1];return p[_].apply(this,K)}}function I(p,c,_){const K=c.send,G=c.ts,se=c.methodLevel,ce=c.methodValue,de=c.val,S=p._logEvent.bindings;w(_,p._serialize||Object.keys(p.serializers),p.serializers,p._stdErrSerialize===void 0?!0:p._stdErrSerialize),p._logEvent.ts=G,p._logEvent.messages=_.filter(function(C){return S.indexOf(C)===-1}),p._logEvent.level.label=se,p._logEvent.level.value=ce,K(se,p._logEvent,de),p._logEvent=P(S)}function P(p){return{ts:0,messages:[],bindings:p||[],level:{label:"",value:0}}}function $(p){const c={type:p.constructor.name,msg:p.message,stack:p.stack};for(const _ in p)c[_]===void 0&&(c[_]=p[_]);return c}function R(p){return typeof p.timestamp=="function"?p.timestamp:p.timestamp===!1?Q:d}function N(){return{}}function z(p){return p}function L(){}function Q(){return!1}function d(){return Date.now()}function b(){return Math.round(Date.now()/1e3)}function y(){return new Date(Date.now()).toISOString()}function v(){function p(c){return typeof c<"u"&&c}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return p(self)||p(window)||p(this)||{}}}return Ec}var Gi={},tf;function Cd(){return tf||(tf=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.PINO_CUSTOM_CONTEXT_KEY=Gi.PINO_LOGGER_DEFAULTS=void 0,Gi.PINO_LOGGER_DEFAULTS={level:"info"},Gi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Gi}var sr={},rf;function vw(){if(rf)return sr;rf=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.generateChildLogger=sr.formatChildLoggerContext=sr.getLoggerContext=sr.setBrowserLoggerContext=sr.getBrowserLoggerContext=sr.getDefaultLoggerOptions=void 0;const n=Cd();function t(f){return Object.assign(Object.assign({},f),{level:(f==null?void 0:f.level)||n.PINO_LOGGER_DEFAULTS.level})}sr.getDefaultLoggerOptions=t;function r(f,w=n.PINO_CUSTOM_CONTEXT_KEY){return f[w]||""}sr.getBrowserLoggerContext=r;function s(f,w,O=n.PINO_CUSTOM_CONTEXT_KEY){return f[O]=w,f}sr.setBrowserLoggerContext=s;function o(f,w=n.PINO_CUSTOM_CONTEXT_KEY){let O="";return typeof f.bindings>"u"?O=r(f,w):O=f.bindings().context||"",O}sr.getLoggerContext=o;function l(f,w,O=n.PINO_CUSTOM_CONTEXT_KEY){const I=o(f,O);return I.trim()?`${I}/${w}`:w}sr.formatChildLoggerContext=l;function m(f,w,O=n.PINO_CUSTOM_CONTEXT_KEY){const I=l(f,w,O),P=f.child({context:I});return s(P,I,O)}return sr.generateChildLogger=m,sr}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const t=Kr,r=t.__importDefault(_w());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(Cd(),n),t.__exportStar(vw(),n)})(Ze);class mw extends Xi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class bw extends Xi{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}}class ww{constructor(t,r){this.logger=t,this.core=r}}let Ew=class extends Xi{constructor(t,r){super(),this.relayer=t,this.logger=r}},Dw=class extends Xi{constructor(t){super()}},Sw=class{constructor(t,r,s,o){this.core=t,this.logger=r,this.name=s}};class Iw extends Xi{constructor(t,r){super(),this.relayer=t,this.logger=r}}class xw extends Xi{constructor(t,r){super(),this.core=t,this.logger=r}}let Ow=class{constructor(t,r){this.projectId=t,this.logger=r}},Aw=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},Cw=class{constructor(t){this.client=t}};const Pw=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),Tw=n=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function du(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return Tw(n)}catch{return n}}function ss(n){return typeof n=="string"?n:Pw(n)||""}var pu={},Pd={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=$e,r=Dr;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},f.prototype.update=function(w,O){if(O===void 0&&(O=w.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var I=0;if(this._bytesHashed+=O,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&O>0;)this._buffer[this._bufferLength++]=w[I++],O--;this._bufferLength===this.blockSize&&(l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(O>=this.blockSize&&(I=l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,w,I,O),O%=this.blockSize);O>0;)this._buffer[this._bufferLength++]=w[I++],O--;return this},f.prototype.finish=function(w){if(!this._finished){var O=this._bytesHashed,I=this._bufferLength,P=O/536870912|0,$=O<<3,R=O%128<112?128:256;this._buffer[I]=128;for(var N=I+1;N<R-8;N++)this._buffer[N]=0;t.writeUint32BE(P,this._buffer,R-8),t.writeUint32BE($,this._buffer,R-4),l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,R),this._finished=!0}for(var N=0;N<this.digestLength/8;N++)t.writeUint32BE(this._stateHi[N],w,N*8),t.writeUint32BE(this._stateLo[N],w,N*8+4);return this},f.prototype.digest=function(){var w=new Uint8Array(this.digestLength);return this.finish(w),w},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(w){return this._stateHi.set(w.stateHi),this._stateLo.set(w.stateLo),this._bufferLength=w.bufferLength,w.buffer&&this._buffer.set(w.buffer),this._bytesHashed=w.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(w){r.wipe(w.stateHi),r.wipe(w.stateLo),w.buffer&&r.wipe(w.buffer),w.bufferLength=0,w.bytesHashed=0},f}();n.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function l(f,w,O,I,P,$,R){for(var N=O[0],z=O[1],L=O[2],Q=O[3],d=O[4],b=O[5],y=O[6],v=O[7],p=I[0],c=I[1],_=I[2],K=I[3],G=I[4],se=I[5],ce=I[6],de=I[7],S,C,te,X,k,W,J,ie;R>=128;){for(var be=0;be<16;be++){var ae=8*be+$;f[be]=t.readUint32BE(P,ae),w[be]=t.readUint32BE(P,ae+4)}for(var be=0;be<80;be++){var we=N,le=z,_e=L,H=Q,B=d,F=b,h=y,T=v,oe=p,fe=c,Ie=_,ze=K,Ve=G,Le=se,dt=ce,pt=de;if(S=v,C=de,k=C&65535,W=C>>>16,J=S&65535,ie=S>>>16,S=(d>>>14|G<<32-14)^(d>>>18|G<<32-18)^(G>>>41-32|d<<32-(41-32)),C=(G>>>14|d<<32-14)^(G>>>18|d<<32-18)^(d>>>41-32|G<<32-(41-32)),k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,S=d&b^~d&y,C=G&se^~G&ce,k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,S=o[be*2],C=o[be*2+1],k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,S=f[be%16],C=w[be%16],k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,W+=k>>>16,J+=W>>>16,ie+=J>>>16,te=J&65535|ie<<16,X=k&65535|W<<16,S=te,C=X,k=C&65535,W=C>>>16,J=S&65535,ie=S>>>16,S=(N>>>28|p<<32-28)^(p>>>34-32|N<<32-(34-32))^(p>>>39-32|N<<32-(39-32)),C=(p>>>28|N<<32-28)^(N>>>34-32|p<<32-(34-32))^(N>>>39-32|p<<32-(39-32)),k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,S=N&z^N&L^z&L,C=p&c^p&_^c&_,k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,W+=k>>>16,J+=W>>>16,ie+=J>>>16,T=J&65535|ie<<16,pt=k&65535|W<<16,S=H,C=ze,k=C&65535,W=C>>>16,J=S&65535,ie=S>>>16,S=te,C=X,k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,W+=k>>>16,J+=W>>>16,ie+=J>>>16,H=J&65535|ie<<16,ze=k&65535|W<<16,z=we,L=le,Q=_e,d=H,b=B,y=F,v=h,N=T,c=oe,_=fe,K=Ie,G=ze,se=Ve,ce=Le,de=dt,p=pt,be%16===15)for(var ae=0;ae<16;ae++)S=f[ae],C=w[ae],k=C&65535,W=C>>>16,J=S&65535,ie=S>>>16,S=f[(ae+9)%16],C=w[(ae+9)%16],k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,te=f[(ae+1)%16],X=w[(ae+1)%16],S=(te>>>1|X<<32-1)^(te>>>8|X<<32-8)^te>>>7,C=(X>>>1|te<<32-1)^(X>>>8|te<<32-8)^(X>>>7|te<<32-7),k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,te=f[(ae+14)%16],X=w[(ae+14)%16],S=(te>>>19|X<<32-19)^(X>>>61-32|te<<32-(61-32))^te>>>6,C=(X>>>19|te<<32-19)^(te>>>61-32|X<<32-(61-32))^(X>>>6|te<<32-6),k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,W+=k>>>16,J+=W>>>16,ie+=J>>>16,f[ae]=J&65535|ie<<16,w[ae]=k&65535|W<<16}S=N,C=p,k=C&65535,W=C>>>16,J=S&65535,ie=S>>>16,S=O[0],C=I[0],k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,W+=k>>>16,J+=W>>>16,ie+=J>>>16,O[0]=N=J&65535|ie<<16,I[0]=p=k&65535|W<<16,S=z,C=c,k=C&65535,W=C>>>16,J=S&65535,ie=S>>>16,S=O[1],C=I[1],k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,W+=k>>>16,J+=W>>>16,ie+=J>>>16,O[1]=z=J&65535|ie<<16,I[1]=c=k&65535|W<<16,S=L,C=_,k=C&65535,W=C>>>16,J=S&65535,ie=S>>>16,S=O[2],C=I[2],k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,W+=k>>>16,J+=W>>>16,ie+=J>>>16,O[2]=L=J&65535|ie<<16,I[2]=_=k&65535|W<<16,S=Q,C=K,k=C&65535,W=C>>>16,J=S&65535,ie=S>>>16,S=O[3],C=I[3],k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,W+=k>>>16,J+=W>>>16,ie+=J>>>16,O[3]=Q=J&65535|ie<<16,I[3]=K=k&65535|W<<16,S=d,C=G,k=C&65535,W=C>>>16,J=S&65535,ie=S>>>16,S=O[4],C=I[4],k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,W+=k>>>16,J+=W>>>16,ie+=J>>>16,O[4]=d=J&65535|ie<<16,I[4]=G=k&65535|W<<16,S=b,C=se,k=C&65535,W=C>>>16,J=S&65535,ie=S>>>16,S=O[5],C=I[5],k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,W+=k>>>16,J+=W>>>16,ie+=J>>>16,O[5]=b=J&65535|ie<<16,I[5]=se=k&65535|W<<16,S=y,C=ce,k=C&65535,W=C>>>16,J=S&65535,ie=S>>>16,S=O[6],C=I[6],k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,W+=k>>>16,J+=W>>>16,ie+=J>>>16,O[6]=y=J&65535|ie<<16,I[6]=ce=k&65535|W<<16,S=v,C=de,k=C&65535,W=C>>>16,J=S&65535,ie=S>>>16,S=O[7],C=I[7],k+=C&65535,W+=C>>>16,J+=S&65535,ie+=S>>>16,W+=k>>>16,J+=W>>>16,ie+=J>>>16,O[7]=v=J&65535|ie<<16,I[7]=de=k&65535|W<<16,$+=128,R-=128}return $}function m(f){var w=new s;w.update(f);var O=w.digest();return w.clean(),O}n.hash=m})(Pd);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const t=In,r=Pd,s=Dr;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function o(H){const B=new Float64Array(16);if(H)for(let F=0;F<H.length;F++)B[F]=H[F];return B}const l=new Uint8Array(32);l[0]=9;const m=o(),f=o([1]),w=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),O=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),I=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),P=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),$=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function R(H,B){for(let F=0;F<16;F++)H[F]=B[F]|0}function N(H){let B=1;for(let F=0;F<16;F++){let h=H[F]+B+65535;B=Math.floor(h/65536),H[F]=h-B*65536}H[0]+=B-1+37*(B-1)}function z(H,B,F){const h=~(F-1);for(let T=0;T<16;T++){const oe=h&(H[T]^B[T]);H[T]^=oe,B[T]^=oe}}function L(H,B){const F=o(),h=o();for(let T=0;T<16;T++)h[T]=B[T];N(h),N(h),N(h);for(let T=0;T<2;T++){F[0]=h[0]-65517;for(let fe=1;fe<15;fe++)F[fe]=h[fe]-65535-(F[fe-1]>>16&1),F[fe-1]&=65535;F[15]=h[15]-32767-(F[14]>>16&1);const oe=F[15]>>16&1;F[14]&=65535,z(h,F,1-oe)}for(let T=0;T<16;T++)H[2*T]=h[T]&255,H[2*T+1]=h[T]>>8}function Q(H,B){let F=0;for(let h=0;h<32;h++)F|=H[h]^B[h];return(1&F-1>>>8)-1}function d(H,B){const F=new Uint8Array(32),h=new Uint8Array(32);return L(F,H),L(h,B),Q(F,h)}function b(H){const B=new Uint8Array(32);return L(B,H),B[0]&1}function y(H,B){for(let F=0;F<16;F++)H[F]=B[2*F]+(B[2*F+1]<<8);H[15]&=32767}function v(H,B,F){for(let h=0;h<16;h++)H[h]=B[h]+F[h]}function p(H,B,F){for(let h=0;h<16;h++)H[h]=B[h]-F[h]}function c(H,B,F){let h,T,oe=0,fe=0,Ie=0,ze=0,Ve=0,Le=0,dt=0,pt=0,je=0,xe=0,Ue=0,Re=0,qe=0,Ae=0,Fe=0,Se=0,Ce=0,He=0,Oe=0,ke=0,Ge=0,et=0,tt=0,Je=0,Zt=0,ur=0,Vr=0,er=0,ti=0,pi=0,Ti=0,bt=F[0],gt=F[1],wt=F[2],Et=F[3],vt=F[4],yt=F[5],Ut=F[6],Rt=F[7],Dt=F[8],Ft=F[9],St=F[10],At=F[11],It=F[12],ht=F[13],$t=F[14],Lt=F[15];h=B[0],oe+=h*bt,fe+=h*gt,Ie+=h*wt,ze+=h*Et,Ve+=h*vt,Le+=h*yt,dt+=h*Ut,pt+=h*Rt,je+=h*Dt,xe+=h*Ft,Ue+=h*St,Re+=h*At,qe+=h*It,Ae+=h*ht,Fe+=h*$t,Se+=h*Lt,h=B[1],fe+=h*bt,Ie+=h*gt,ze+=h*wt,Ve+=h*Et,Le+=h*vt,dt+=h*yt,pt+=h*Ut,je+=h*Rt,xe+=h*Dt,Ue+=h*Ft,Re+=h*St,qe+=h*At,Ae+=h*It,Fe+=h*ht,Se+=h*$t,Ce+=h*Lt,h=B[2],Ie+=h*bt,ze+=h*gt,Ve+=h*wt,Le+=h*Et,dt+=h*vt,pt+=h*yt,je+=h*Ut,xe+=h*Rt,Ue+=h*Dt,Re+=h*Ft,qe+=h*St,Ae+=h*At,Fe+=h*It,Se+=h*ht,Ce+=h*$t,He+=h*Lt,h=B[3],ze+=h*bt,Ve+=h*gt,Le+=h*wt,dt+=h*Et,pt+=h*vt,je+=h*yt,xe+=h*Ut,Ue+=h*Rt,Re+=h*Dt,qe+=h*Ft,Ae+=h*St,Fe+=h*At,Se+=h*It,Ce+=h*ht,He+=h*$t,Oe+=h*Lt,h=B[4],Ve+=h*bt,Le+=h*gt,dt+=h*wt,pt+=h*Et,je+=h*vt,xe+=h*yt,Ue+=h*Ut,Re+=h*Rt,qe+=h*Dt,Ae+=h*Ft,Fe+=h*St,Se+=h*At,Ce+=h*It,He+=h*ht,Oe+=h*$t,ke+=h*Lt,h=B[5],Le+=h*bt,dt+=h*gt,pt+=h*wt,je+=h*Et,xe+=h*vt,Ue+=h*yt,Re+=h*Ut,qe+=h*Rt,Ae+=h*Dt,Fe+=h*Ft,Se+=h*St,Ce+=h*At,He+=h*It,Oe+=h*ht,ke+=h*$t,Ge+=h*Lt,h=B[6],dt+=h*bt,pt+=h*gt,je+=h*wt,xe+=h*Et,Ue+=h*vt,Re+=h*yt,qe+=h*Ut,Ae+=h*Rt,Fe+=h*Dt,Se+=h*Ft,Ce+=h*St,He+=h*At,Oe+=h*It,ke+=h*ht,Ge+=h*$t,et+=h*Lt,h=B[7],pt+=h*bt,je+=h*gt,xe+=h*wt,Ue+=h*Et,Re+=h*vt,qe+=h*yt,Ae+=h*Ut,Fe+=h*Rt,Se+=h*Dt,Ce+=h*Ft,He+=h*St,Oe+=h*At,ke+=h*It,Ge+=h*ht,et+=h*$t,tt+=h*Lt,h=B[8],je+=h*bt,xe+=h*gt,Ue+=h*wt,Re+=h*Et,qe+=h*vt,Ae+=h*yt,Fe+=h*Ut,Se+=h*Rt,Ce+=h*Dt,He+=h*Ft,Oe+=h*St,ke+=h*At,Ge+=h*It,et+=h*ht,tt+=h*$t,Je+=h*Lt,h=B[9],xe+=h*bt,Ue+=h*gt,Re+=h*wt,qe+=h*Et,Ae+=h*vt,Fe+=h*yt,Se+=h*Ut,Ce+=h*Rt,He+=h*Dt,Oe+=h*Ft,ke+=h*St,Ge+=h*At,et+=h*It,tt+=h*ht,Je+=h*$t,Zt+=h*Lt,h=B[10],Ue+=h*bt,Re+=h*gt,qe+=h*wt,Ae+=h*Et,Fe+=h*vt,Se+=h*yt,Ce+=h*Ut,He+=h*Rt,Oe+=h*Dt,ke+=h*Ft,Ge+=h*St,et+=h*At,tt+=h*It,Je+=h*ht,Zt+=h*$t,ur+=h*Lt,h=B[11],Re+=h*bt,qe+=h*gt,Ae+=h*wt,Fe+=h*Et,Se+=h*vt,Ce+=h*yt,He+=h*Ut,Oe+=h*Rt,ke+=h*Dt,Ge+=h*Ft,et+=h*St,tt+=h*At,Je+=h*It,Zt+=h*ht,ur+=h*$t,Vr+=h*Lt,h=B[12],qe+=h*bt,Ae+=h*gt,Fe+=h*wt,Se+=h*Et,Ce+=h*vt,He+=h*yt,Oe+=h*Ut,ke+=h*Rt,Ge+=h*Dt,et+=h*Ft,tt+=h*St,Je+=h*At,Zt+=h*It,ur+=h*ht,Vr+=h*$t,er+=h*Lt,h=B[13],Ae+=h*bt,Fe+=h*gt,Se+=h*wt,Ce+=h*Et,He+=h*vt,Oe+=h*yt,ke+=h*Ut,Ge+=h*Rt,et+=h*Dt,tt+=h*Ft,Je+=h*St,Zt+=h*At,ur+=h*It,Vr+=h*ht,er+=h*$t,ti+=h*Lt,h=B[14],Fe+=h*bt,Se+=h*gt,Ce+=h*wt,He+=h*Et,Oe+=h*vt,ke+=h*yt,Ge+=h*Ut,et+=h*Rt,tt+=h*Dt,Je+=h*Ft,Zt+=h*St,ur+=h*At,Vr+=h*It,er+=h*ht,ti+=h*$t,pi+=h*Lt,h=B[15],Se+=h*bt,Ce+=h*gt,He+=h*wt,Oe+=h*Et,ke+=h*vt,Ge+=h*yt,et+=h*Ut,tt+=h*Rt,Je+=h*Dt,Zt+=h*Ft,ur+=h*St,Vr+=h*At,er+=h*It,ti+=h*ht,pi+=h*$t,Ti+=h*Lt,oe+=38*Ce,fe+=38*He,Ie+=38*Oe,ze+=38*ke,Ve+=38*Ge,Le+=38*et,dt+=38*tt,pt+=38*Je,je+=38*Zt,xe+=38*ur,Ue+=38*Vr,Re+=38*er,qe+=38*ti,Ae+=38*pi,Fe+=38*Ti,T=1,h=oe+T+65535,T=Math.floor(h/65536),oe=h-T*65536,h=fe+T+65535,T=Math.floor(h/65536),fe=h-T*65536,h=Ie+T+65535,T=Math.floor(h/65536),Ie=h-T*65536,h=ze+T+65535,T=Math.floor(h/65536),ze=h-T*65536,h=Ve+T+65535,T=Math.floor(h/65536),Ve=h-T*65536,h=Le+T+65535,T=Math.floor(h/65536),Le=h-T*65536,h=dt+T+65535,T=Math.floor(h/65536),dt=h-T*65536,h=pt+T+65535,T=Math.floor(h/65536),pt=h-T*65536,h=je+T+65535,T=Math.floor(h/65536),je=h-T*65536,h=xe+T+65535,T=Math.floor(h/65536),xe=h-T*65536,h=Ue+T+65535,T=Math.floor(h/65536),Ue=h-T*65536,h=Re+T+65535,T=Math.floor(h/65536),Re=h-T*65536,h=qe+T+65535,T=Math.floor(h/65536),qe=h-T*65536,h=Ae+T+65535,T=Math.floor(h/65536),Ae=h-T*65536,h=Fe+T+65535,T=Math.floor(h/65536),Fe=h-T*65536,h=Se+T+65535,T=Math.floor(h/65536),Se=h-T*65536,oe+=T-1+37*(T-1),T=1,h=oe+T+65535,T=Math.floor(h/65536),oe=h-T*65536,h=fe+T+65535,T=Math.floor(h/65536),fe=h-T*65536,h=Ie+T+65535,T=Math.floor(h/65536),Ie=h-T*65536,h=ze+T+65535,T=Math.floor(h/65536),ze=h-T*65536,h=Ve+T+65535,T=Math.floor(h/65536),Ve=h-T*65536,h=Le+T+65535,T=Math.floor(h/65536),Le=h-T*65536,h=dt+T+65535,T=Math.floor(h/65536),dt=h-T*65536,h=pt+T+65535,T=Math.floor(h/65536),pt=h-T*65536,h=je+T+65535,T=Math.floor(h/65536),je=h-T*65536,h=xe+T+65535,T=Math.floor(h/65536),xe=h-T*65536,h=Ue+T+65535,T=Math.floor(h/65536),Ue=h-T*65536,h=Re+T+65535,T=Math.floor(h/65536),Re=h-T*65536,h=qe+T+65535,T=Math.floor(h/65536),qe=h-T*65536,h=Ae+T+65535,T=Math.floor(h/65536),Ae=h-T*65536,h=Fe+T+65535,T=Math.floor(h/65536),Fe=h-T*65536,h=Se+T+65535,T=Math.floor(h/65536),Se=h-T*65536,oe+=T-1+37*(T-1),H[0]=oe,H[1]=fe,H[2]=Ie,H[3]=ze,H[4]=Ve,H[5]=Le,H[6]=dt,H[7]=pt,H[8]=je,H[9]=xe,H[10]=Ue,H[11]=Re,H[12]=qe,H[13]=Ae,H[14]=Fe,H[15]=Se}function _(H,B){c(H,B,B)}function K(H,B){const F=o();let h;for(h=0;h<16;h++)F[h]=B[h];for(h=253;h>=0;h--)_(F,F),h!==2&&h!==4&&c(F,F,B);for(h=0;h<16;h++)H[h]=F[h]}function G(H,B){const F=o();let h;for(h=0;h<16;h++)F[h]=B[h];for(h=250;h>=0;h--)_(F,F),h!==1&&c(F,F,B);for(h=0;h<16;h++)H[h]=F[h]}function se(H,B){const F=o(),h=o(),T=o(),oe=o(),fe=o(),Ie=o(),ze=o(),Ve=o(),Le=o();p(F,H[1],H[0]),p(Le,B[1],B[0]),c(F,F,Le),v(h,H[0],H[1]),v(Le,B[0],B[1]),c(h,h,Le),c(T,H[3],B[3]),c(T,T,O),c(oe,H[2],B[2]),v(oe,oe,oe),p(fe,h,F),p(Ie,oe,T),v(ze,oe,T),v(Ve,h,F),c(H[0],fe,Ie),c(H[1],Ve,ze),c(H[2],ze,Ie),c(H[3],fe,Ve)}function ce(H,B,F){for(let h=0;h<4;h++)z(H[h],B[h],F)}function de(H,B){const F=o(),h=o(),T=o();K(T,B[2]),c(F,B[0],T),c(h,B[1],T),L(H,h),H[31]^=b(F)<<7}function S(H,B,F){R(H[0],m),R(H[1],f),R(H[2],f),R(H[3],m);for(let h=255;h>=0;--h){const T=F[h/8|0]>>(h&7)&1;ce(H,B,T),se(B,H),se(H,H),ce(H,B,T)}}function C(H,B){const F=[o(),o(),o(),o()];R(F[0],I),R(F[1],P),R(F[2],f),c(F[3],I,P),S(H,F,B)}function te(H){if(H.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const B=(0,r.hash)(H);B[0]&=248,B[31]&=127,B[31]|=64;const F=new Uint8Array(32),h=[o(),o(),o(),o()];C(h,B),de(F,h);const T=new Uint8Array(64);return T.set(H),T.set(F,32),{publicKey:F,secretKey:T}}n.generateKeyPairFromSeed=te;function X(H){const B=(0,t.randomBytes)(32,H),F=te(B);return(0,s.wipe)(B),F}n.generateKeyPair=X;function k(H){if(H.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(H.subarray(32))}n.extractPublicKeyFromSecretKey=k;const W=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(H,B){let F,h,T,oe;for(h=63;h>=32;--h){for(F=0,T=h-32,oe=h-12;T<oe;++T)B[T]+=F-16*B[h]*W[T-(h-32)],F=Math.floor((B[T]+128)/256),B[T]-=F*256;B[T]+=F,B[h]=0}for(F=0,T=0;T<32;T++)B[T]+=F-(B[31]>>4)*W[T],F=B[T]>>8,B[T]&=255;for(T=0;T<32;T++)B[T]-=F*W[T];for(h=0;h<32;h++)B[h+1]+=B[h]>>8,H[h]=B[h]&255}function ie(H){const B=new Float64Array(64);for(let F=0;F<64;F++)B[F]=H[F];for(let F=0;F<64;F++)H[F]=0;J(H,B)}function be(H,B){const F=new Float64Array(64),h=[o(),o(),o(),o()],T=(0,r.hash)(H.subarray(0,32));T[0]&=248,T[31]&=127,T[31]|=64;const oe=new Uint8Array(64);oe.set(T.subarray(32),32);const fe=new r.SHA512;fe.update(oe.subarray(32)),fe.update(B);const Ie=fe.digest();fe.clean(),ie(Ie),C(h,Ie),de(oe,h),fe.reset(),fe.update(oe.subarray(0,32)),fe.update(H.subarray(32)),fe.update(B);const ze=fe.digest();ie(ze);for(let Ve=0;Ve<32;Ve++)F[Ve]=Ie[Ve];for(let Ve=0;Ve<32;Ve++)for(let Le=0;Le<32;Le++)F[Ve+Le]+=ze[Ve]*T[Le];return J(oe.subarray(32),F),oe}n.sign=be;function ae(H,B){const F=o(),h=o(),T=o(),oe=o(),fe=o(),Ie=o(),ze=o();return R(H[2],f),y(H[1],B),_(T,H[1]),c(oe,T,w),p(T,T,H[2]),v(oe,H[2],oe),_(fe,oe),_(Ie,fe),c(ze,Ie,fe),c(F,ze,T),c(F,F,oe),G(F,F),c(F,F,T),c(F,F,oe),c(F,F,oe),c(H[0],F,oe),_(h,H[0]),c(h,h,oe),d(h,T)&&c(H[0],H[0],$),_(h,H[0]),c(h,h,oe),d(h,T)?-1:(b(H[0])===B[31]>>7&&p(H[0],m,H[0]),c(H[3],H[0],H[1]),0)}function we(H,B,F){const h=new Uint8Array(32),T=[o(),o(),o(),o()],oe=[o(),o(),o(),o()];if(F.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(ae(oe,H))return!1;const fe=new r.SHA512;fe.update(F.subarray(0,32)),fe.update(H),fe.update(B);const Ie=fe.digest();return ie(Ie),S(T,oe,Ie),C(oe,F.subarray(32)),se(T,oe),de(h,T),!Q(F,h)}n.verify=we;function le(H){let B=[o(),o(),o(),o()];if(ae(B,H))throw new Error("Ed25519: invalid public key");let F=o(),h=o(),T=B[1];v(F,f,T),p(h,f,T),K(h,h),c(F,F,h);let oe=new Uint8Array(32);return L(oe,F),oe}n.convertPublicKeyToX25519=le;function _e(H){const B=(0,r.hash)(H.subarray(0,32));B[0]&=248,B[31]&=127,B[31]|=64;const F=new Uint8Array(B.subarray(0,32));return(0,s.wipe)(B),F}n.convertSecretKeyToX25519=_e})(pu);const Nw="EdDSA",Uw="JWT",Td=".",Nd="base64url",Rw="utf8",Fw="utf8",$w=":",Lw="did",Mw="key",nf="base58btc",jw="z",qw="K36",Bw=32;function xa(n){return cr(yr(ss(n),Rw),Nd)}function Ud(n){const t=yr(qw,nf),r=jw+cr(jc([t,n]),nf);return[Lw,Mw,r].join($w)}function zw(n){return cr(n,Nd)}function Hw(n){return yr([xa(n.header),xa(n.payload)].join(Td),Fw)}function Kw(n){return[xa(n.header),xa(n.payload),zw(n.signature)].join(Td)}function sf(n=In.randomBytes(Bw)){return pu.generateKeyPairFromSeed(n)}async function Vw(n,t,r,s,o=ve.fromMiliseconds(Date.now())){const l={alg:Nw,typ:Uw},m=Ud(s.publicKey),f=o+r,w={iss:m,sub:n,aud:t,iat:o,exp:f},O=Hw({header:l,payload:w}),I=pu.sign(s.secretKey,O);return Kw({header:l,payload:w,signature:I})}var af=globalThis&&globalThis.__spreadArray||function(n,t,r){if(r||arguments.length===2)for(var s=0,o=t.length,l;s<o;s++)(l||!(s in t))&&(l||(l=Array.prototype.slice.call(t,0,s)),l[s]=t[s]);return n.concat(l||Array.prototype.slice.call(t))},kw=function(){function n(t,r,s){this.name=t,this.version=r,this.os=s,this.type="browser"}return n}(),Ww=function(){function n(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return n}(),Gw=function(){function n(t,r,s,o){this.name=t,this.version=r,this.os=s,this.bot=o,this.type="bot-device"}return n}(),Yw=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),Jw=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),Xw=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Qw=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,of=3,Zw=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Xw]],cf=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function eE(n){return n?uf(n):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Jw:typeof navigator<"u"?uf(navigator.userAgent):iE()}function tE(n){return n!==""&&Zw.reduce(function(t,r){var s=r[0],o=r[1];if(t)return t;var l=o.exec(n);return!!l&&[s,l]},!1)}function uf(n){var t=tE(n);if(!t)return null;var r=t[0],s=t[1];if(r==="searchbot")return new Yw;var o=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);o?o.length<of&&(o=af(af([],o,!0),nE(of-o.length),!0)):o=[];var l=o.join("."),m=rE(n),f=Qw.exec(n);return f&&f[1]?new Gw(r,l,m,f[1]):new kw(r,l,m)}function rE(n){for(var t=0,r=cf.length;t<r;t++){var s=cf[t],o=s[0],l=s[1],m=l.exec(n);if(m)return o}return null}function iE(){var n=typeof process<"u"&&process.version;return n?new Ww(process.version.slice(1)):null}function nE(n){for(var t=[],r=0;r<n;r++)t.push("0");return t}var gu={};Object.defineProperty(gu,"__esModule",{value:!0});var Rd=gu.getWindowMetadata=void 0;const hf=su;function sE(){let n,t;try{n=hf.getDocumentOrThrow(),t=hf.getLocationOrThrow()}catch{return null}function r(){const P=n.getElementsByTagName("link"),$=[];for(let R=0;R<P.length;R++){const N=P[R],z=N.getAttribute("rel");if(z&&z.toLowerCase().indexOf("icon")>-1){const L=N.getAttribute("href");if(L)if(L.toLowerCase().indexOf("https:")===-1&&L.toLowerCase().indexOf("http:")===-1&&L.indexOf("//")!==0){let Q=t.protocol+"//"+t.host;if(L.indexOf("/")===0)Q+=L;else{const d=t.pathname.split("/");d.pop();const b=d.join("/");Q+=b+"/"+L}$.push(Q)}else if(L.indexOf("//")===0){const Q=t.protocol+L;$.push(Q)}else $.push(L)}}return $}function s(...P){const $=n.getElementsByTagName("meta");for(let R=0;R<$.length;R++){const N=$[R],z=["itemprop","property","name"].map(L=>N.getAttribute(L)).filter(L=>L?P.includes(L):!1);if(z.length&&z){const L=N.getAttribute("content");if(L)return L}}return""}function o(){let P=s("name","og:site_name","og:title","twitter:title");return P||(P=n.title),P}function l(){return s("description","og:description","twitter:description","keywords")}const m=o(),f=l(),w=t.origin,O=r();return{description:f,url:w,icons:O,name:m}}Rd=gu.getWindowMetadata=sE;var as={};(function(n){const t=tu,r=ru,s=eu,o=fu,l=d=>d==null,m=Symbol("encodeFragmentIdentifier");function f(d){switch(d.arrayFormat){case"index":return b=>(y,v)=>{const p=y.length;return v===void 0||d.skipNull&&v===null||d.skipEmptyString&&v===""?y:v===null?[...y,[I(b,d),"[",p,"]"].join("")]:[...y,[I(b,d),"[",I(p,d),"]=",I(v,d)].join("")]};case"bracket":return b=>(y,v)=>v===void 0||d.skipNull&&v===null||d.skipEmptyString&&v===""?y:v===null?[...y,[I(b,d),"[]"].join("")]:[...y,[I(b,d),"[]=",I(v,d)].join("")];case"colon-list-separator":return b=>(y,v)=>v===void 0||d.skipNull&&v===null||d.skipEmptyString&&v===""?y:v===null?[...y,[I(b,d),":list="].join("")]:[...y,[I(b,d),":list=",I(v,d)].join("")];case"comma":case"separator":case"bracket-separator":{const b=d.arrayFormat==="bracket-separator"?"[]=":"=";return y=>(v,p)=>p===void 0||d.skipNull&&p===null||d.skipEmptyString&&p===""?v:(p=p===null?"":p,v.length===0?[[I(y,d),b,I(p,d)].join("")]:[[v,I(p,d)].join(d.arrayFormatSeparator)])}default:return b=>(y,v)=>v===void 0||d.skipNull&&v===null||d.skipEmptyString&&v===""?y:v===null?[...y,I(b,d)]:[...y,[I(b,d),"=",I(v,d)].join("")]}}function w(d){let b;switch(d.arrayFormat){case"index":return(y,v,p)=>{if(b=/\[(\d*)\]$/.exec(y),y=y.replace(/\[\d*\]$/,""),!b){p[y]=v;return}p[y]===void 0&&(p[y]={}),p[y][b[1]]=v};case"bracket":return(y,v,p)=>{if(b=/(\[\])$/.exec(y),y=y.replace(/\[\]$/,""),!b){p[y]=v;return}if(p[y]===void 0){p[y]=[v];return}p[y]=[].concat(p[y],v)};case"colon-list-separator":return(y,v,p)=>{if(b=/(:list)$/.exec(y),y=y.replace(/:list$/,""),!b){p[y]=v;return}if(p[y]===void 0){p[y]=[v];return}p[y]=[].concat(p[y],v)};case"comma":case"separator":return(y,v,p)=>{const c=typeof v=="string"&&v.includes(d.arrayFormatSeparator),_=typeof v=="string"&&!c&&P(v,d).includes(d.arrayFormatSeparator);v=_?P(v,d):v;const K=c||_?v.split(d.arrayFormatSeparator).map(G=>P(G,d)):v===null?v:P(v,d);p[y]=K};case"bracket-separator":return(y,v,p)=>{const c=/(\[\])$/.test(y);if(y=y.replace(/\[\]$/,""),!c){p[y]=v&&P(v,d);return}const _=v===null?[]:v.split(d.arrayFormatSeparator).map(K=>P(K,d));if(p[y]===void 0){p[y]=_;return}p[y]=[].concat(p[y],_)};default:return(y,v,p)=>{if(p[y]===void 0){p[y]=v;return}p[y]=[].concat(p[y],v)}}}function O(d){if(typeof d!="string"||d.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function I(d,b){return b.encode?b.strict?t(d):encodeURIComponent(d):d}function P(d,b){return b.decode?r(d):d}function $(d){return Array.isArray(d)?d.sort():typeof d=="object"?$(Object.keys(d)).sort((b,y)=>Number(b)-Number(y)).map(b=>d[b]):d}function R(d){const b=d.indexOf("#");return b!==-1&&(d=d.slice(0,b)),d}function N(d){let b="";const y=d.indexOf("#");return y!==-1&&(b=d.slice(y)),b}function z(d){d=R(d);const b=d.indexOf("?");return b===-1?"":d.slice(b+1)}function L(d,b){return b.parseNumbers&&!Number.isNaN(Number(d))&&typeof d=="string"&&d.trim()!==""?d=Number(d):b.parseBooleans&&d!==null&&(d.toLowerCase()==="true"||d.toLowerCase()==="false")&&(d=d.toLowerCase()==="true"),d}function Q(d,b){b=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},b),O(b.arrayFormatSeparator);const y=w(b),v=Object.create(null);if(typeof d!="string"||(d=d.trim().replace(/^[?#&]/,""),!d))return v;for(const p of d.split("&")){if(p==="")continue;let[c,_]=s(b.decode?p.replace(/\+/g," "):p,"=");_=_===void 0?null:["comma","separator","bracket-separator"].includes(b.arrayFormat)?_:P(_,b),y(P(c,b),_,v)}for(const p of Object.keys(v)){const c=v[p];if(typeof c=="object"&&c!==null)for(const _ of Object.keys(c))c[_]=L(c[_],b);else v[p]=L(c,b)}return b.sort===!1?v:(b.sort===!0?Object.keys(v).sort():Object.keys(v).sort(b.sort)).reduce((p,c)=>{const _=v[c];return _&&typeof _=="object"&&!Array.isArray(_)?p[c]=$(_):p[c]=_,p},Object.create(null))}n.extract=z,n.parse=Q,n.stringify=(d,b)=>{if(!d)return"";b=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},b),O(b.arrayFormatSeparator);const y=_=>b.skipNull&&l(d[_])||b.skipEmptyString&&d[_]==="",v=f(b),p={};for(const _ of Object.keys(d))y(_)||(p[_]=d[_]);const c=Object.keys(p);return b.sort!==!1&&c.sort(b.sort),c.map(_=>{const K=d[_];return K===void 0?"":K===null?I(_,b):Array.isArray(K)?K.length===0&&b.arrayFormat==="bracket-separator"?I(_,b)+"[]":K.reduce(v(_),[]).join("&"):I(_,b)+"="+I(K,b)}).filter(_=>_.length>0).join("&")},n.parseUrl=(d,b)=>{b=Object.assign({decode:!0},b);const[y,v]=s(d,"#");return Object.assign({url:y.split("?")[0]||"",query:Q(z(d),b)},b&&b.parseFragmentIdentifier&&v?{fragmentIdentifier:P(v,b)}:{})},n.stringifyUrl=(d,b)=>{b=Object.assign({encode:!0,strict:!0,[m]:!0},b);const y=R(d.url).split("?")[0]||"",v=n.extract(d.url),p=n.parse(v,{sort:!1}),c=Object.assign(p,d.query);let _=n.stringify(c,b);_&&(_=`?${_}`);let K=N(d.url);return d.fragmentIdentifier&&(K=`#${b[m]?I(d.fragmentIdentifier,b):d.fragmentIdentifier}`),`${y}${_}${K}`},n.pick=(d,b,y)=>{y=Object.assign({parseFragmentIdentifier:!0,[m]:!1},y);const{url:v,query:p,fragmentIdentifier:c}=n.parseUrl(d,y);return n.stringifyUrl({url:v,query:o(p,b),fragmentIdentifier:c},y)},n.exclude=(d,b,y)=>{const v=Array.isArray(b)?p=>!b.includes(p):(p,c)=>!b(p,c);return n.pick(d,v,y)}})(as);function Fd(n,t){return n.includes(":")?[n]:t.chains||[]}const $d="base10",or="base16",Bc="base64pad",yu="utf8",Ld=0,Qi=1,aE=0,lf=1,zc=12,_u=32;function oE(){const n=uu.generateKeyPair();return{privateKey:cr(n.secretKey,or),publicKey:cr(n.publicKey,or)}}function Hc(){const n=In.randomBytes(_u);return cr(n,or)}function cE(n,t){const r=uu.sharedKey(yr(n,or),yr(t,or)),s=new Mm(La.SHA256,r).expand(_u);return cr(s,or)}function uE(n){const t=La.hash(yr(n,or));return cr(t,or)}function Sn(n){const t=La.hash(yr(n,yu));return cr(t,or)}function hE(n){return yr(`${n}`,$d)}function ls(n){return Number(cr(n,$d))}function lE(n){const t=hE(typeof n.type<"u"?n.type:Ld);if(ls(t)===Qi&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?yr(n.senderPublicKey,or):void 0,s=typeof n.iv<"u"?yr(n.iv,or):In.randomBytes(zc),o=new ou.ChaCha20Poly1305(yr(n.symKey,or)).seal(s,yr(n.message,yu));return dE({type:t,sealed:o,iv:s,senderPublicKey:r})}function fE(n){const t=new ou.ChaCha20Poly1305(yr(n.symKey,or)),{sealed:r,iv:s}=Oa(n.encoded),o=t.open(s,r);if(o===null)throw new Error("Failed to decrypt");return cr(o,yu)}function dE(n){if(ls(n.type)===Qi){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return cr(jc([n.type,n.senderPublicKey,n.iv,n.sealed]),Bc)}return cr(jc([n.type,n.iv,n.sealed]),Bc)}function Oa(n){const t=yr(n,Bc),r=t.slice(aE,lf),s=lf;if(ls(r)===Qi){const f=s+_u,w=f+zc,O=t.slice(s,f),I=t.slice(f,w),P=t.slice(w);return{type:r,sealed:P,iv:I,senderPublicKey:O}}const o=s+zc,l=t.slice(s,o),m=t.slice(o);return{type:r,sealed:m,iv:l}}function pE(n,t){const r=Oa(n);return Md({type:ls(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?cr(r.senderPublicKey,or):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function Md(n){const t=(n==null?void 0:n.type)||Ld;if(t===Qi){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function ff(n){return n.type===Qi&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var gE=Object.defineProperty,df=Object.getOwnPropertySymbols,yE=Object.prototype.hasOwnProperty,_E=Object.prototype.propertyIsEnumerable,pf=(n,t,r)=>t in n?gE(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,gf=(n,t)=>{for(var r in t||(t={}))yE.call(t,r)&&pf(n,r,t[r]);if(df)for(var r of df(t))_E.call(t,r)&&pf(n,r,t[r]);return n};const vE="ReactNative",Yi={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},mE="js";function vu(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function jd(){return!Jv()&&!!ad()&&navigator.product===vE}function mu(){return!vu()&&!!ad()}function qd(){return jd()?Yi.reactNative:vu()?Yi.node:mu()?Yi.browser:Yi.unknown}function bE(n,t){let r=as.parse(n);return r=gf(gf({},r),t),n=as.stringify(r),n}function wE(){return Rd()||{name:"",description:"",url:"",icons:[""]}}function EE(){const n=eE();if(n===null)return"unknown";const t=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[t,n.name,n.version].join("-"):[t,n.version].join("-")}function DE(){var n;const t=qd();return t===Yi.browser?[t,((n=Xv())==null?void 0:n.host)||"unknown"].join(":"):t}function SE(n,t,r){const s=EE(),o=DE();return[[n,t].join("-"),[mE,r].join("-"),s,o].join("/")}function IE({protocol:n,version:t,relayUrl:r,sdkVersion:s,auth:o,projectId:l,useOnCloseEvent:m}){const f=r.split("?"),w=SE(n,t,s),O={auth:o,ua:w,projectId:l,useOnCloseEvent:m||void 0},I=bE(f[1]||"",O);return f[0]+"?"+I}function Ji(n,t){return n.filter(r=>t.includes(r)).length===n.length}function Bd(n){return Object.fromEntries(n.entries())}function zd(n){return new Map(Object.entries(n))}function Dn(n=ve.FIVE_MINUTES,t){const r=ve.toMiliseconds(n||ve.FIVE_MINUTES);let s,o,l;return{resolve:m=>{l&&s&&(clearTimeout(l),s(m))},reject:m=>{l&&o&&(clearTimeout(l),o(m))},done:()=>new Promise((m,f)=>{l=setTimeout(()=>{f(new Error(t))},r),s=m,o=f})}}function Aa(n,t,r){return new Promise(async(s,o)=>{const l=setTimeout(()=>o(new Error(r)),t);try{const m=await n;s(m)}catch(m){o(m)}clearTimeout(l)})}function Hd(n,t){if(typeof t=="string"&&t.startsWith(`${n}:`))return t;if(n.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(n.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${n}`)}function xE(n){return Hd("topic",n)}function OE(n){return Hd("id",n)}function Kd(n){const[t,r]=n.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function ei(n,t){return ve.fromMiliseconds((t||Date.now())+ve.toMiliseconds(n))}function Ii(n){return Date.now()>=ve.toMiliseconds(n)}function qt(n,t){return`${n}${t?`:${t}`:""}`}async function AE({id:n,topic:t,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const l=`${o}/wc?requestId=${n}&sessionTopic=${t}`,m=qd();m===Yi.browser?window.open(l,"_self","noreferrer noopener"):m===Yi.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(l)}catch(s){console.error(s)}}const CE="irn";function Kc(n){return(n==null?void 0:n.relay)||{protocol:CE}}function wa(n){const t=Qb[n];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${n}`);return t}var PE=Object.defineProperty,yf=Object.getOwnPropertySymbols,TE=Object.prototype.hasOwnProperty,NE=Object.prototype.propertyIsEnumerable,_f=(n,t,r)=>t in n?PE(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,UE=(n,t)=>{for(var r in t||(t={}))TE.call(t,r)&&_f(n,r,t[r]);if(yf)for(var r of yf(t))NE.call(t,r)&&_f(n,r,t[r]);return n};function RE(n,t="-"){const r={},s="relay"+t;return Object.keys(n).forEach(o=>{if(o.startsWith(s)){const l=o.replace(s,""),m=n[o];r[l]=m}}),r}function FE(n){const t=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,t),o=n.substring(t+1,r).split("@"),l=typeof r<"u"?n.substring(r):"",m=as.parse(l);return{protocol:s,topic:$E(o[0]),version:parseInt(o[1],10),symKey:m.symKey,relay:RE(m)}}function $E(n){return n.startsWith("//")?n.substring(2):n}function LE(n,t="-"){const r="relay",s={};return Object.keys(n).forEach(o=>{const l=r+t+o;n[o]&&(s[l]=n[o])}),s}function ME(n){return`${n.protocol}:${n.topic}@${n.version}?`+as.stringify(UE({symKey:n.symKey},LE(n.relay)))}function xn(n){const t=[];return n.forEach(r=>{const[s,o]=r.split(":");t.push(`${s}:${o}`)}),t}function jE(n){const t=[];return Object.values(n).forEach(r=>{t.push(...xn(r.accounts))}),t}function qE(n,t){const r=[];return Object.values(n).forEach(s=>{xn(s.accounts).includes(t)&&r.push(...s.methods)}),r}function BE(n,t){const r=[];return Object.values(n).forEach(s=>{xn(s.accounts).includes(t)&&r.push(...s.events)}),r}function zE(n,t){const r=Ea(n,t);if(r)throw new Error(r.message);const s={};for(const[o,l]of Object.entries(n))s[o]={methods:l.methods,events:l.events,chains:l.accounts.map(m=>`${m.split(":")[0]}:${m.split(":")[1]}`)};return s}const HE={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},KE={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function he(n,t){const{message:r,code:s}=KE[n];return{message:t?`${r} ${t}`:r,code:s}}function Vt(n,t){const{message:r,code:s}=HE[n];return{message:t?`${r} ${t}`:r,code:s}}function fs(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function ns(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function ar(n){return typeof n>"u"}function kt(n,t){return t&&ar(n)?!0:typeof n=="string"&&!!n.trim().length}function bu(n,t){return t&&ar(n)?!0:typeof n=="number"&&!isNaN(n)}function VE(n,t){const{requiredNamespaces:r}=t,s=Object.keys(n.namespaces),o=Object.keys(r);let l=!0;return Ji(o,s)?(s.forEach(m=>{const{accounts:f,methods:w,events:O}=n.namespaces[m],I=xn(f),P=r[m];(!Ji(Fd(m,P),I)||!Ji(P.methods,w)||!Ji(P.events,O))&&(l=!1)}),l):!1}function wu(n){return kt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function kE(n){if(kt(n,!1)&&n.includes(":")){const t=n.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&wu(r)}}return!1}function WE(n){if(kt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function GE(n){var t;return(t=n==null?void 0:n.proposer)==null?void 0:t.publicKey}function YE(n){return n==null?void 0:n.topic}function JE(n,t){let r=null;return kt(n==null?void 0:n.publicKey,!1)||(r=he("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function vf(n){let t=!0;return fs(n)?n.length&&(t=n.every(r=>kt(r,!1))):t=!1,t}function XE(n,t,r){let s=null;return fs(t)?t.forEach(o=>{s||(!wu(o)||!o.includes(n))&&(s=Vt("UNSUPPORTED_CHAINS",`${r}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):s=Vt("UNSUPPORTED_CHAINS",`${r}, chains ${t} should be an array of strings conforming to "namespace:chainId" format`),s}function QE(n,t){let r=null;return Object.entries(n).forEach(([s,o])=>{if(r)return;const l=XE(s,Fd(s,o),`${t} requiredNamespace`);l&&(r=l)}),r}function ZE(n,t){let r=null;return fs(n)?n.forEach(s=>{r||kE(s)||(r=Vt("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=Vt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function e3(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const o=ZE(s==null?void 0:s.accounts,`${t} namespace`);o&&(r=o)}),r}function t3(n,t){let r=null;return vf(n==null?void 0:n.methods)?vf(n==null?void 0:n.events)||(r=Vt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=Vt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function Vd(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const o=t3(s,`${t}, namespace`);o&&(r=o)}),r}function r3(n,t,r){let s=null;if(n&&ns(n)){const o=Vd(n,t);o&&(s=o);const l=QE(n,t);l&&(s=l)}else s=he("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function Ea(n,t){let r=null;if(n&&ns(n)){const s=Vd(n,t);s&&(r=s);const o=e3(n,t);o&&(r=o)}else r=he("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function kd(n){return kt(n.protocol,!0)}function i3(n,t){let r=!1;return t&&!n?r=!0:n&&fs(n)&&n.length&&n.forEach(s=>{r=kd(s)}),r}function n3(n){return typeof n=="number"}function gr(n){return typeof n<"u"&&typeof n!==null}function s3(n){return!(!n||typeof n!="object"||!n.code||!bu(n.code,!1)||!n.message||!kt(n.message,!1))}function a3(n){return!(ar(n)||!kt(n.method,!1))}function o3(n){return!(ar(n)||ar(n.result)&&ar(n.error)||!bu(n.id,!1)||!kt(n.jsonrpc,!1))}function c3(n){return!(ar(n)||!kt(n.name,!1))}function mf(n,t){return!(!wu(t)||!jE(n).includes(t))}function u3(n,t,r){return kt(r,!1)?qE(n,t).includes(r):!1}function h3(n,t,r){return kt(r,!1)?BE(n,t).includes(r):!1}function bf(n,t,r){let s=null;const o=l3(n),l=f3(t),m=Object.keys(o),f=Object.keys(l),w=wf(Object.keys(n)),O=wf(Object.keys(t)),I=w.filter(P=>!O.includes(P));return I.length&&(s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${I.toString()}
      Received: ${Object.keys(t).toString()}`)),Ji(m,f)||(s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${m.toString()}
      Approved: ${f.toString()}`)),Object.keys(t).forEach(P=>{if(!P.includes(":")||s)return;const $=xn(t[P].accounts);$.includes(P)||(s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${P}
        Required: ${P}
        Approved: ${$.toString()}`))}),m.forEach(P=>{s||(Ji(o[P].methods,l[P].methods)?Ji(o[P].events,l[P].events)||(s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${P}`)):s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${P}`))}),s}function l3(n){const t={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?t[r]=n[r]:(s=n[r].chains)==null||s.forEach(o=>{t[o]={methods:n[r].methods,events:n[r].events}})}),t}function wf(n){return[...new Set(n.map(t=>t.includes(":")?t.split(":")[0]:t))]}function f3(n){const t={};return Object.keys(n).forEach(r=>{if(r.includes(":"))t[r]=n[r];else{const s=xn(n[r].accounts);s==null||s.forEach(o=>{t[o]={accounts:n[r].accounts.filter(l=>l.includes(`${o}:`)),methods:n[r].methods,events:n[r].events}})}}),t}function d3(n,t){return bu(n,!1)&&n<=t.max&&n>=t.min}class Ci extends em{constructor(t){super(t),this.events=new $r.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Pa(t.method,t.params||[],t.id||iu().toString()),r)}async requestStrict(t,r){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(l){o(l)}this.events.on(`${t.id}`,l=>{Hr(l)?o(l.error):s(l.result)});try{await this.connection.send(t,r)}catch(l){o(l)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Na(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Ef=10,p3=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),g3=()=>typeof window<"u",y3=p3();class _3{constructor(t){if(this.url=t,this.events=new $r.EventEmitter,this.registering=!1,!Ol(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ss(t))}catch(s){this.onError(t.id,s)}}register(t=this.url){if(!Ol(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),o(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const o=Yv.isReactNative()?void 0:{rejectUnauthorized:!nm(t)},l=new y3(t,[],o);g3()?l.onerror=m=>{const f=m;s(this.emitError(f.error))}:l.on("error",m=>{s(this.emitError(m))}),l.onopen=()=>{this.onOpen(l),r(l)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?du(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),o=s.message||s.toString(),l=Ta(t,o);this.events.emit("payload",l)}parseError(t,r=this.url){return sd(t,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>Ef&&this.events.setMaxListeners(Ef)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Ca={exports:{}};Ca.exports;(function(n,t){var r=200,s="__lodash_hash_undefined__",o=1,l=2,m=9007199254740991,f="[object Arguments]",w="[object Array]",O="[object AsyncFunction]",I="[object Boolean]",P="[object Date]",$="[object Error]",R="[object Function]",N="[object GeneratorFunction]",z="[object Map]",L="[object Number]",Q="[object Null]",d="[object Object]",b="[object Promise]",y="[object Proxy]",v="[object RegExp]",p="[object Set]",c="[object String]",_="[object Symbol]",K="[object Undefined]",G="[object WeakMap]",se="[object ArrayBuffer]",ce="[object DataView]",de="[object Float32Array]",S="[object Float64Array]",C="[object Int8Array]",te="[object Int16Array]",X="[object Int32Array]",k="[object Uint8Array]",W="[object Uint8ClampedArray]",J="[object Uint16Array]",ie="[object Uint32Array]",be=/[\\^$.*+?()[\]{}|]/g,ae=/^\[object .+?Constructor\]$/,we=/^(?:0|[1-9]\d*)$/,le={};le[de]=le[S]=le[C]=le[te]=le[X]=le[k]=le[W]=le[J]=le[ie]=!0,le[f]=le[w]=le[se]=le[I]=le[ce]=le[P]=le[$]=le[R]=le[z]=le[L]=le[d]=le[v]=le[p]=le[c]=le[G]=!1;var _e=typeof xi=="object"&&xi&&xi.Object===Object&&xi,H=typeof self=="object"&&self&&self.Object===Object&&self,B=_e||H||Function("return this")(),F=t&&!t.nodeType&&t,h=F&&!0&&n&&!n.nodeType&&n,T=h&&h.exports===F,oe=T&&_e.process,fe=function(){try{return oe&&oe.binding&&oe.binding("util")}catch{}}(),Ie=fe&&fe.isTypedArray;function ze(x,M){for(var re=-1,pe=x==null?0:x.length,ot=0,Te=[];++re<pe;){var lt=x[re];M(lt,re,x)&&(Te[ot++]=lt)}return Te}function Ve(x,M){for(var re=-1,pe=M.length,ot=x.length;++re<pe;)x[ot+re]=M[re];return x}function Le(x,M){for(var re=-1,pe=x==null?0:x.length;++re<pe;)if(M(x[re],re,x))return!0;return!1}function dt(x,M){for(var re=-1,pe=Array(x);++re<x;)pe[re]=M(re);return pe}function pt(x){return function(M){return x(M)}}function je(x,M){return x.has(M)}function xe(x,M){return x==null?void 0:x[M]}function Ue(x){var M=-1,re=Array(x.size);return x.forEach(function(pe,ot){re[++M]=[ot,pe]}),re}function Re(x,M){return function(re){return x(M(re))}}function qe(x){var M=-1,re=Array(x.size);return x.forEach(function(pe){re[++M]=pe}),re}var Ae=Array.prototype,Fe=Function.prototype,Se=Object.prototype,Ce=B["__core-js_shared__"],He=Fe.toString,Oe=Se.hasOwnProperty,ke=function(){var x=/[^.]+$/.exec(Ce&&Ce.keys&&Ce.keys.IE_PROTO||"");return x?"Symbol(src)_1."+x:""}(),Ge=Se.toString,et=RegExp("^"+He.call(Oe).replace(be,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=T?B.Buffer:void 0,Je=B.Symbol,Zt=B.Uint8Array,ur=Se.propertyIsEnumerable,Vr=Ae.splice,er=Je?Je.toStringTag:void 0,ti=Object.getOwnPropertySymbols,pi=tt?tt.isBuffer:void 0,Ti=Re(Object.keys,Object),bt=_r(B,"DataView"),gt=_r(B,"Map"),wt=_r(B,"Promise"),Et=_r(B,"Set"),vt=_r(B,"WeakMap"),yt=_r(Object,"create"),Ut=ii(bt),Rt=ii(gt),Dt=ii(wt),Ft=ii(Et),St=ii(vt),At=Je?Je.prototype:void 0,It=At?At.valueOf:void 0;function ht(x){var M=-1,re=x==null?0:x.length;for(this.clear();++M<re;){var pe=x[M];this.set(pe[0],pe[1])}}function $t(){this.__data__=yt?yt(null):{},this.size=0}function Lt(x){var M=this.has(x)&&delete this.__data__[x];return this.size-=M?1:0,M}function za(x){var M=this.__data__;if(yt){var re=M[x];return re===s?void 0:re}return Oe.call(M,x)?M[x]:void 0}function Ha(x){var M=this.__data__;return yt?M[x]!==void 0:Oe.call(M,x)}function Ka(x,M){var re=this.__data__;return this.size+=this.has(x)?0:1,re[x]=yt&&M===void 0?s:M,this}ht.prototype.clear=$t,ht.prototype.delete=Lt,ht.prototype.get=za,ht.prototype.has=Ha,ht.prototype.set=Ka;function Sr(x){var M=-1,re=x==null?0:x.length;for(this.clear();++M<re;){var pe=x[M];this.set(pe[0],pe[1])}}function Va(){this.__data__=[],this.size=0}function ka(x){var M=this.__data__,re=Ni(M,x);if(re<0)return!1;var pe=M.length-1;return re==pe?M.pop():Vr.call(M,re,1),--this.size,!0}function Wa(x){var M=this.__data__,re=Ni(M,x);return re<0?void 0:M[re][1]}function Ga(x){return Ni(this.__data__,x)>-1}function Ya(x,M){var re=this.__data__,pe=Ni(re,x);return pe<0?(++this.size,re.push([x,M])):re[pe][1]=M,this}Sr.prototype.clear=Va,Sr.prototype.delete=ka,Sr.prototype.get=Wa,Sr.prototype.has=Ga,Sr.prototype.set=Ya;function ri(x){var M=-1,re=x==null?0:x.length;for(this.clear();++M<re;){var pe=x[M];this.set(pe[0],pe[1])}}function en(){this.size=0,this.__data__={hash:new ht,map:new(gt||Sr),string:new ht}}function Ja(x){var M=gi(this,x).delete(x);return this.size-=M?1:0,M}function tn(x){return gi(this,x).get(x)}function Xa(x){return gi(this,x).has(x)}function Qa(x,M){var re=gi(this,x),pe=re.size;return re.set(x,M),this.size+=re.size==pe?0:1,this}ri.prototype.clear=en,ri.prototype.delete=Ja,ri.prototype.get=tn,ri.prototype.has=Xa,ri.prototype.set=Qa;function rn(x){var M=-1,re=x==null?0:x.length;for(this.__data__=new ri;++M<re;)this.add(x[M])}function ps(x){return this.__data__.set(x,s),this}function gs(x){return this.__data__.has(x)}rn.prototype.add=rn.prototype.push=ps,rn.prototype.has=gs;function Lr(x){var M=this.__data__=new Sr(x);this.size=M.size}function Za(){this.__data__=new Sr,this.size=0}function eo(x){var M=this.__data__,re=M.delete(x);return this.size=M.size,re}function to(x){return this.__data__.get(x)}function ro(x){return this.__data__.has(x)}function ys(x,M){var re=this.__data__;if(re instanceof Sr){var pe=re.__data__;if(!gt||pe.length<r-1)return pe.push([x,M]),this.size=++re.size,this;re=this.__data__=new ri(pe)}return re.set(x,M),this.size=re.size,this}Lr.prototype.clear=Za,Lr.prototype.delete=eo,Lr.prototype.get=to,Lr.prototype.has=ro,Lr.prototype.set=ys;function _s(x,M){var re=an(x),pe=!re&&Cs(x),ot=!re&&!pe&&Cn(x),Te=!re&&!pe&&!ot&&Ns(x),lt=re||pe||ot||Te,Mt=lt?dt(x.length,String):[],Xe=Mt.length;for(var ct in x)(M||Oe.call(x,ct))&&!(lt&&(ct=="length"||ot&&(ct=="offset"||ct=="parent")||Te&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||Ss(ct,Xe)))&&Mt.push(ct);return Mt}function Ni(x,M){for(var re=x.length;re--;)if(As(x[re][0],M))return re;return-1}function On(x,M,re){var pe=M(x);return an(x)?pe:Ve(pe,re(x))}function Ui(x){return x==null?x===void 0?K:Q:er&&er in Object(x)?Es(x):so(x)}function An(x){return Fi(x)&&Ui(x)==f}function Ri(x,M,re,pe,ot){return x===M?!0:x==null||M==null||!Fi(x)&&!Fi(M)?x!==x&&M!==M:vs(x,M,re,pe,Ri,ot)}function vs(x,M,re,pe,ot,Te){var lt=an(x),Mt=an(M),Xe=lt?w:kr(x),ct=Mt?w:kr(M);Xe=Xe==f?d:Xe,ct=ct==f?d:ct;var Ct=Xe==d,hr=ct==d,jt=Xe==ct;if(jt&&Cn(x)){if(!Cn(M))return!1;lt=!0,Ct=!1}if(jt&&!Ct)return Te||(Te=new Lr),lt||Ns(x)?nn(x,M,re,pe,ot,Te):no(x,M,Xe,re,pe,ot,Te);if(!(re&o)){var ft=Ct&&Oe.call(x,"__wrapped__"),tr=hr&&Oe.call(M,"__wrapped__");if(ft||tr){var Mr=ft?x.value():x,Ir=tr?M.value():M;return Te||(Te=new Lr),ot(Mr,Ir,re,pe,Te)}}return jt?(Te||(Te=new Lr),ws(x,M,re,pe,ot,Te)):!1}function io(x){if(!Ts(x)||xs(x))return!1;var M=on(x)?et:ae;return M.test(ii(x))}function ms(x){return Fi(x)&&Ps(x.length)&&!!le[Ui(x)]}function bs(x){if(!Os(x))return Ti(x);var M=[];for(var re in Object(x))Oe.call(x,re)&&re!="constructor"&&M.push(re);return M}function nn(x,M,re,pe,ot,Te){var lt=re&o,Mt=x.length,Xe=M.length;if(Mt!=Xe&&!(lt&&Xe>Mt))return!1;var ct=Te.get(x);if(ct&&Te.get(M))return ct==M;var Ct=-1,hr=!0,jt=re&l?new rn:void 0;for(Te.set(x,M),Te.set(M,x);++Ct<Mt;){var ft=x[Ct],tr=M[Ct];if(pe)var Mr=lt?pe(tr,ft,Ct,M,x,Te):pe(ft,tr,Ct,x,M,Te);if(Mr!==void 0){if(Mr)continue;hr=!1;break}if(jt){if(!Le(M,function(Ir,Wr){if(!je(jt,Wr)&&(ft===Ir||ot(ft,Ir,re,pe,Te)))return jt.push(Wr)})){hr=!1;break}}else if(!(ft===tr||ot(ft,tr,re,pe,Te))){hr=!1;break}}return Te.delete(x),Te.delete(M),hr}function no(x,M,re,pe,ot,Te,lt){switch(re){case ce:if(x.byteLength!=M.byteLength||x.byteOffset!=M.byteOffset)return!1;x=x.buffer,M=M.buffer;case se:return!(x.byteLength!=M.byteLength||!Te(new Zt(x),new Zt(M)));case I:case P:case L:return As(+x,+M);case $:return x.name==M.name&&x.message==M.message;case v:case c:return x==M+"";case z:var Mt=Ue;case p:var Xe=pe&o;if(Mt||(Mt=qe),x.size!=M.size&&!Xe)return!1;var ct=lt.get(x);if(ct)return ct==M;pe|=l,lt.set(x,M);var Ct=nn(Mt(x),Mt(M),pe,ot,Te,lt);return lt.delete(x),Ct;case _:if(It)return It.call(x)==It.call(M)}return!1}function ws(x,M,re,pe,ot,Te){var lt=re&o,Mt=sn(x),Xe=Mt.length,ct=sn(M),Ct=ct.length;if(Xe!=Ct&&!lt)return!1;for(var hr=Xe;hr--;){var jt=Mt[hr];if(!(lt?jt in M:Oe.call(M,jt)))return!1}var ft=Te.get(x);if(ft&&Te.get(M))return ft==M;var tr=!0;Te.set(x,M),Te.set(M,x);for(var Mr=lt;++hr<Xe;){jt=Mt[hr];var Ir=x[jt],Wr=M[jt];if(pe)var Pn=lt?pe(Wr,Ir,jt,M,x,Te):pe(Ir,Wr,jt,x,M,Te);if(!(Pn===void 0?Ir===Wr||ot(Ir,Wr,re,pe,Te):Pn)){tr=!1;break}Mr||(Mr=jt=="constructor")}if(tr&&!Mr){var $i=x.constructor,Ht=M.constructor;$i!=Ht&&"constructor"in x&&"constructor"in M&&!(typeof $i=="function"&&$i instanceof $i&&typeof Ht=="function"&&Ht instanceof Ht)&&(tr=!1)}return Te.delete(x),Te.delete(M),tr}function sn(x){return On(x,co,Ds)}function gi(x,M){var re=x.__data__;return Is(M)?re[typeof M=="string"?"string":"hash"]:re.map}function _r(x,M){var re=xe(x,M);return io(re)?re:void 0}function Es(x){var M=Oe.call(x,er),re=x[er];try{x[er]=void 0;var pe=!0}catch{}var ot=Ge.call(x);return pe&&(M?x[er]=re:delete x[er]),ot}var Ds=ti?function(x){return x==null?[]:(x=Object(x),ze(ti(x),function(M){return ur.call(x,M)}))}:at,kr=Ui;(bt&&kr(new bt(new ArrayBuffer(1)))!=ce||gt&&kr(new gt)!=z||wt&&kr(wt.resolve())!=b||Et&&kr(new Et)!=p||vt&&kr(new vt)!=G)&&(kr=function(x){var M=Ui(x),re=M==d?x.constructor:void 0,pe=re?ii(re):"";if(pe)switch(pe){case Ut:return ce;case Rt:return z;case Dt:return b;case Ft:return p;case St:return G}return M});function Ss(x,M){return M=M??m,!!M&&(typeof x=="number"||we.test(x))&&x>-1&&x%1==0&&x<M}function Is(x){var M=typeof x;return M=="string"||M=="number"||M=="symbol"||M=="boolean"?x!=="__proto__":x===null}function xs(x){return!!ke&&ke in x}function Os(x){var M=x&&x.constructor,re=typeof M=="function"&&M.prototype||Se;return x===re}function so(x){return Ge.call(x)}function ii(x){if(x!=null){try{return He.call(x)}catch{}try{return x+""}catch{}}return""}function As(x,M){return x===M||x!==x&&M!==M}var Cs=An(function(){return arguments}())?An:function(x){return Fi(x)&&Oe.call(x,"callee")&&!ur.call(x,"callee")},an=Array.isArray;function ao(x){return x!=null&&Ps(x.length)&&!on(x)}var Cn=pi||st;function oo(x,M){return Ri(x,M)}function on(x){if(!Ts(x))return!1;var M=Ui(x);return M==R||M==N||M==O||M==y}function Ps(x){return typeof x=="number"&&x>-1&&x%1==0&&x<=m}function Ts(x){var M=typeof x;return x!=null&&(M=="object"||M=="function")}function Fi(x){return x!=null&&typeof x=="object"}var Ns=Ie?pt(Ie):ms;function co(x){return ao(x)?_s(x):bs(x)}function at(){return[]}function st(){return!1}n.exports=oo})(Ca,Ca.exports);var v3=Ca.exports;const m3=nd(v3);function b3(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var o=0;o<n.length;o++){var l=n.charAt(o),m=l.charCodeAt(0);if(r[m]!==255)throw new TypeError(l+" is ambiguous");r[m]=o}var f=n.length,w=n.charAt(0),O=Math.log(f)/Math.log(256),I=Math.log(256)/Math.log(f);function P(N){if(N instanceof Uint8Array||(ArrayBuffer.isView(N)?N=new Uint8Array(N.buffer,N.byteOffset,N.byteLength):Array.isArray(N)&&(N=Uint8Array.from(N))),!(N instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(N.length===0)return"";for(var z=0,L=0,Q=0,d=N.length;Q!==d&&N[Q]===0;)Q++,z++;for(var b=(d-Q)*I+1>>>0,y=new Uint8Array(b);Q!==d;){for(var v=N[Q],p=0,c=b-1;(v!==0||p<L)&&c!==-1;c--,p++)v+=256*y[c]>>>0,y[c]=v%f>>>0,v=v/f>>>0;if(v!==0)throw new Error("Non-zero carry");L=p,Q++}for(var _=b-L;_!==b&&y[_]===0;)_++;for(var K=w.repeat(z);_<b;++_)K+=n.charAt(y[_]);return K}function $(N){if(typeof N!="string")throw new TypeError("Expected String");if(N.length===0)return new Uint8Array;var z=0;if(N[z]!==" "){for(var L=0,Q=0;N[z]===w;)L++,z++;for(var d=(N.length-z)*O+1>>>0,b=new Uint8Array(d);N[z];){var y=r[N.charCodeAt(z)];if(y===255)return;for(var v=0,p=d-1;(y!==0||v<Q)&&p!==-1;p--,v++)y+=f*b[p]>>>0,b[p]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");Q=v,z++}if(N[z]!==" "){for(var c=d-Q;c!==d&&b[c]===0;)c++;for(var _=new Uint8Array(L+(d-c)),K=L;c!==d;)_[K++]=b[c++];return _}}}function R(N){var z=$(N);if(z)return z;throw new Error(`Non-${t} character`)}return{encode:P,decodeUnsafe:$,decode:R}}var w3=b3,E3=w3;const Wd=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},D3=n=>new TextEncoder().encode(n),S3=n=>new TextDecoder().decode(n);class I3{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class x3{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Gd(this,t)}}class O3{constructor(t){this.decoders=t}or(t){return Gd(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Gd=(n,t)=>new O3({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class A3{constructor(t,r,s,o){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=o,this.encoder=new I3(t,r,s),this.decoder=new x3(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const qa=({name:n,prefix:t,encode:r,decode:s})=>new A3(n,t,r,s),ds=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:o}=E3(r,t);return qa({prefix:n,name:t,encode:s,decode:l=>Wd(o(l))})},C3=(n,t,r,s)=>{const o={};for(let I=0;I<t.length;++I)o[t[I]]=I;let l=n.length;for(;n[l-1]==="=";)--l;const m=new Uint8Array(l*r/8|0);let f=0,w=0,O=0;for(let I=0;I<l;++I){const P=o[n[I]];if(P===void 0)throw new SyntaxError(`Non-${s} character`);w=w<<r|P,f+=r,f>=8&&(f-=8,m[O++]=255&w>>f)}if(f>=r||255&w<<8-f)throw new SyntaxError("Unexpected end of data");return m},P3=(n,t,r)=>{const s=t[t.length-1]==="=",o=(1<<r)-1;let l="",m=0,f=0;for(let w=0;w<n.length;++w)for(f=f<<8|n[w],m+=8;m>r;)m-=r,l+=t[o&f>>m];if(m&&(l+=t[o&f<<r-m]),s)for(;l.length*r&7;)l+="=";return l},Yt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>qa({prefix:t,name:n,encode(o){return P3(o,s,r)},decode(o){return C3(o,s,r,n)}}),T3=qa({prefix:"\0",name:"identity",encode:n=>S3(n),decode:n=>D3(n)});var N3=Object.freeze({__proto__:null,identity:T3});const U3=Yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var R3=Object.freeze({__proto__:null,base2:U3});const F3=Yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var $3=Object.freeze({__proto__:null,base8:F3});const L3=ds({prefix:"9",name:"base10",alphabet:"0123456789"});var M3=Object.freeze({__proto__:null,base10:L3});const j3=Yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),q3=Yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var B3=Object.freeze({__proto__:null,base16:j3,base16upper:q3});const z3=Yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),H3=Yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),K3=Yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),V3=Yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),k3=Yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),W3=Yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),G3=Yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Y3=Yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),J3=Yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var X3=Object.freeze({__proto__:null,base32:z3,base32upper:H3,base32pad:K3,base32padupper:V3,base32hex:k3,base32hexupper:W3,base32hexpad:G3,base32hexpadupper:Y3,base32z:J3});const Q3=ds({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Z3=ds({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var eD=Object.freeze({__proto__:null,base36:Q3,base36upper:Z3});const tD=ds({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),rD=ds({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var iD=Object.freeze({__proto__:null,base58btc:tD,base58flickr:rD});const nD=Yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),sD=Yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),aD=Yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),oD=Yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var cD=Object.freeze({__proto__:null,base64:nD,base64pad:sD,base64url:aD,base64urlpad:oD});const Yd=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),uD=Yd.reduce((n,t,r)=>(n[r]=t,n),[]),hD=Yd.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function lD(n){return n.reduce((t,r)=>(t+=uD[r],t),"")}function fD(n){const t=[];for(const r of n){const s=hD[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const dD=qa({prefix:"ðŸš€",name:"base256emoji",encode:lD,decode:fD});var pD=Object.freeze({__proto__:null,base256emoji:dD}),gD=Jd,Df=128,yD=127,_D=~yD,vD=Math.pow(2,31);function Jd(n,t,r){t=t||[],r=r||0;for(var s=r;n>=vD;)t[r++]=n&255|Df,n/=128;for(;n&_D;)t[r++]=n&255|Df,n>>>=7;return t[r]=n|0,Jd.bytes=r-s+1,t}var mD=Vc,bD=128,Sf=127;function Vc(n,s){var r=0,s=s||0,o=0,l=s,m,f=n.length;do{if(l>=f)throw Vc.bytes=0,new RangeError("Could not decode varint");m=n[l++],r+=o<28?(m&Sf)<<o:(m&Sf)*Math.pow(2,o),o+=7}while(m>=bD);return Vc.bytes=l-s,r}var wD=Math.pow(2,7),ED=Math.pow(2,14),DD=Math.pow(2,21),SD=Math.pow(2,28),ID=Math.pow(2,35),xD=Math.pow(2,42),OD=Math.pow(2,49),AD=Math.pow(2,56),CD=Math.pow(2,63),PD=function(n){return n<wD?1:n<ED?2:n<DD?3:n<SD?4:n<ID?5:n<xD?6:n<OD?7:n<AD?8:n<CD?9:10},TD={encode:gD,decode:mD,encodingLength:PD},Xd=TD;const If=(n,t,r=0)=>(Xd.encode(n,t,r),t),xf=n=>Xd.encodingLength(n),kc=(n,t)=>{const r=t.byteLength,s=xf(n),o=s+xf(r),l=new Uint8Array(o+r);return If(n,l,0),If(r,l,s),l.set(t,o),new ND(n,r,t,l)};class ND{constructor(t,r,s,o){this.code=t,this.size=r,this.digest=s,this.bytes=o}}const Qd=({name:n,code:t,encode:r})=>new UD(n,t,r);class UD{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?kc(this.code,r):r.then(s=>kc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Zd=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),RD=Qd({name:"sha2-256",code:18,encode:Zd("SHA-256")}),FD=Qd({name:"sha2-512",code:19,encode:Zd("SHA-512")});var $D=Object.freeze({__proto__:null,sha256:RD,sha512:FD});const ep=0,LD="identity",tp=Wd,MD=n=>kc(ep,tp(n)),jD={code:ep,name:LD,encode:tp,digest:MD};var qD=Object.freeze({__proto__:null,identity:jD});new TextEncoder,new TextDecoder;const Of={...N3,...R3,...$3,...M3,...B3,...X3,...eD,...iD,...cD,...pD};({...$D,...qD});function rp(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function BD(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?rp(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function ip(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const Af=ip("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Dc=ip("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=BD(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),zD={utf8:Af,"utf-8":Af,hex:Of.base16,latin1:Dc,ascii:Dc,binary:Dc,...Of};function HD(n,t="utf8"){const r=zD[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?rp(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const np="wc",KD=2,Eu="core",Oi=`${np}@2:${Eu}:`,VD={name:Eu,logger:"error"},kD={database:":memory:"},WD="crypto",Cf="client_ed25519_seed",GD=ve.ONE_DAY,YD="keychain",JD="0.3",XD="messages",QD="0.3",ZD=ve.SIX_HOURS,e6="publisher",sp="irn",t6="error",ap="wss://relay.walletconnect.com",r6="relayer",Ot={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},i6="_subscription",Zn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},n6=ve.ONE_SECOND/2,s6="2.8.0",a6=1e4,o6="0.3",c6="WALLETCONNECT_CLIENT_ID",Zr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},u6="subscription",h6="0.3",l6=ve.FIVE_SECONDS*1e3,f6="pairing",d6="0.3",es={wc_pairingDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:0},res:{ttl:ve.ONE_DAY,prompt:!1,tag:0}}},Qr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},p6="history",g6="0.3",y6="expirer",Rr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},_6="0.3",Sc="verify-api",Pf="https://verify.walletconnect.com";class v6{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=YD,this.version=JD,this.initialized=!1,this.storagePrefix=Oi,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:l}=he("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(l)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Bd(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?zd(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class m6{constructor(t,r,s){this.core=t,this.logger=r,this.name=WD,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),l=sf(o);return Ud(l.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=oE();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const l=await this.getClientSeed(),m=sf(l),f=Hc();return await Vw(f,o,GD,m)},this.generateSharedKey=(o,l,m)=>{this.isInitialized();const f=this.getPrivateKey(o),w=cE(f,l);return this.setSymKey(w,m)},this.setSymKey=async(o,l)=>{this.isInitialized();const m=l||uE(o);return await this.keychain.set(m,o),m},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,l,m)=>{this.isInitialized();const f=Md(m),w=ss(l);if(ff(f)){const $=f.senderPublicKey,R=f.receiverPublicKey;o=await this.generateSharedKey($,R)}const O=this.getSymKey(o),{type:I,senderPublicKey:P}=f;return lE({type:I,symKey:O,message:w,senderPublicKey:P})},this.decode=async(o,l,m)=>{this.isInitialized();const f=pE(l,m);if(ff(f)){const I=f.receiverPublicKey,P=f.senderPublicKey;o=await this.generateSharedKey(I,P)}const w=this.getSymKey(o),O=fE({symKey:w,encoded:l});return du(O)},this.getPayloadType=o=>{const l=Oa(o);return ls(l.type)},this.getPayloadSenderPublicKey=o=>{const l=Oa(o);return l.senderPublicKey?cr(l.senderPublicKey,or):void 0},this.core=t,this.logger=Ze.generateChildLogger(r,this.name),this.keychain=s||new v6(this.core,this.logger)}get context(){return Ze.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Cf)}catch{t=Hc(),await this.keychain.set(Cf,t)}return HD(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class b6 extends ww{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=XD,this.version=QD,this.initialized=!1,this.storagePrefix=Oi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const l=Sn(o);let m=this.messages.get(s);return typeof m>"u"&&(m={}),typeof m[l]<"u"||(m[l]=o,this.messages.set(s,m),await this.persist()),l},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const l=this.get(s),m=Sn(o);return typeof l[m]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Ze.generateChildLogger(t,this.name),this.core=r}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Bd(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?zd(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}let w6=class extends Ew{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new $r.EventEmitter,this.name=e6,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(s,o,l)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:l}});try{const m=(l==null?void 0:l.ttl)||ZD,f=Kc(l),w=(l==null?void 0:l.prompt)||!1,O=(l==null?void 0:l.tag)||0,I=(l==null?void 0:l.id)||iu().toString(),P={topic:s,message:o,opts:{ttl:m,relay:f,prompt:w,tag:O,id:I}};this.queue.set(I,P);try{await await Aa(this.rpcPublish(s,o,m,f,w,O,I),this.publishTimeout),this.relayer.events.emit(Ot.publish,P)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(Ot.connection_stalled);return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:l}})}catch(m){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(m),m}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=t,this.logger=Ze.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Ze.getLoggerContext(this.logger)}rpcPublish(t,r,s,o,l,m,f){var w,O,I,P;const $={method:wa(o.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:l,tag:m},id:f};return ar((w=$.params)==null?void 0:w.prompt)&&((O=$.params)==null||delete O.prompt),ar((I=$.params)==null?void 0:I.tag)&&((P=$.params)==null||delete P.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:$}),this.relayer.request($)}onPublish(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:o}=t;await this.publish(r,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(hs.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()}),this.relayer.on(Ot.message_ack,t=>{this.onPublish(t.id.toString())})}};class E6{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const o=s.filter(l=>l!==r);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var D6=Object.defineProperty,S6=Object.defineProperties,I6=Object.getOwnPropertyDescriptors,Tf=Object.getOwnPropertySymbols,x6=Object.prototype.hasOwnProperty,O6=Object.prototype.propertyIsEnumerable,Nf=(n,t,r)=>t in n?D6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,ts=(n,t)=>{for(var r in t||(t={}))x6.call(t,r)&&Nf(n,r,t[r]);if(Tf)for(var r of Tf(t))O6.call(t,r)&&Nf(n,r,t[r]);return n},Ic=(n,t)=>S6(n,I6(t));class A6 extends Iw{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new E6,this.events=new $r.EventEmitter,this.name=u6,this.version=h6,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Oi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const l=Kc(o),m={topic:s,relay:l};this.pending.set(s,m);const f=await this.rpcSubscribe(s,l);return this.onSubscribe(f,m),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),f}catch(l){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(l),l}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,l)=>{const m=new ve.Watch;m.start(this.pendingSubscriptionWatchLabel);const f=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(f),m.stop(this.pendingSubscriptionWatchLabel),o(!0)),m.elapsed(this.pendingSubscriptionWatchLabel)>=l6&&(clearInterval(f),m.stop(this.pendingSubscriptionWatchLabel),l(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Ze.generateChildLogger(r,this.name),this.clientId=""}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async o=>await this.unsubscribeById(t,o,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const o=Kc(s);await this.rpcUnsubscribe(t,r,o);const l=Vt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(t,r){const s={method:wa(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Aa(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ot.connection_stalled)}return Sn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:wa(r.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Aa(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ot.connection_stalled)}}rpcUnsubscribe(t,r,s){const o={method:wa(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,r){this.setSubscription(t,Ic(ts({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,ts({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,ts({},r)),this.topicMap.set(r.topic,t),this.events.emit(Zr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(Zr.deleted,Ic(ts({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Zr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Zr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);fs(r)&&this.onBatchSubscribe(r.map((s,o)=>Ic(ts({},t[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(hs.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Ot.connect,async()=>{await this.onConnect()}),this.relayer.on(Ot.disconnect,()=>{this.onDisconnect()}),this.events.on(Zr.created,async t=>{const r=Zr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(Zr.deleted,async t=>{const r=Zr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var C6=Object.defineProperty,Uf=Object.getOwnPropertySymbols,P6=Object.prototype.hasOwnProperty,T6=Object.prototype.propertyIsEnumerable,Rf=(n,t,r)=>t in n?C6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,N6=(n,t)=>{for(var r in t||(t={}))P6.call(t,r)&&Rf(n,r,t[r]);if(Uf)for(var r of Uf(t))T6.call(t,r)&&Rf(n,r,t[r]);return n};let U6=class extends Dw{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new $r.EventEmitter,this.name=r6,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Ze.generateChildLogger(t.logger,this.name):Ze.pino(Ze.getDefaultLoggerOptions({level:t.logger||t6})),this.messages=new b6(this.logger,t.core),this.subscriber=new A6(this,this.logger),this.publisher=new w6(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||ap,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribted to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},a6)}get context(){return Ze.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";return o||(await Promise.all([new Promise(l=>{this.subscriber.once(Zr.created,m=>{m.topic===t&&l()})}),new Promise(async l=>{o=await this.subscriber.subscribe(t,r),l()})]),o)}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Ot.transport_closed))}async transportOpen(t){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=t||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(Zr.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,s)=>{await Aa(this.provider.connect(),5e3,"socket stalled").catch(o=>s(o)).then(()=>r()).finally(()=>this.removeListener(Ot.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(Ot.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.events.emit(Ot.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(t){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=t||this.relayUrl,this.connected&&await Promise.all([new Promise(r=>{this.provider.once(Zn.disconnect,()=>{r()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ci(new _3(IE({sdkVersion:s6,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;return await this.subscriber.isSubscribed(r)?this.messages.has(r,s):!0}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),au(t)){if(!t.method.endsWith(i6))return;const r=t.params,{topic:s,message:o,publishedAt:l}=r.data,m={topic:s,message:o,publishedAt:l};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(N6({type:"event",event:r.id},m)),this.events.emit(r.id,m),await this.acknowledgePayload(t),await this.onMessageEvent(m)}else Na(t)&&this.events.emit(Ot.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Ot.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=nu(t.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(Zn.payload,t=>this.onProviderPayload(t)),this.provider.on(Zn.connect,()=>{this.events.emit(Ot.connect)}),this.provider.on(Zn.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(Zn.error,t=>{this.logger.error(t),this.events.emit(Ot.error,t)})}registerEventListeners(){this.events.on(Ot.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Ot.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},ve.toMiliseconds(n6))}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}};var R6=Object.defineProperty,Ff=Object.getOwnPropertySymbols,F6=Object.prototype.hasOwnProperty,$6=Object.prototype.propertyIsEnumerable,$f=(n,t,r)=>t in n?R6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Lf=(n,t)=>{for(var r in t||(t={}))F6.call(t,r)&&$f(n,r,t[r]);if(Ff)for(var r of Ff(t))$6.call(t,r)&&$f(n,r,t[r]);return n};class Ba extends Sw{constructor(t,r,s,o=Oi,l=void 0){super(t,r,s,o),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=o6,this.cached=[],this.initialized=!1,this.storagePrefix=Oi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(m=>{this.getKey&&m!==null&&!ar(m)?this.map.set(this.getKey(m),m):GE(m)?this.map.set(m.id,m):YE(m)&&this.map.set(m.topic,m)}),this.cached=[],this.initialized=!0)},this.set=async(m,f)=>{this.isInitialized(),this.map.has(m)?await this.update(m,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:m,value:f}),this.map.set(m,f),await this.persist())},this.get=m=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:m}),this.getData(m)),this.getAll=m=>(this.isInitialized(),m?this.values.filter(f=>Object.keys(m).every(w=>m3(f[w],m[w]))):this.values),this.update=async(m,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:m,update:f});const w=Lf(Lf({},this.getData(m)),f);this.map.set(m,w),await this.persist()},this.delete=async(m,f)=>{this.isInitialized(),this.map.has(m)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:m,reason:f}),this.map.delete(m),await this.persist())},this.logger=Ze.generateChildLogger(r,this.name),this.storagePrefix=o,this.getKey=l}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class L6{constructor(t,r){this.core=t,this.logger=r,this.name=f6,this.version=d6,this.events=new Zc,this.initialized=!1,this.storagePrefix=Oi,this.ignoredPayloadTypes=[Qi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Hc(),o=await this.core.crypto.setSymKey(s),l=ei(ve.FIVE_MINUTES),m={protocol:sp},f={topic:o,expiry:l,relay:m,active:!1},w=ME({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:m});return await this.pairings.set(o,f),await this.core.relayer.subscribe(o),this.core.expirer.set(o,l),{topic:o,uri:w}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:l,relay:m}=FE(s.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const f=ei(ve.FIVE_MINUTES),w={topic:o,relay:m,expiry:f,active:!1};return await this.pairings.set(o,w),await this.core.crypto.setSymKey(l,o),await this.core.relayer.subscribe(o,{relay:m}),this.core.expirer.set(o,f),s.activatePairing&&await this.activate({topic:o}),w},this.activate=async({topic:s})=>{this.isInitialized();const o=ei(ve.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const l=await this.sendRequest(o,"wc_pairingPing",{}),{done:m,resolve:f,reject:w}=Dn();this.events.once(qt("pairing_ping",l),({error:O})=>{O?w(O):f()}),await m()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Vt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,l)=>{const m=Pa(o,l),f=await this.core.crypto.encode(s,m),w=es[o].req;return this.core.history.set(s,m),this.core.relayer.publish(s,f,w),m.id},this.sendResult=async(s,o,l)=>{const m=nu(s,l),f=await this.core.crypto.encode(o,m),w=await this.core.history.get(o,s),O=es[w.request.method].res;await this.core.relayer.publish(o,f,O),await this.core.history.resolve(m)},this.sendError=async(s,o,l)=>{const m=Ta(s,l),f=await this.core.crypto.encode(o,m),w=await this.core.history.get(o,s),O=es[w.request.method]?es[w.request.method].res:es.unregistered_method.res;await this.core.relayer.publish(o,f,O),await this.core.history.resolve(m)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Vt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>Ii(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:l}=s,m=l.method;if(this.pairings.keys.includes(o))switch(m){case"wc_pairingPing":return this.onPairingPingRequest(o,l);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,l);default:return this.onUnknownRpcMethodRequest(o,l)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:l}=s,m=(await this.core.history.get(o,l.id)).request.method;if(this.pairings.keys.includes(o))switch(m){case"wc_pairingPing":return this.onPairingPingResponse(o,l);default:return this.onUnknownRpcMethodResponse(m)}},this.onPairingPingRequest=async(s,o)=>{const{id:l}=o;try{this.isValidPing({topic:s}),await this.sendResult(l,s,!0),this.events.emit("pairing_ping",{id:l,topic:s})}catch(m){await this.sendError(l,s,m),this.logger.error(m)}},this.onPairingPingResponse=(s,o)=>{const{id:l}=o;setTimeout(()=>{di(o)?this.events.emit(qt("pairing_ping",l),{}):Hr(o)&&this.events.emit(qt("pairing_ping",l),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:l}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:l,topic:s})}catch(m){await this.sendError(l,s,m),this.logger.error(m)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:l,method:m}=o;try{if(this.registeredMethods.includes(m))return;const f=Vt("WC_METHOD_UNSUPPORTED",m);await this.sendError(l,s,f),this.logger.error(f)}catch(f){await this.sendError(l,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Vt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!gr(s)){const{message:o}=he("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(o)}if(!WE(s.uri)){const{message:o}=he("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(o)}},this.isValidPing=async s=>{if(!gr(s)){const{message:l}=he("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(l)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!gr(s)){const{message:l}=he("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(l)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!kt(s,!1)){const{message:o}=he("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=he("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(Ii(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=he("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=t,this.logger=Ze.generateChildLogger(r,this.name),this.pairings=new Ba(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ze.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Ot.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(r,s);au(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Na(o)&&(await this.core.history.resolve(o),this.onRelayEventResponse({topic:r,payload:o}))})}registerExpirerEvents(){this.core.expirer.on(Rr.expired,async t=>{const{topic:r}=Kd(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class M6 extends bw{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new $r.EventEmitter,this.name=p6,this.version=g6,this.cached=[],this.initialized=!1,this.storagePrefix=Oi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,l)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:l}),this.records.has(o.id))return;const m={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:l};this.records.set(m.id,m),this.events.emit(Qr.created,m)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Hr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(Qr.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(l=>{if(l.topic===s){if(typeof o<"u"&&l.id!==o)return;this.records.delete(l.id),this.events.emit(Qr.deleted,l)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Pa(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Qr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Qr.created,t=>{const r=Qr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Qr.updated,t=>{const r=Qr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Qr.deleted,t=>{const r=Qr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class j6 extends xw{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new $r.EventEmitter,this.name=y6,this.version=_6,this.cached=[],this.initialized=!1,this.storagePrefix=Oi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const l=this.formatTarget(s),m={target:l,expiry:o};this.expirations.set(l,m),this.checkExpiry(l,m),this.events.emit(Rr.created,{target:l,expiration:m})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),l=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Rr.deleted,{target:o,expiration:l})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return xE(t);if(typeof t=="number")return OE(t);const{message:r}=he("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Rr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;ve.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Rr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(hs.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Rr.created,t=>{const r=Rr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Rr.expired,t=>{const r=Rr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Rr.deleted,t=>{const r=Rr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class q6 extends Ow{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=Sc,this.initialized=!1,this.init=async s=>{jd()||!mu()||(this.verifyUrl=(s==null?void 0:s.verifyUrl)||Pf,await this.createIframe())},this.register=async s=>{var o;this.initialized||await this.init(),this.iframe&&((o=this.iframe.contentWindow)==null||o.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`))},this.resolve=async s=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const l=this.startAbortTimer(ve.FIVE_SECONDS),m=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(l),m.status===200?(o=await m.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((s,o)=>{if(document.getElementById(Sc))return s();const l=document.createElement("iframe");l.setAttribute("id",Sc),l.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),l.style.display="none",l.addEventListener("load",()=>{this.initialized=!0,s()}),l.addEventListener("error",m=>{o(m)}),document.body.append(l),this.iframe=l}),new Promise(s=>{setTimeout(()=>s("iframe load timeout"),ve.toMiliseconds(ve.ONE_SECOND/2))})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=Ze.generateChildLogger(r,this.name),this.verifyUrl=Pf,this.abortController=new AbortController,this.isDevEnv=vu()&&{}.IS_VITEST}get context(){return Ze.getLoggerContext(this.logger)}startAbortTimer(t){return setTimeout(()=>this.abortController.abort(),ve.toMiliseconds(t))}}var B6=Object.defineProperty,Mf=Object.getOwnPropertySymbols,z6=Object.prototype.hasOwnProperty,H6=Object.prototype.propertyIsEnumerable,jf=(n,t,r)=>t in n?B6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,qf=(n,t)=>{for(var r in t||(t={}))z6.call(t,r)&&jf(n,r,t[r]);if(Mf)for(var r of Mf(t))H6.call(t,r)&&jf(n,r,t[r]);return n};let K6=class op extends mw{constructor(t){super(t),this.protocol=np,this.version=KD,this.name=Eu,this.events=new $r.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||ap;const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||VD.logger}));this.logger=Ze.generateChildLogger(r,this.name),this.heartbeat=new hs.HeartBeat,this.crypto=new m6(this,this.logger,t==null?void 0:t.keychain),this.history=new M6(this,this.logger),this.expirer=new j6(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new hw(qf(qf({},kD),t==null?void 0:t.storageOptions)),this.relayer=new U6({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new L6(this,this.logger),this.verify=new q6(this.projectId||"",this.logger)}static async init(t){const r=new op(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(c6,s),r}get context(){return Ze.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}};const V6=K6,cp="wc",up=2,hp="client",Du=`${cp}@${up}:${hp}:`,xc={name:hp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},k6="WALLETCONNECT_DEEPLINK_CHOICE",W6="proposal",lp="Proposal expired",G6="session",va=ve.SEVEN_DAYS,Y6="engine",rs={wc_sessionPropose:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1115}}},Oc={min:ve.FIVE_MINUTES,max:ve.SEVEN_DAYS},J6="request",X6=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Q6=Object.defineProperty,Z6=Object.defineProperties,e2=Object.getOwnPropertyDescriptors,Bf=Object.getOwnPropertySymbols,t2=Object.prototype.hasOwnProperty,r2=Object.prototype.propertyIsEnumerable,zf=(n,t,r)=>t in n?Q6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Ur=(n,t)=>{for(var r in t||(t={}))t2.call(t,r)&&zf(n,r,t[r]);if(Bf)for(var r of Bf(t))r2.call(t,r)&&zf(n,r,t[r]);return n},Ac=(n,t)=>Z6(n,e2(t));class i2 extends Cw{constructor(t){super(t),this.name=Y6,this.events=new Zc,this.initialized=!1,this.ignoredPayloadTypes=[Qi],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(rs)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const s=Ac(Ur({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:l,optionalNamespaces:m,sessionProperties:f,relays:w}=s;let O=o,I,P=!1;if(O&&(P=this.client.core.pairing.pairings.get(O).active),!O||!P){const{topic:b,uri:y}=await this.client.core.pairing.create();O=b,I=y}const $=await this.client.core.crypto.generateKeyPair(),R=Ur({requiredNamespaces:l,optionalNamespaces:m,relays:w??[{protocol:sp}],proposer:{publicKey:$,metadata:this.client.metadata}},f&&{sessionProperties:f}),{reject:N,resolve:z,done:L}=Dn(ve.FIVE_MINUTES,lp);if(this.events.once(qt("session_connect"),async({error:b,session:y})=>{if(b)N(b);else if(y){y.self.publicKey=$;const v=Ac(Ur({},y),{requiredNamespaces:y.requiredNamespaces,optionalNamespaces:y.optionalNamespaces});await this.client.session.set(y.topic,v),await this.setExpiry(y.topic,y.expiry),O&&await this.client.core.pairing.updateMetadata({topic:O,metadata:y.peer.metadata}),z(v)}}),!O){const{message:b}=he("NO_MATCHING_KEY",`connect() pairing topic: ${O}`);throw new Error(b)}const Q=await this.sendRequest(O,"wc_sessionPropose",R),d=ei(ve.FIVE_MINUTES);return await this.setProposal(Q,Ur({id:Q,expiry:d},R)),{uri:I,approval:L}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:o,namespaces:l,sessionProperties:m}=r,f=this.client.proposal.get(s);let{pairingTopic:w,proposer:O,requiredNamespaces:I,optionalNamespaces:P}=f;w=w||"",ns(I)||(I=zE(l,"approve()"));const $=await this.client.core.crypto.generateKeyPair(),R=O.publicKey,N=await this.client.core.crypto.generateSharedKey($,R);w&&s&&(await this.client.core.pairing.updateMetadata({topic:w,metadata:O.metadata}),await this.sendResult(s,w,{relay:{protocol:o??"irn"},responderPublicKey:$}),await this.client.proposal.delete(s,Vt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:w}));const z=Ur({relay:{protocol:o??"irn"},namespaces:l,requiredNamespaces:I,optionalNamespaces:P,pairingTopic:w,controller:{publicKey:$,metadata:this.client.metadata},expiry:ei(va)},m&&{sessionProperties:m});await this.client.core.relayer.subscribe(N),await this.sendRequest(N,"wc_sessionSettle",z);const L=Ac(Ur({},z),{topic:N,pairingTopic:w,acknowledged:!1,self:z.controller,peer:{publicKey:O.publicKey,metadata:O.metadata},controller:$});return await this.client.session.set(N,L),await this.setExpiry(N,ei(va)),{topic:N,acknowledged:()=>new Promise(Q=>setTimeout(()=>Q(this.client.session.get(N)),500))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:s,reason:o}=r,{pairingTopic:l}=this.client.proposal.get(s);l&&(await this.sendError(s,l,o),await this.client.proposal.delete(s,Vt("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:o}=r,l=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:o}),{done:m,resolve:f,reject:w}=Dn();return this.events.once(qt("session_update",l),({error:O})=>{O?w(O):f()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:m}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,o=await this.sendRequest(s,"wc_sessionExtend",{}),{done:l,resolve:m,reject:f}=Dn();return this.events.once(qt("session_extend",o),({error:w})=>{w?f(w):m()}),await this.setExpiry(s,ei(va)),{acknowledged:l}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:o,topic:l,expiry:m}=r,f=await this.sendRequest(l,"wc_sessionRequest",{request:o,chainId:s},m),{done:w,resolve:O,reject:I}=Dn(m);this.events.once(qt("session_request",f),({error:$,result:R})=>{$?I($):O(R)}),this.client.events.emit("session_request_sent",{topic:l,request:o,chainId:s,id:f});const P=await this.client.core.storage.getItem(k6);return AE({id:f,topic:l,wcDeepLink:P}),await w()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:o}=r,{id:l}=o;di(o)?await this.sendResult(l,s,o.result):Hr(o)&&await this.sendError(l,s,o.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const o=await this.sendRequest(s,"wc_sessionPing",{}),{done:l,resolve:m,reject:f}=Dn();this.events.once(qt("session_ping",o),({error:w})=>{w?f(w):m()}),await l()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:o,chainId:l}=r;await this.sendRequest(s,"wc_sessionEvent",{event:o,chainId:l})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const o=iu().toString();let l;const m=f=>{(f==null?void 0:f.id.toString())===o&&(this.client.core.relayer.events.removeListener(Ot.message_ack,m),l())};await Promise.all([new Promise(f=>{l=f,this.client.core.relayer.on(Ot.message_ack,m)}),this.sendRequest(s,"wc_sessionDelete",Vt("USER_DISCONNECTED"),void 0,o)]),await this.deleteSession(s)}else await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>VE(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(l=>{var m,f;return((m=l.peerMetadata)==null?void 0:m.url)&&((f=l.peerMetadata)==null?void 0:f.url)===r.peer.metadata.url&&l.topic&&l.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(l=>this.client.core.pairing.disconnect({topic:l.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Vt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r)},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,Vt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),o?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=rs.wc_sessionRequest.req.ttl,{id:o,topic:l,params:m}=r;await this.client.pendingRequest.set(o,{id:o,topic:l,params:m}),s&&this.client.core.expirer.set(o,ei(s))},this.sendRequest=async(r,s,o,l,m)=>{const f=Pa(s,o);if(mu()&&X6.includes(s)){const I=Sn(JSON.stringify(f));await this.client.core.verify.register({attestationId:I})}const w=await this.client.core.crypto.encode(r,f),O=rs[s].req;return l&&(O.ttl=l),m&&(O.id=m),this.client.core.history.set(r,f),this.client.core.relayer.publish(r,w,O),f.id},this.sendResult=async(r,s,o)=>{const l=nu(r,o),m=await this.client.core.crypto.encode(s,l),f=await this.client.core.history.get(s,r),w=rs[f.request.method].res;this.client.core.relayer.publish(s,m,w),await this.client.core.history.resolve(l)},this.sendError=async(r,s,o)=>{const l=Ta(r,o),m=await this.client.core.crypto.encode(s,l),f=await this.client.core.history.get(s,r),w=rs[f.request.method].res;this.client.core.relayer.publish(s,m,w),await this.client.core.history.resolve(l)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(o=>{Ii(o.expiry)&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Ii(o.expiry)&&s.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=r=>{const{topic:s,payload:o}=r,l=o.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:o}=r,l=(await this.client.core.history.get(s,o.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:o}=he("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(r,s)=>{const{params:o,id:l}=s;try{this.isValidConnect(Ur({},s.params));const m=ei(ve.FIVE_MINUTES),f=Ur({id:l,pairingTopic:r,expiry:m},o);await this.setProposal(l,f);const w=Sn(JSON.stringify(s)),O=await this.getVerifyContext(w,f.proposer.metadata);this.client.events.emit("session_proposal",{id:l,params:f,verifyContext:O})}catch(m){await this.sendError(l,r,m),this.client.logger.error(m)}},this.onSessionProposeResponse=async(r,s)=>{const{id:o}=s;if(di(s)){const{result:l}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});const m=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:m});const f=m.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const w=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:w});const O=await this.client.core.crypto.generateSharedKey(f,w);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:O});const I=await this.client.core.relayer.subscribe(O);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:I}),await this.client.core.pairing.activate({topic:r})}else Hr(s)&&(await this.client.proposal.delete(o,Vt("USER_DISCONNECTED")),this.events.emit(qt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:o,params:l}=s;try{this.isValidSessionSettleRequest(l);const{relay:m,controller:f,expiry:w,namespaces:O,requiredNamespaces:I,optionalNamespaces:P,sessionProperties:$,pairingTopic:R}=s.params,N=Ur({topic:r,relay:m,expiry:w,namespaces:O,acknowledged:!0,pairingTopic:R,requiredNamespaces:I,optionalNamespaces:P,controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},$&&{sessionProperties:$});await this.sendResult(s.id,r,!0),this.events.emit(qt("session_connect"),{session:N}),this.cleanupDuplicatePairings(N)}catch(m){await this.sendError(o,r,m),this.client.logger.error(m)}},this.onSessionSettleResponse=async(r,s)=>{const{id:o}=s;di(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(qt("session_approve",o),{})):Hr(s)&&(await this.client.session.delete(r,Vt("USER_DISCONNECTED")),this.events.emit(qt("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:o,id:l}=s;try{this.isValidUpdate(Ur({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult(l,r,!0),this.client.events.emit("session_update",{id:l,topic:r,params:o})}catch(m){await this.sendError(l,r,m),this.client.logger.error(m)}},this.onSessionUpdateResponse=(r,s)=>{const{id:o}=s;di(s)?this.events.emit(qt("session_update",o),{}):Hr(s)&&this.events.emit(qt("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:o}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,ei(va)),await this.sendResult(o,r,!0),this.client.events.emit("session_extend",{id:o,topic:r})}catch(l){await this.sendError(o,r,l),this.client.logger.error(l)}},this.onSessionExtendResponse=(r,s)=>{const{id:o}=s;di(s)?this.events.emit(qt("session_extend",o),{}):Hr(s)&&this.events.emit(qt("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:o}=s;try{this.isValidPing({topic:r}),await this.sendResult(o,r,!0),this.client.events.emit("session_ping",{id:o,topic:r})}catch(l){await this.sendError(o,r,l),this.client.logger.error(l)}},this.onSessionPingResponse=(r,s)=>{const{id:o}=s;setTimeout(()=>{di(s)?this.events.emit(qt("session_ping",o),{}):Hr(s)&&this.events.emit(qt("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(l=>{this.client.core.relayer.once(Ot.publish,async()=>{l(await this.deleteSession(r))})}),this.sendResult(o,r,!0)]),this.client.events.emit("session_delete",{id:o,topic:r})}catch(l){this.client.logger.error(l)}},this.onSessionRequest=async(r,s)=>{const{id:o,params:l}=s;try{this.isValidRequest(Ur({topic:r},l)),await this.setPendingSessionRequest({id:o,topic:r,params:l});const m=Sn(JSON.stringify(s)),f=this.client.session.get(r),w=await this.getVerifyContext(m,f.peer.metadata);this.client.events.emit("session_request",{id:o,topic:r,params:l,verifyContext:w})}catch(m){await this.sendError(o,r,m),this.client.logger.error(m)}},this.onSessionRequestResponse=(r,s)=>{const{id:o}=s;di(s)?this.events.emit(qt("session_request",o),{result:s.result}):Hr(s)&&this.events.emit(qt("session_request",o),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:o,params:l}=s;try{this.isValidEmit(Ur({topic:r},l)),this.client.events.emit("session_event",{id:o,topic:r,params:l})}catch(m){await this.sendError(o,r,m),this.client.logger.error(m)}},this.isValidConnect=async r=>{if(!gr(r)){const{message:w}=he("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(w)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:l,sessionProperties:m,relays:f}=r;if(ar(s)||await this.isValidPairingTopic(s),!i3(f,!0)){const{message:w}=he("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(w)}!ar(o)&&ns(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!ar(l)&&ns(l)!==0&&this.validateNamespaces(l,"optionalNamespaces"),ar(m)||this.validateSessionProps(m,"sessionProperties")},this.validateNamespaces=(r,s)=>{const o=r3(r,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!gr(r))throw new Error(he("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:o,relayProtocol:l,sessionProperties:m}=r;await this.isValidProposalId(s);const f=this.client.proposal.get(s),w=Ea(o,"approve()");if(w)throw new Error(w.message);const O=bf(f.requiredNamespaces,o,"approve()");if(O)throw new Error(O.message);if(!kt(l,!0)){const{message:I}=he("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw new Error(I)}ar(m)||this.validateSessionProps(m,"sessionProperties")},this.isValidReject=async r=>{if(!gr(r)){const{message:l}=he("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(l)}const{id:s,reason:o}=r;if(await this.isValidProposalId(s),!s3(o)){const{message:l}=he("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(l)}},this.isValidSessionSettleRequest=r=>{if(!gr(r)){const{message:O}=he("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(O)}const{relay:s,controller:o,namespaces:l,expiry:m}=r;if(!kd(s)){const{message:O}=he("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(O)}const f=JE(o,"onSessionSettleRequest()");if(f)throw new Error(f.message);const w=Ea(l,"onSessionSettleRequest()");if(w)throw new Error(w.message);if(Ii(m)){const{message:O}=he("EXPIRED","onSessionSettleRequest()");throw new Error(O)}},this.isValidUpdate=async r=>{if(!gr(r)){const{message:w}=he("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(w)}const{topic:s,namespaces:o}=r;await this.isValidSessionTopic(s);const l=this.client.session.get(s),m=Ea(o,"update()");if(m)throw new Error(m.message);const f=bf(l.requiredNamespaces,o,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async r=>{if(!gr(r)){const{message:o}=he("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!gr(r)){const{message:w}=he("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(w)}const{topic:s,request:o,chainId:l,expiry:m}=r;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!mf(f,l)){const{message:w}=he("MISSING_OR_INVALID",`request() chainId: ${l}`);throw new Error(w)}if(!a3(o)){const{message:w}=he("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(w)}if(!u3(f,l,o.method)){const{message:w}=he("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(w)}if(m&&!d3(m,Oc)){const{message:w}=he("MISSING_OR_INVALID",`request() expiry: ${m}. Expiry must be a number (in seconds) between ${Oc.min} and ${Oc.max}`);throw new Error(w)}},this.isValidRespond=async r=>{if(!gr(r)){const{message:l}=he("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}const{topic:s,response:o}=r;if(await this.isValidSessionTopic(s),!o3(o)){const{message:l}=he("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(l)}},this.isValidPing=async r=>{if(!gr(r)){const{message:o}=he("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!gr(r)){const{message:f}=he("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(f)}const{topic:s,event:o,chainId:l}=r;await this.isValidSessionTopic(s);const{namespaces:m}=this.client.session.get(s);if(!mf(m,l)){const{message:f}=he("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw new Error(f)}if(!c3(o)){const{message:f}=he("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}if(!h3(m,l,o.name)){const{message:f}=he("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}},this.isValidDisconnect=async r=>{if(!gr(r)){const{message:o}=he("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const o={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const l=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});l&&(o.verified.origin=l,o.verified.validation=l===s.url?"VALID":"INVALID")}catch(l){this.client.logger.error(l)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(o=>{if(!kt(o,!1)){const{message:l}=he("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(l)}})}}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.client.core.relayer.on(Ot.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(r,s);au(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Na(o)?(await this.client.core.history.resolve(o),this.onRelayEventResponse({topic:r,payload:o})):this.onRelayEventUnknownPayload({topic:r,payload:o})})}registerExpirerEvents(){this.client.core.expirer.on(Rr.expired,async t=>{const{topic:r,id:s}=Kd(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,he("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(t){if(!kt(t,!1)){const{message:r}=he("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=he("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Ii(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=he("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!kt(t,!1)){const{message:r}=he("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=he("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Ii(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=he("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(kt(t,!1)){const{message:r}=he("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=he("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!n3(t)){const{message:r}=he("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=he("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Ii(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=he("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class n2 extends Ba{constructor(t,r){super(t,r,W6,Du),this.core=t,this.logger=r}}class s2 extends Ba{constructor(t,r){super(t,r,G6,Du),this.core=t,this.logger=r}}class a2 extends Ba{constructor(t,r){super(t,r,J6,Du,s=>s.id),this.core=t,this.logger=r}}let o2=class fp extends Aw{constructor(t){super(t),this.protocol=cp,this.version=up,this.name=xc.name,this.events=new $r.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||xc.name,this.metadata=(t==null?void 0:t.metadata)||wE();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||xc.logger}));this.core=(t==null?void 0:t.core)||new V6(t),this.logger=Ze.generateChildLogger(r,this.name),this.session=new s2(this.core,this.logger),this.proposal=new n2(this.core,this.logger),this.pendingRequest=new a2(this.core,this.logger),this.engine=new i2(this)}static async init(t){const r=new fp(t);return await r.initialize(),r}get context(){return Ze.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var Su={};Object.defineProperty(Su,"__esModule",{value:!0});Su.getWindowMetadata=void 0;const Hf=su;function c2(){let n,t;try{n=Hf.getDocumentOrThrow(),t=Hf.getLocationOrThrow()}catch{return null}function r(){const P=n.getElementsByTagName("link"),$=[];for(let R=0;R<P.length;R++){const N=P[R],z=N.getAttribute("rel");if(z&&z.toLowerCase().indexOf("icon")>-1){const L=N.getAttribute("href");if(L)if(L.toLowerCase().indexOf("https:")===-1&&L.toLowerCase().indexOf("http:")===-1&&L.indexOf("//")!==0){let Q=t.protocol+"//"+t.host;if(L.indexOf("/")===0)Q+=L;else{const d=t.pathname.split("/");d.pop();const b=d.join("/");Q+=b+"/"+L}$.push(Q)}else if(L.indexOf("//")===0){const Q=t.protocol+L;$.push(Q)}else $.push(L)}}return $}function s(...P){const $=n.getElementsByTagName("meta");for(let R=0;R<$.length;R++){const N=$[R],z=["itemprop","property","name"].map(L=>N.getAttribute(L)).filter(L=>L?P.includes(L):!1);if(z.length&&z){const L=N.getAttribute("content");if(L)return L}}return""}function o(){let P=s("name","og:site_name","og:title","twitter:title");return P||(P=n.title),P}function l(){return s("description","og:description","twitter:description","keywords")}const m=o(),f=l(),w=t.origin,O=r();return{description:f,url:w,icons:O,name:m}}Su.getWindowMetadata=c2;var u2={};(function(n){const t=tu,r=ru,s=eu,o=fu,l=d=>d==null,m=Symbol("encodeFragmentIdentifier");function f(d){switch(d.arrayFormat){case"index":return b=>(y,v)=>{const p=y.length;return v===void 0||d.skipNull&&v===null||d.skipEmptyString&&v===""?y:v===null?[...y,[I(b,d),"[",p,"]"].join("")]:[...y,[I(b,d),"[",I(p,d),"]=",I(v,d)].join("")]};case"bracket":return b=>(y,v)=>v===void 0||d.skipNull&&v===null||d.skipEmptyString&&v===""?y:v===null?[...y,[I(b,d),"[]"].join("")]:[...y,[I(b,d),"[]=",I(v,d)].join("")];case"colon-list-separator":return b=>(y,v)=>v===void 0||d.skipNull&&v===null||d.skipEmptyString&&v===""?y:v===null?[...y,[I(b,d),":list="].join("")]:[...y,[I(b,d),":list=",I(v,d)].join("")];case"comma":case"separator":case"bracket-separator":{const b=d.arrayFormat==="bracket-separator"?"[]=":"=";return y=>(v,p)=>p===void 0||d.skipNull&&p===null||d.skipEmptyString&&p===""?v:(p=p===null?"":p,v.length===0?[[I(y,d),b,I(p,d)].join("")]:[[v,I(p,d)].join(d.arrayFormatSeparator)])}default:return b=>(y,v)=>v===void 0||d.skipNull&&v===null||d.skipEmptyString&&v===""?y:v===null?[...y,I(b,d)]:[...y,[I(b,d),"=",I(v,d)].join("")]}}function w(d){let b;switch(d.arrayFormat){case"index":return(y,v,p)=>{if(b=/\[(\d*)\]$/.exec(y),y=y.replace(/\[\d*\]$/,""),!b){p[y]=v;return}p[y]===void 0&&(p[y]={}),p[y][b[1]]=v};case"bracket":return(y,v,p)=>{if(b=/(\[\])$/.exec(y),y=y.replace(/\[\]$/,""),!b){p[y]=v;return}if(p[y]===void 0){p[y]=[v];return}p[y]=[].concat(p[y],v)};case"colon-list-separator":return(y,v,p)=>{if(b=/(:list)$/.exec(y),y=y.replace(/:list$/,""),!b){p[y]=v;return}if(p[y]===void 0){p[y]=[v];return}p[y]=[].concat(p[y],v)};case"comma":case"separator":return(y,v,p)=>{const c=typeof v=="string"&&v.includes(d.arrayFormatSeparator),_=typeof v=="string"&&!c&&P(v,d).includes(d.arrayFormatSeparator);v=_?P(v,d):v;const K=c||_?v.split(d.arrayFormatSeparator).map(G=>P(G,d)):v===null?v:P(v,d);p[y]=K};case"bracket-separator":return(y,v,p)=>{const c=/(\[\])$/.test(y);if(y=y.replace(/\[\]$/,""),!c){p[y]=v&&P(v,d);return}const _=v===null?[]:v.split(d.arrayFormatSeparator).map(K=>P(K,d));if(p[y]===void 0){p[y]=_;return}p[y]=[].concat(p[y],_)};default:return(y,v,p)=>{if(p[y]===void 0){p[y]=v;return}p[y]=[].concat(p[y],v)}}}function O(d){if(typeof d!="string"||d.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function I(d,b){return b.encode?b.strict?t(d):encodeURIComponent(d):d}function P(d,b){return b.decode?r(d):d}function $(d){return Array.isArray(d)?d.sort():typeof d=="object"?$(Object.keys(d)).sort((b,y)=>Number(b)-Number(y)).map(b=>d[b]):d}function R(d){const b=d.indexOf("#");return b!==-1&&(d=d.slice(0,b)),d}function N(d){let b="";const y=d.indexOf("#");return y!==-1&&(b=d.slice(y)),b}function z(d){d=R(d);const b=d.indexOf("?");return b===-1?"":d.slice(b+1)}function L(d,b){return b.parseNumbers&&!Number.isNaN(Number(d))&&typeof d=="string"&&d.trim()!==""?d=Number(d):b.parseBooleans&&d!==null&&(d.toLowerCase()==="true"||d.toLowerCase()==="false")&&(d=d.toLowerCase()==="true"),d}function Q(d,b){b=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},b),O(b.arrayFormatSeparator);const y=w(b),v=Object.create(null);if(typeof d!="string"||(d=d.trim().replace(/^[?#&]/,""),!d))return v;for(const p of d.split("&")){if(p==="")continue;let[c,_]=s(b.decode?p.replace(/\+/g," "):p,"=");_=_===void 0?null:["comma","separator","bracket-separator"].includes(b.arrayFormat)?_:P(_,b),y(P(c,b),_,v)}for(const p of Object.keys(v)){const c=v[p];if(typeof c=="object"&&c!==null)for(const _ of Object.keys(c))c[_]=L(c[_],b);else v[p]=L(c,b)}return b.sort===!1?v:(b.sort===!0?Object.keys(v).sort():Object.keys(v).sort(b.sort)).reduce((p,c)=>{const _=v[c];return _&&typeof _=="object"&&!Array.isArray(_)?p[c]=$(_):p[c]=_,p},Object.create(null))}n.extract=z,n.parse=Q,n.stringify=(d,b)=>{if(!d)return"";b=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},b),O(b.arrayFormatSeparator);const y=_=>b.skipNull&&l(d[_])||b.skipEmptyString&&d[_]==="",v=f(b),p={};for(const _ of Object.keys(d))y(_)||(p[_]=d[_]);const c=Object.keys(p);return b.sort!==!1&&c.sort(b.sort),c.map(_=>{const K=d[_];return K===void 0?"":K===null?I(_,b):Array.isArray(K)?K.length===0&&b.arrayFormat==="bracket-separator"?I(_,b)+"[]":K.reduce(v(_),[]).join("&"):I(_,b)+"="+I(K,b)}).filter(_=>_.length>0).join("&")},n.parseUrl=(d,b)=>{b=Object.assign({decode:!0},b);const[y,v]=s(d,"#");return Object.assign({url:y.split("?")[0]||"",query:Q(z(d),b)},b&&b.parseFragmentIdentifier&&v?{fragmentIdentifier:P(v,b)}:{})},n.stringifyUrl=(d,b)=>{b=Object.assign({encode:!0,strict:!0,[m]:!0},b);const y=R(d.url).split("?")[0]||"",v=n.extract(d.url),p=n.parse(v,{sort:!1}),c=Object.assign(p,d.query);let _=n.stringify(c,b);_&&(_=`?${_}`);let K=N(d.url);return d.fragmentIdentifier&&(K=`#${b[m]?I(d.fragmentIdentifier,b):d.fragmentIdentifier}`),`${y}${_}${K}`},n.pick=(d,b,y)=>{y=Object.assign({parseFragmentIdentifier:!0,[m]:!1},y);const{url:v,query:p,fragmentIdentifier:c}=n.parseUrl(d,y);return n.stringifyUrl({url:v,query:o(p,b),fragmentIdentifier:c},y)},n.exclude=(d,b,y)=>{const v=Array.isArray(b)?p=>!b.includes(p):(p,c)=>!b(p,c);return n.pick(d,v,y)}})(u2);function Cc(n=[],t=[]){return[...new Set([...n,...t])]}function dp(n){return n.includes(":")}function Da(n){return dp(n)?n.split(":")[0]:n}const h2={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function Kf(n,t){const{message:r,code:s}=h2[n];return{message:t?`${r} ${t}`:r,code:s}}function l2(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function f2(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}var Wc={exports:{}};(function(n,t){var r=typeof self<"u"?self:xi,s=function(){function l(){this.fetch=!1,this.DOMException=r.DOMException}return l.prototype=r,new l}();(function(l){(function(m){var f={searchParams:"URLSearchParams"in l,iterable:"Symbol"in l&&"iterator"in Symbol,blob:"FileReader"in l&&"Blob"in l&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in l,arrayBuffer:"ArrayBuffer"in l};function w(S){return S&&DataView.prototype.isPrototypeOf(S)}if(f.arrayBuffer)var O=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],I=ArrayBuffer.isView||function(S){return S&&O.indexOf(Object.prototype.toString.call(S))>-1};function P(S){if(typeof S!="string"&&(S=String(S)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(S))throw new TypeError("Invalid character in header field name");return S.toLowerCase()}function $(S){return typeof S!="string"&&(S=String(S)),S}function R(S){var C={next:function(){var te=S.shift();return{done:te===void 0,value:te}}};return f.iterable&&(C[Symbol.iterator]=function(){return C}),C}function N(S){this.map={},S instanceof N?S.forEach(function(C,te){this.append(te,C)},this):Array.isArray(S)?S.forEach(function(C){this.append(C[0],C[1])},this):S&&Object.getOwnPropertyNames(S).forEach(function(C){this.append(C,S[C])},this)}N.prototype.append=function(S,C){S=P(S),C=$(C);var te=this.map[S];this.map[S]=te?te+", "+C:C},N.prototype.delete=function(S){delete this.map[P(S)]},N.prototype.get=function(S){return S=P(S),this.has(S)?this.map[S]:null},N.prototype.has=function(S){return this.map.hasOwnProperty(P(S))},N.prototype.set=function(S,C){this.map[P(S)]=$(C)},N.prototype.forEach=function(S,C){for(var te in this.map)this.map.hasOwnProperty(te)&&S.call(C,this.map[te],te,this)},N.prototype.keys=function(){var S=[];return this.forEach(function(C,te){S.push(te)}),R(S)},N.prototype.values=function(){var S=[];return this.forEach(function(C){S.push(C)}),R(S)},N.prototype.entries=function(){var S=[];return this.forEach(function(C,te){S.push([te,C])}),R(S)},f.iterable&&(N.prototype[Symbol.iterator]=N.prototype.entries);function z(S){if(S.bodyUsed)return Promise.reject(new TypeError("Already read"));S.bodyUsed=!0}function L(S){return new Promise(function(C,te){S.onload=function(){C(S.result)},S.onerror=function(){te(S.error)}})}function Q(S){var C=new FileReader,te=L(C);return C.readAsArrayBuffer(S),te}function d(S){var C=new FileReader,te=L(C);return C.readAsText(S),te}function b(S){for(var C=new Uint8Array(S),te=new Array(C.length),X=0;X<C.length;X++)te[X]=String.fromCharCode(C[X]);return te.join("")}function y(S){if(S.slice)return S.slice(0);var C=new Uint8Array(S.byteLength);return C.set(new Uint8Array(S)),C.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(S){this._bodyInit=S,S?typeof S=="string"?this._bodyText=S:f.blob&&Blob.prototype.isPrototypeOf(S)?this._bodyBlob=S:f.formData&&FormData.prototype.isPrototypeOf(S)?this._bodyFormData=S:f.searchParams&&URLSearchParams.prototype.isPrototypeOf(S)?this._bodyText=S.toString():f.arrayBuffer&&f.blob&&w(S)?(this._bodyArrayBuffer=y(S.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(S)||I(S))?this._bodyArrayBuffer=y(S):this._bodyText=S=Object.prototype.toString.call(S):this._bodyText="",this.headers.get("content-type")||(typeof S=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f.searchParams&&URLSearchParams.prototype.isPrototypeOf(S)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},f.blob&&(this.blob=function(){var S=z(this);if(S)return S;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?z(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(Q)}),this.text=function(){var S=z(this);if(S)return S;if(this._bodyBlob)return d(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(b(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(K)}),this.json=function(){return this.text().then(JSON.parse)},this}var p=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function c(S){var C=S.toUpperCase();return p.indexOf(C)>-1?C:S}function _(S,C){C=C||{};var te=C.body;if(S instanceof _){if(S.bodyUsed)throw new TypeError("Already read");this.url=S.url,this.credentials=S.credentials,C.headers||(this.headers=new N(S.headers)),this.method=S.method,this.mode=S.mode,this.signal=S.signal,!te&&S._bodyInit!=null&&(te=S._bodyInit,S.bodyUsed=!0)}else this.url=String(S);if(this.credentials=C.credentials||this.credentials||"same-origin",(C.headers||!this.headers)&&(this.headers=new N(C.headers)),this.method=c(C.method||this.method||"GET"),this.mode=C.mode||this.mode||null,this.signal=C.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&te)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(te)}_.prototype.clone=function(){return new _(this,{body:this._bodyInit})};function K(S){var C=new FormData;return S.trim().split("&").forEach(function(te){if(te){var X=te.split("="),k=X.shift().replace(/\+/g," "),W=X.join("=").replace(/\+/g," ");C.append(decodeURIComponent(k),decodeURIComponent(W))}}),C}function G(S){var C=new N,te=S.replace(/\r?\n[\t ]+/g," ");return te.split(/\r?\n/).forEach(function(X){var k=X.split(":"),W=k.shift().trim();if(W){var J=k.join(":").trim();C.append(W,J)}}),C}v.call(_.prototype);function se(S,C){C||(C={}),this.type="default",this.status=C.status===void 0?200:C.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in C?C.statusText:"OK",this.headers=new N(C.headers),this.url=C.url||"",this._initBody(S)}v.call(se.prototype),se.prototype.clone=function(){return new se(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new N(this.headers),url:this.url})},se.error=function(){var S=new se(null,{status:0,statusText:""});return S.type="error",S};var ce=[301,302,303,307,308];se.redirect=function(S,C){if(ce.indexOf(C)===-1)throw new RangeError("Invalid status code");return new se(null,{status:C,headers:{location:S}})},m.DOMException=l.DOMException;try{new m.DOMException}catch{m.DOMException=function(C,te){this.message=C,this.name=te;var X=Error(C);this.stack=X.stack},m.DOMException.prototype=Object.create(Error.prototype),m.DOMException.prototype.constructor=m.DOMException}function de(S,C){return new Promise(function(te,X){var k=new _(S,C);if(k.signal&&k.signal.aborted)return X(new m.DOMException("Aborted","AbortError"));var W=new XMLHttpRequest;function J(){W.abort()}W.onload=function(){var ie={status:W.status,statusText:W.statusText,headers:G(W.getAllResponseHeaders()||"")};ie.url="responseURL"in W?W.responseURL:ie.headers.get("X-Request-URL");var be="response"in W?W.response:W.responseText;te(new se(be,ie))},W.onerror=function(){X(new TypeError("Network request failed"))},W.ontimeout=function(){X(new TypeError("Network request failed"))},W.onabort=function(){X(new m.DOMException("Aborted","AbortError"))},W.open(k.method,k.url,!0),k.credentials==="include"?W.withCredentials=!0:k.credentials==="omit"&&(W.withCredentials=!1),"responseType"in W&&f.blob&&(W.responseType="blob"),k.headers.forEach(function(ie,be){W.setRequestHeader(be,ie)}),k.signal&&(k.signal.addEventListener("abort",J),W.onreadystatechange=function(){W.readyState===4&&k.signal.removeEventListener("abort",J)}),W.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return de.polyfill=!0,l.fetch||(l.fetch=de,l.Headers=N,l.Request=_,l.Response=se),m.Headers=N,m.Request=_,m.Response=se,m.fetch=de,Object.defineProperty(m,"__esModule",{value:!0}),m})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;t=o.fetch,t.default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,n.exports=t})(Wc,Wc.exports);var d2=Wc.exports;const Vf=nd(d2),p2={Accept:"application/json","Content-Type":"application/json"},g2="POST",kf={headers:p2,method:g2},Wf=10;class Zi{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new $r.EventEmitter,this.isAvailable=!1,this.registering=!1,!xl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const s=ss(t),l=await(await Vf(this.url,Object.assign(Object.assign({},kf),{body:s}))).json();this.onPayload({data:l})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!xl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),o(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=ss({id:1,jsonrpc:"2.0",method:"test",params:[]});await Vf(t,Object.assign(Object.assign({},kf),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?du(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),o=s.message||s.toString(),l=Ta(t,o);this.events.emit("payload",l)}parseError(t,r=this.url){return sd(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Wf&&this.events.setMaxListeners(Wf)}}const Gf="error",y2="wss://relay.walletconnect.com",_2="wc",v2="universal_provider",Yf=`${_2}@2:${v2}:`,m2="https://rpc.walletconnect.com/v1",Pi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var is=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Gc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,t){(function(){var r,s="4.17.21",o=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",m="Expected a function",f="Invalid `variable` option passed into `_.template`",w="__lodash_hash_undefined__",O=500,I="__lodash_placeholder__",P=1,$=2,R=4,N=1,z=2,L=1,Q=2,d=4,b=8,y=16,v=32,p=64,c=128,_=256,K=512,G=30,se="...",ce=800,de=16,S=1,C=2,te=3,X=1/0,k=9007199254740991,W=17976931348623157e292,J=0/0,ie=4294967295,be=ie-1,ae=ie>>>1,we=[["ary",c],["bind",L],["bindKey",Q],["curry",b],["curryRight",y],["flip",K],["partial",v],["partialRight",p],["rearg",_]],le="[object Arguments]",_e="[object Array]",H="[object AsyncFunction]",B="[object Boolean]",F="[object Date]",h="[object DOMException]",T="[object Error]",oe="[object Function]",fe="[object GeneratorFunction]",Ie="[object Map]",ze="[object Number]",Ve="[object Null]",Le="[object Object]",dt="[object Promise]",pt="[object Proxy]",je="[object RegExp]",xe="[object Set]",Ue="[object String]",Re="[object Symbol]",qe="[object Undefined]",Ae="[object WeakMap]",Fe="[object WeakSet]",Se="[object ArrayBuffer]",Ce="[object DataView]",He="[object Float32Array]",Oe="[object Float64Array]",ke="[object Int8Array]",Ge="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Je="[object Uint8ClampedArray]",Zt="[object Uint16Array]",ur="[object Uint32Array]",Vr=/\b__p \+= '';/g,er=/\b(__p \+=) '' \+/g,ti=/(__e\(.*?\)|\b__t\)) \+\n'';/g,pi=/&(?:amp|lt|gt|quot|#39);/g,Ti=/[&<>"']/g,bt=RegExp(pi.source),gt=RegExp(Ti.source),wt=/<%-([\s\S]+?)%>/g,Et=/<%([\s\S]+?)%>/g,vt=/<%=([\s\S]+?)%>/g,yt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ut=/^\w*$/,Rt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Dt=/[\\^$.*+?()[\]{}|]/g,Ft=RegExp(Dt.source),St=/^\s+/,At=/\s/,It=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,$t=/,? & /,Lt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,za=/[()=,{}\[\]\/\s]/,Ha=/\\(\\)?/g,Ka=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Sr=/\w*$/,Va=/^[-+]0x[0-9a-f]+$/i,ka=/^0b[01]+$/i,Wa=/^\[object .+?Constructor\]$/,Ga=/^0o[0-7]+$/i,Ya=/^(?:0|[1-9]\d*)$/,ri=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,en=/($^)/,Ja=/['\n\r\u2028\u2029\\]/g,tn="\\ud800-\\udfff",Xa="\\u0300-\\u036f",Qa="\\ufe20-\\ufe2f",rn="\\u20d0-\\u20ff",ps=Xa+Qa+rn,gs="\\u2700-\\u27bf",Lr="a-z\\xdf-\\xf6\\xf8-\\xff",Za="\\xac\\xb1\\xd7\\xf7",eo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",to="\\u2000-\\u206f",ro=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ys="A-Z\\xc0-\\xd6\\xd8-\\xde",_s="\\ufe0e\\ufe0f",Ni=Za+eo+to+ro,On="['â€™]",Ui="["+tn+"]",An="["+Ni+"]",Ri="["+ps+"]",vs="\\d+",io="["+gs+"]",ms="["+Lr+"]",bs="[^"+tn+Ni+vs+gs+Lr+ys+"]",nn="\\ud83c[\\udffb-\\udfff]",no="(?:"+Ri+"|"+nn+")",ws="[^"+tn+"]",sn="(?:\\ud83c[\\udde6-\\uddff]){2}",gi="[\\ud800-\\udbff][\\udc00-\\udfff]",_r="["+ys+"]",Es="\\u200d",Ds="(?:"+ms+"|"+bs+")",kr="(?:"+_r+"|"+bs+")",Ss="(?:"+On+"(?:d|ll|m|re|s|t|ve))?",Is="(?:"+On+"(?:D|LL|M|RE|S|T|VE))?",xs=no+"?",Os="["+_s+"]?",so="(?:"+Es+"(?:"+[ws,sn,gi].join("|")+")"+Os+xs+")*",ii="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",As="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Cs=Os+xs+so,an="(?:"+[io,sn,gi].join("|")+")"+Cs,ao="(?:"+[ws+Ri+"?",Ri,sn,gi,Ui].join("|")+")",Cn=RegExp(On,"g"),oo=RegExp(Ri,"g"),on=RegExp(nn+"(?="+nn+")|"+ao+Cs,"g"),Ps=RegExp([_r+"?"+ms+"+"+Ss+"(?="+[An,_r,"$"].join("|")+")",kr+"+"+Is+"(?="+[An,_r+Ds,"$"].join("|")+")",_r+"?"+Ds+"+"+Ss,_r+"+"+Is,As,ii,vs,an].join("|"),"g"),Ts=RegExp("["+Es+tn+ps+_s+"]"),Fi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ns=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],co=-1,at={};at[He]=at[Oe]=at[ke]=at[Ge]=at[et]=at[tt]=at[Je]=at[Zt]=at[ur]=!0,at[le]=at[_e]=at[Se]=at[B]=at[Ce]=at[F]=at[T]=at[oe]=at[Ie]=at[ze]=at[Le]=at[je]=at[xe]=at[Ue]=at[Ae]=!1;var st={};st[le]=st[_e]=st[Se]=st[Ce]=st[B]=st[F]=st[He]=st[Oe]=st[ke]=st[Ge]=st[et]=st[Ie]=st[ze]=st[Le]=st[je]=st[xe]=st[Ue]=st[Re]=st[tt]=st[Je]=st[Zt]=st[ur]=!0,st[T]=st[oe]=st[Ae]=!1;var x={Ã€:"A",Ã:"A",Ã‚:"A",Ãƒ:"A",Ã„:"A",Ã…:"A",Ã :"a",Ã¡:"a",Ã¢:"a",Ã£:"a",Ã¤:"a",Ã¥:"a",Ã‡:"C",Ã§:"c",Ã:"D",Ã°:"d",Ãˆ:"E",Ã‰:"E",ÃŠ:"E",Ã‹:"E",Ã¨:"e",Ã©:"e",Ãª:"e",Ã«:"e",ÃŒ:"I",Ã:"I",ÃŽ:"I",Ã:"I",Ã¬:"i",Ã­:"i",Ã®:"i",Ã¯:"i",Ã‘:"N",Ã±:"n",Ã’:"O",Ã“:"O",Ã”:"O",Ã•:"O",Ã–:"O",Ã˜:"O",Ã²:"o",Ã³:"o",Ã´:"o",Ãµ:"o",Ã¶:"o",Ã¸:"o",Ã™:"U",Ãš:"U",Ã›:"U",Ãœ:"U",Ã¹:"u",Ãº:"u",Ã»:"u",Ã¼:"u",Ã:"Y",Ã½:"y",Ã¿:"y",Ã†:"Ae",Ã¦:"ae",Ãž:"Th",Ã¾:"th",ÃŸ:"ss",Ä€:"A",Ä‚:"A",Ä„:"A",Ä:"a",Äƒ:"a",Ä…:"a",Ä†:"C",Äˆ:"C",ÄŠ:"C",ÄŒ:"C",Ä‡:"c",Ä‰:"c",Ä‹:"c",Ä:"c",ÄŽ:"D",Ä:"D",Ä:"d",Ä‘:"d",Ä’:"E",Ä”:"E",Ä–:"E",Ä˜:"E",Äš:"E",Ä“:"e",Ä•:"e",Ä—:"e",Ä™:"e",Ä›:"e",Äœ:"G",Äž:"G",Ä :"G",Ä¢:"G",Ä:"g",ÄŸ:"g",Ä¡:"g",Ä£:"g",Ä¤:"H",Ä¦:"H",Ä¥:"h",Ä§:"h",Ä¨:"I",Äª:"I",Ä¬:"I",Ä®:"I",Ä°:"I",Ä©:"i",Ä«:"i",Ä­:"i",Ä¯:"i",Ä±:"i",Ä´:"J",Äµ:"j",Ä¶:"K",Ä·:"k",Ä¸:"k",Ä¹:"L",Ä»:"L",Ä½:"L",Ä¿:"L",Å:"L",Äº:"l",Ä¼:"l",Ä¾:"l",Å€:"l",Å‚:"l",Åƒ:"N",Å…:"N",Å‡:"N",ÅŠ:"N",Å„:"n",Å†:"n",Åˆ:"n",Å‹:"n",ÅŒ:"O",ÅŽ:"O",Å:"O",Å:"o",Å:"o",Å‘:"o",Å”:"R",Å–:"R",Å˜:"R",Å•:"r",Å—:"r",Å™:"r",Åš:"S",Åœ:"S",Åž:"S",Å :"S",Å›:"s",Å:"s",ÅŸ:"s",Å¡:"s",Å¢:"T",Å¤:"T",Å¦:"T",Å£:"t",Å¥:"t",Å§:"t",Å¨:"U",Åª:"U",Å¬:"U",Å®:"U",Å°:"U",Å²:"U",Å©:"u",Å«:"u",Å­:"u",Å¯:"u",Å±:"u",Å³:"u",Å´:"W",Åµ:"w",Å¶:"Y",Å·:"y",Å¸:"Y",Å¹:"Z",Å»:"Z",Å½:"Z",Åº:"z",Å¼:"z",Å¾:"z",Ä²:"IJ",Ä³:"ij",Å’:"Oe",Å“:"oe",Å‰:"'n",Å¿:"s"},M={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},re={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ot=parseFloat,Te=parseInt,lt=typeof is=="object"&&is&&is.Object===Object&&is,Mt=typeof self=="object"&&self&&self.Object===Object&&self,Xe=lt||Mt||Function("return this")(),ct=t&&!t.nodeType&&t,Ct=ct&&!0&&n&&!n.nodeType&&n,hr=Ct&&Ct.exports===ct,jt=hr&&lt.process,ft=function(){try{var j=Ct&&Ct.require&&Ct.require("util").types;return j||jt&&jt.binding&&jt.binding("util")}catch{}}(),tr=ft&&ft.isArrayBuffer,Mr=ft&&ft.isDate,Ir=ft&&ft.isMap,Wr=ft&&ft.isRegExp,Pn=ft&&ft.isSet,$i=ft&&ft.isTypedArray;function Ht(j,Y,V){switch(V.length){case 0:return j.call(Y);case 1:return j.call(Y,V[0]);case 2:return j.call(Y,V[0],V[1]);case 3:return j.call(Y,V[0],V[1],V[2])}return j.apply(Y,V)}function gp(j,Y,V,ge){for(var Pe=-1,rt=j==null?0:j.length;++Pe<rt;){var Bt=j[Pe];Y(ge,Bt,V(Bt),j)}return ge}function xr(j,Y){for(var V=-1,ge=j==null?0:j.length;++V<ge&&Y(j[V],V,j)!==!1;);return j}function yp(j,Y){for(var V=j==null?0:j.length;V--&&Y(j[V],V,j)!==!1;);return j}function Ou(j,Y){for(var V=-1,ge=j==null?0:j.length;++V<ge;)if(!Y(j[V],V,j))return!1;return!0}function yi(j,Y){for(var V=-1,ge=j==null?0:j.length,Pe=0,rt=[];++V<ge;){var Bt=j[V];Y(Bt,V,j)&&(rt[Pe++]=Bt)}return rt}function Us(j,Y){var V=j==null?0:j.length;return!!V&&cn(j,Y,0)>-1}function uo(j,Y,V){for(var ge=-1,Pe=j==null?0:j.length;++ge<Pe;)if(V(Y,j[ge]))return!0;return!1}function _t(j,Y){for(var V=-1,ge=j==null?0:j.length,Pe=Array(ge);++V<ge;)Pe[V]=Y(j[V],V,j);return Pe}function _i(j,Y){for(var V=-1,ge=Y.length,Pe=j.length;++V<ge;)j[Pe+V]=Y[V];return j}function ho(j,Y,V,ge){var Pe=-1,rt=j==null?0:j.length;for(ge&&rt&&(V=j[++Pe]);++Pe<rt;)V=Y(V,j[Pe],Pe,j);return V}function _p(j,Y,V,ge){var Pe=j==null?0:j.length;for(ge&&Pe&&(V=j[--Pe]);Pe--;)V=Y(V,j[Pe],Pe,j);return V}function lo(j,Y){for(var V=-1,ge=j==null?0:j.length;++V<ge;)if(Y(j[V],V,j))return!0;return!1}var vp=fo("length");function mp(j){return j.split("")}function bp(j){return j.match(Lt)||[]}function Au(j,Y,V){var ge;return V(j,function(Pe,rt,Bt){if(Y(Pe,rt,Bt))return ge=rt,!1}),ge}function Rs(j,Y,V,ge){for(var Pe=j.length,rt=V+(ge?1:-1);ge?rt--:++rt<Pe;)if(Y(j[rt],rt,j))return rt;return-1}function cn(j,Y,V){return Y===Y?Np(j,Y,V):Rs(j,Cu,V)}function wp(j,Y,V,ge){for(var Pe=V-1,rt=j.length;++Pe<rt;)if(ge(j[Pe],Y))return Pe;return-1}function Cu(j){return j!==j}function Pu(j,Y){var V=j==null?0:j.length;return V?go(j,Y)/V:J}function fo(j){return function(Y){return Y==null?r:Y[j]}}function po(j){return function(Y){return j==null?r:j[Y]}}function Tu(j,Y,V,ge,Pe){return Pe(j,function(rt,Bt,ut){V=ge?(ge=!1,rt):Y(V,rt,Bt,ut)}),V}function Ep(j,Y){var V=j.length;for(j.sort(Y);V--;)j[V]=j[V].value;return j}function go(j,Y){for(var V,ge=-1,Pe=j.length;++ge<Pe;){var rt=Y(j[ge]);rt!==r&&(V=V===r?rt:V+rt)}return V}function yo(j,Y){for(var V=-1,ge=Array(j);++V<j;)ge[V]=Y(V);return ge}function Dp(j,Y){return _t(Y,function(V){return[V,j[V]]})}function Nu(j){return j&&j.slice(0,$u(j)+1).replace(St,"")}function vr(j){return function(Y){return j(Y)}}function _o(j,Y){return _t(Y,function(V){return j[V]})}function Tn(j,Y){return j.has(Y)}function Uu(j,Y){for(var V=-1,ge=j.length;++V<ge&&cn(Y,j[V],0)>-1;);return V}function Ru(j,Y){for(var V=j.length;V--&&cn(Y,j[V],0)>-1;);return V}function Sp(j,Y){for(var V=j.length,ge=0;V--;)j[V]===Y&&++ge;return ge}var Ip=po(x),xp=po(M);function Op(j){return"\\"+pe[j]}function Ap(j,Y){return j==null?r:j[Y]}function un(j){return Ts.test(j)}function Cp(j){return Fi.test(j)}function Pp(j){for(var Y,V=[];!(Y=j.next()).done;)V.push(Y.value);return V}function vo(j){var Y=-1,V=Array(j.size);return j.forEach(function(ge,Pe){V[++Y]=[Pe,ge]}),V}function Fu(j,Y){return function(V){return j(Y(V))}}function vi(j,Y){for(var V=-1,ge=j.length,Pe=0,rt=[];++V<ge;){var Bt=j[V];(Bt===Y||Bt===I)&&(j[V]=I,rt[Pe++]=V)}return rt}function Fs(j){var Y=-1,V=Array(j.size);return j.forEach(function(ge){V[++Y]=ge}),V}function Tp(j){var Y=-1,V=Array(j.size);return j.forEach(function(ge){V[++Y]=[ge,ge]}),V}function Np(j,Y,V){for(var ge=V-1,Pe=j.length;++ge<Pe;)if(j[ge]===Y)return ge;return-1}function Up(j,Y,V){for(var ge=V+1;ge--;)if(j[ge]===Y)return ge;return ge}function hn(j){return un(j)?Fp(j):vp(j)}function jr(j){return un(j)?$p(j):mp(j)}function $u(j){for(var Y=j.length;Y--&&At.test(j.charAt(Y)););return Y}var Rp=po(re);function Fp(j){for(var Y=on.lastIndex=0;on.test(j);)++Y;return Y}function $p(j){return j.match(on)||[]}function Lp(j){return j.match(Ps)||[]}var Mp=function j(Y){Y=Y==null?Xe:ln.defaults(Xe.Object(),Y,ln.pick(Xe,Ns));var V=Y.Array,ge=Y.Date,Pe=Y.Error,rt=Y.Function,Bt=Y.Math,ut=Y.Object,mo=Y.RegExp,jp=Y.String,Or=Y.TypeError,$s=V.prototype,qp=rt.prototype,fn=ut.prototype,Ls=Y["__core-js_shared__"],Ms=qp.toString,nt=fn.hasOwnProperty,Bp=0,Lu=function(){var e=/[^.]+$/.exec(Ls&&Ls.keys&&Ls.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),js=fn.toString,zp=Ms.call(ut),Hp=Xe._,Kp=mo("^"+Ms.call(nt).replace(Dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qs=hr?Y.Buffer:r,mi=Y.Symbol,Bs=Y.Uint8Array,Mu=qs?qs.allocUnsafe:r,zs=Fu(ut.getPrototypeOf,ut),ju=ut.create,qu=fn.propertyIsEnumerable,Hs=$s.splice,Bu=mi?mi.isConcatSpreadable:r,Nn=mi?mi.iterator:r,Li=mi?mi.toStringTag:r,Ks=function(){try{var e=zi(ut,"defineProperty");return e({},"",{}),e}catch{}}(),Vp=Y.clearTimeout!==Xe.clearTimeout&&Y.clearTimeout,kp=ge&&ge.now!==Xe.Date.now&&ge.now,Wp=Y.setTimeout!==Xe.setTimeout&&Y.setTimeout,Vs=Bt.ceil,ks=Bt.floor,bo=ut.getOwnPropertySymbols,Gp=qs?qs.isBuffer:r,zu=Y.isFinite,Yp=$s.join,Jp=Fu(ut.keys,ut),zt=Bt.max,Jt=Bt.min,Xp=ge.now,Qp=Y.parseInt,Hu=Bt.random,Zp=$s.reverse,wo=zi(Y,"DataView"),Un=zi(Y,"Map"),Eo=zi(Y,"Promise"),dn=zi(Y,"Set"),Rn=zi(Y,"WeakMap"),Fn=zi(ut,"create"),Ws=Rn&&new Rn,pn={},eg=Hi(wo),tg=Hi(Un),rg=Hi(Eo),ig=Hi(dn),ng=Hi(Rn),Gs=mi?mi.prototype:r,$n=Gs?Gs.valueOf:r,Ku=Gs?Gs.toString:r;function E(e){if(xt(e)&&!Ne(e)&&!(e instanceof Ye)){if(e instanceof Ar)return e;if(nt.call(e,"__wrapped__"))return Vh(e)}return new Ar(e)}var gn=function(){function e(){}return function(i){if(!mt(i))return{};if(ju)return ju(i);e.prototype=i;var a=new e;return e.prototype=r,a}}();function Ys(){}function Ar(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}E.templateSettings={escape:wt,evaluate:Et,interpolate:vt,variable:"",imports:{_:E}},E.prototype=Ys.prototype,E.prototype.constructor=E,Ar.prototype=gn(Ys.prototype),Ar.prototype.constructor=Ar;function Ye(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ie,this.__views__=[]}function sg(){var e=new Ye(this.__wrapped__);return e.__actions__=lr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=lr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=lr(this.__views__),e}function ag(){if(this.__filtered__){var e=new Ye(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function og(){var e=this.__wrapped__.value(),i=this.__dir__,a=Ne(e),u=i<0,g=a?e.length:0,D=m0(0,g,this.__views__),A=D.start,U=D.end,q=U-A,Z=u?U:A-1,ee=this.__iteratees__,ne=ee.length,ue=0,ye=Jt(q,this.__takeCount__);if(!a||!u&&g==q&&ye==q)return ph(e,this.__actions__);var Ee=[];e:for(;q--&&ue<ye;){Z+=i;for(var Be=-1,De=e[Z];++Be<ne;){var We=ee[Be],Qe=We.iteratee,wr=We.type,nr=Qe(De);if(wr==C)De=nr;else if(!nr){if(wr==S)continue e;break e}}Ee[ue++]=De}return Ee}Ye.prototype=gn(Ys.prototype),Ye.prototype.constructor=Ye;function Mi(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var u=e[i];this.set(u[0],u[1])}}function cg(){this.__data__=Fn?Fn(null):{},this.size=0}function ug(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function hg(e){var i=this.__data__;if(Fn){var a=i[e];return a===w?r:a}return nt.call(i,e)?i[e]:r}function lg(e){var i=this.__data__;return Fn?i[e]!==r:nt.call(i,e)}function fg(e,i){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=Fn&&i===r?w:i,this}Mi.prototype.clear=cg,Mi.prototype.delete=ug,Mi.prototype.get=hg,Mi.prototype.has=lg,Mi.prototype.set=fg;function ni(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var u=e[i];this.set(u[0],u[1])}}function dg(){this.__data__=[],this.size=0}function pg(e){var i=this.__data__,a=Js(i,e);if(a<0)return!1;var u=i.length-1;return a==u?i.pop():Hs.call(i,a,1),--this.size,!0}function gg(e){var i=this.__data__,a=Js(i,e);return a<0?r:i[a][1]}function yg(e){return Js(this.__data__,e)>-1}function _g(e,i){var a=this.__data__,u=Js(a,e);return u<0?(++this.size,a.push([e,i])):a[u][1]=i,this}ni.prototype.clear=dg,ni.prototype.delete=pg,ni.prototype.get=gg,ni.prototype.has=yg,ni.prototype.set=_g;function si(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var u=e[i];this.set(u[0],u[1])}}function vg(){this.size=0,this.__data__={hash:new Mi,map:new(Un||ni),string:new Mi}}function mg(e){var i=ca(this,e).delete(e);return this.size-=i?1:0,i}function bg(e){return ca(this,e).get(e)}function wg(e){return ca(this,e).has(e)}function Eg(e,i){var a=ca(this,e),u=a.size;return a.set(e,i),this.size+=a.size==u?0:1,this}si.prototype.clear=vg,si.prototype.delete=mg,si.prototype.get=bg,si.prototype.has=wg,si.prototype.set=Eg;function ji(e){var i=-1,a=e==null?0:e.length;for(this.__data__=new si;++i<a;)this.add(e[i])}function Dg(e){return this.__data__.set(e,w),this}function Sg(e){return this.__data__.has(e)}ji.prototype.add=ji.prototype.push=Dg,ji.prototype.has=Sg;function qr(e){var i=this.__data__=new ni(e);this.size=i.size}function Ig(){this.__data__=new ni,this.size=0}function xg(e){var i=this.__data__,a=i.delete(e);return this.size=i.size,a}function Og(e){return this.__data__.get(e)}function Ag(e){return this.__data__.has(e)}function Cg(e,i){var a=this.__data__;if(a instanceof ni){var u=a.__data__;if(!Un||u.length<o-1)return u.push([e,i]),this.size=++a.size,this;a=this.__data__=new si(u)}return a.set(e,i),this.size=a.size,this}qr.prototype.clear=Ig,qr.prototype.delete=xg,qr.prototype.get=Og,qr.prototype.has=Ag,qr.prototype.set=Cg;function Vu(e,i){var a=Ne(e),u=!a&&Ki(e),g=!a&&!u&&Si(e),D=!a&&!u&&!g&&mn(e),A=a||u||g||D,U=A?yo(e.length,jp):[],q=U.length;for(var Z in e)(i||nt.call(e,Z))&&!(A&&(Z=="length"||g&&(Z=="offset"||Z=="parent")||D&&(Z=="buffer"||Z=="byteLength"||Z=="byteOffset")||ui(Z,q)))&&U.push(Z);return U}function ku(e){var i=e.length;return i?e[Uo(0,i-1)]:r}function Pg(e,i){return ua(lr(e),qi(i,0,e.length))}function Tg(e){return ua(lr(e))}function Do(e,i,a){(a!==r&&!Br(e[i],a)||a===r&&!(i in e))&&ai(e,i,a)}function Ln(e,i,a){var u=e[i];(!(nt.call(e,i)&&Br(u,a))||a===r&&!(i in e))&&ai(e,i,a)}function Js(e,i){for(var a=e.length;a--;)if(Br(e[a][0],i))return a;return-1}function Ng(e,i,a,u){return bi(e,function(g,D,A){i(u,g,a(g),A)}),u}function Wu(e,i){return e&&Yr(i,Kt(i),e)}function Ug(e,i){return e&&Yr(i,dr(i),e)}function ai(e,i,a){i=="__proto__"&&Ks?Ks(e,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[i]=a}function So(e,i){for(var a=-1,u=i.length,g=V(u),D=e==null;++a<u;)g[a]=D?r:nc(e,i[a]);return g}function qi(e,i,a){return e===e&&(a!==r&&(e=e<=a?e:a),i!==r&&(e=e>=i?e:i)),e}function Cr(e,i,a,u,g,D){var A,U=i&P,q=i&$,Z=i&R;if(a&&(A=g?a(e,u,g,D):a(e)),A!==r)return A;if(!mt(e))return e;var ee=Ne(e);if(ee){if(A=w0(e),!U)return lr(e,A)}else{var ne=Xt(e),ue=ne==oe||ne==fe;if(Si(e))return _h(e,U);if(ne==Le||ne==le||ue&&!g){if(A=q||ue?{}:$h(e),!U)return q?h0(e,Ug(A,e)):u0(e,Wu(A,e))}else{if(!st[ne])return g?e:{};A=E0(e,ne,U)}}D||(D=new qr);var ye=D.get(e);if(ye)return ye;D.set(e,A),ll(e)?e.forEach(function(De){A.add(Cr(De,i,a,De,e,D))}):ul(e)&&e.forEach(function(De,We){A.set(We,Cr(De,i,a,We,e,D))});var Ee=Z?q?Ko:Ho:q?dr:Kt,Be=ee?r:Ee(e);return xr(Be||e,function(De,We){Be&&(We=De,De=e[We]),Ln(A,We,Cr(De,i,a,We,e,D))}),A}function Rg(e){var i=Kt(e);return function(a){return Gu(a,e,i)}}function Gu(e,i,a){var u=a.length;if(e==null)return!u;for(e=ut(e);u--;){var g=a[u],D=i[g],A=e[g];if(A===r&&!(g in e)||!D(A))return!1}return!0}function Yu(e,i,a){if(typeof e!="function")throw new Or(m);return Kn(function(){e.apply(r,a)},i)}function Mn(e,i,a,u){var g=-1,D=Us,A=!0,U=e.length,q=[],Z=i.length;if(!U)return q;a&&(i=_t(i,vr(a))),u?(D=uo,A=!1):i.length>=o&&(D=Tn,A=!1,i=new ji(i));e:for(;++g<U;){var ee=e[g],ne=a==null?ee:a(ee);if(ee=u||ee!==0?ee:0,A&&ne===ne){for(var ue=Z;ue--;)if(i[ue]===ne)continue e;q.push(ee)}else D(i,ne,u)||q.push(ee)}return q}var bi=Eh(Gr),Ju=Eh(xo,!0);function Fg(e,i){var a=!0;return bi(e,function(u,g,D){return a=!!i(u,g,D),a}),a}function Xs(e,i,a){for(var u=-1,g=e.length;++u<g;){var D=e[u],A=i(D);if(A!=null&&(U===r?A===A&&!br(A):a(A,U)))var U=A,q=D}return q}function $g(e,i,a,u){var g=e.length;for(a=Me(a),a<0&&(a=-a>g?0:g+a),u=u===r||u>g?g:Me(u),u<0&&(u+=g),u=a>u?0:dl(u);a<u;)e[a++]=i;return e}function Xu(e,i){var a=[];return bi(e,function(u,g,D){i(u,g,D)&&a.push(u)}),a}function Wt(e,i,a,u,g){var D=-1,A=e.length;for(a||(a=S0),g||(g=[]);++D<A;){var U=e[D];i>0&&a(U)?i>1?Wt(U,i-1,a,u,g):_i(g,U):u||(g[g.length]=U)}return g}var Io=Dh(),Qu=Dh(!0);function Gr(e,i){return e&&Io(e,i,Kt)}function xo(e,i){return e&&Qu(e,i,Kt)}function Qs(e,i){return yi(i,function(a){return hi(e[a])})}function Bi(e,i){i=Ei(i,e);for(var a=0,u=i.length;e!=null&&a<u;)e=e[Jr(i[a++])];return a&&a==u?e:r}function Zu(e,i,a){var u=i(e);return Ne(e)?u:_i(u,a(e))}function rr(e){return e==null?e===r?qe:Ve:Li&&Li in ut(e)?v0(e):T0(e)}function Oo(e,i){return e>i}function Lg(e,i){return e!=null&&nt.call(e,i)}function Mg(e,i){return e!=null&&i in ut(e)}function jg(e,i,a){return e>=Jt(i,a)&&e<zt(i,a)}function Ao(e,i,a){for(var u=a?uo:Us,g=e[0].length,D=e.length,A=D,U=V(D),q=1/0,Z=[];A--;){var ee=e[A];A&&i&&(ee=_t(ee,vr(i))),q=Jt(ee.length,q),U[A]=!a&&(i||g>=120&&ee.length>=120)?new ji(A&&ee):r}ee=e[0];var ne=-1,ue=U[0];e:for(;++ne<g&&Z.length<q;){var ye=ee[ne],Ee=i?i(ye):ye;if(ye=a||ye!==0?ye:0,!(ue?Tn(ue,Ee):u(Z,Ee,a))){for(A=D;--A;){var Be=U[A];if(!(Be?Tn(Be,Ee):u(e[A],Ee,a)))continue e}ue&&ue.push(Ee),Z.push(ye)}}return Z}function qg(e,i,a,u){return Gr(e,function(g,D,A){i(u,a(g),D,A)}),u}function jn(e,i,a){i=Ei(i,e),e=qh(e,i);var u=e==null?e:e[Jr(Tr(i))];return u==null?r:Ht(u,e,a)}function eh(e){return xt(e)&&rr(e)==le}function Bg(e){return xt(e)&&rr(e)==Se}function zg(e){return xt(e)&&rr(e)==F}function qn(e,i,a,u,g){return e===i?!0:e==null||i==null||!xt(e)&&!xt(i)?e!==e&&i!==i:Hg(e,i,a,u,qn,g)}function Hg(e,i,a,u,g,D){var A=Ne(e),U=Ne(i),q=A?_e:Xt(e),Z=U?_e:Xt(i);q=q==le?Le:q,Z=Z==le?Le:Z;var ee=q==Le,ne=Z==Le,ue=q==Z;if(ue&&Si(e)){if(!Si(i))return!1;A=!0,ee=!1}if(ue&&!ee)return D||(D=new qr),A||mn(e)?Uh(e,i,a,u,g,D):y0(e,i,q,a,u,g,D);if(!(a&N)){var ye=ee&&nt.call(e,"__wrapped__"),Ee=ne&&nt.call(i,"__wrapped__");if(ye||Ee){var Be=ye?e.value():e,De=Ee?i.value():i;return D||(D=new qr),g(Be,De,a,u,D)}}return ue?(D||(D=new qr),_0(e,i,a,u,g,D)):!1}function Kg(e){return xt(e)&&Xt(e)==Ie}function Co(e,i,a,u){var g=a.length,D=g,A=!u;if(e==null)return!D;for(e=ut(e);g--;){var U=a[g];if(A&&U[2]?U[1]!==e[U[0]]:!(U[0]in e))return!1}for(;++g<D;){U=a[g];var q=U[0],Z=e[q],ee=U[1];if(A&&U[2]){if(Z===r&&!(q in e))return!1}else{var ne=new qr;if(u)var ue=u(Z,ee,q,e,i,ne);if(!(ue===r?qn(ee,Z,N|z,u,ne):ue))return!1}}return!0}function th(e){if(!mt(e)||x0(e))return!1;var i=hi(e)?Kp:Wa;return i.test(Hi(e))}function Vg(e){return xt(e)&&rr(e)==je}function kg(e){return xt(e)&&Xt(e)==xe}function Wg(e){return xt(e)&&ga(e.length)&&!!at[rr(e)]}function rh(e){return typeof e=="function"?e:e==null?pr:typeof e=="object"?Ne(e)?sh(e[0],e[1]):nh(e):Sl(e)}function Po(e){if(!Hn(e))return Jp(e);var i=[];for(var a in ut(e))nt.call(e,a)&&a!="constructor"&&i.push(a);return i}function Gg(e){if(!mt(e))return P0(e);var i=Hn(e),a=[];for(var u in e)u=="constructor"&&(i||!nt.call(e,u))||a.push(u);return a}function To(e,i){return e<i}function ih(e,i){var a=-1,u=fr(e)?V(e.length):[];return bi(e,function(g,D,A){u[++a]=i(g,D,A)}),u}function nh(e){var i=ko(e);return i.length==1&&i[0][2]?Mh(i[0][0],i[0][1]):function(a){return a===e||Co(a,e,i)}}function sh(e,i){return Go(e)&&Lh(i)?Mh(Jr(e),i):function(a){var u=nc(a,e);return u===r&&u===i?sc(a,e):qn(i,u,N|z)}}function Zs(e,i,a,u,g){e!==i&&Io(i,function(D,A){if(g||(g=new qr),mt(D))Yg(e,i,A,a,Zs,u,g);else{var U=u?u(Jo(e,A),D,A+"",e,i,g):r;U===r&&(U=D),Do(e,A,U)}},dr)}function Yg(e,i,a,u,g,D,A){var U=Jo(e,a),q=Jo(i,a),Z=A.get(q);if(Z){Do(e,a,Z);return}var ee=D?D(U,q,a+"",e,i,A):r,ne=ee===r;if(ne){var ue=Ne(q),ye=!ue&&Si(q),Ee=!ue&&!ye&&mn(q);ee=q,ue||ye||Ee?Ne(U)?ee=U:Pt(U)?ee=lr(U):ye?(ne=!1,ee=_h(q,!0)):Ee?(ne=!1,ee=vh(q,!0)):ee=[]:Vn(q)||Ki(q)?(ee=U,Ki(U)?ee=pl(U):(!mt(U)||hi(U))&&(ee=$h(q))):ne=!1}ne&&(A.set(q,ee),g(ee,q,u,D,A),A.delete(q)),Do(e,a,ee)}function ah(e,i){var a=e.length;if(a)return i+=i<0?a:0,ui(i,a)?e[i]:r}function oh(e,i,a){i.length?i=_t(i,function(D){return Ne(D)?function(A){return Bi(A,D.length===1?D[0]:D)}:D}):i=[pr];var u=-1;i=_t(i,vr(me()));var g=ih(e,function(D,A,U){var q=_t(i,function(Z){return Z(D)});return{criteria:q,index:++u,value:D}});return Ep(g,function(D,A){return c0(D,A,a)})}function Jg(e,i){return ch(e,i,function(a,u){return sc(e,u)})}function ch(e,i,a){for(var u=-1,g=i.length,D={};++u<g;){var A=i[u],U=Bi(e,A);a(U,A)&&Bn(D,Ei(A,e),U)}return D}function Xg(e){return function(i){return Bi(i,e)}}function No(e,i,a,u){var g=u?wp:cn,D=-1,A=i.length,U=e;for(e===i&&(i=lr(i)),a&&(U=_t(e,vr(a)));++D<A;)for(var q=0,Z=i[D],ee=a?a(Z):Z;(q=g(U,ee,q,u))>-1;)U!==e&&Hs.call(U,q,1),Hs.call(e,q,1);return e}function uh(e,i){for(var a=e?i.length:0,u=a-1;a--;){var g=i[a];if(a==u||g!==D){var D=g;ui(g)?Hs.call(e,g,1):$o(e,g)}}return e}function Uo(e,i){return e+ks(Hu()*(i-e+1))}function Qg(e,i,a,u){for(var g=-1,D=zt(Vs((i-e)/(a||1)),0),A=V(D);D--;)A[u?D:++g]=e,e+=a;return A}function Ro(e,i){var a="";if(!e||i<1||i>k)return a;do i%2&&(a+=e),i=ks(i/2),i&&(e+=e);while(i);return a}function Ke(e,i){return Xo(jh(e,i,pr),e+"")}function Zg(e){return ku(bn(e))}function e0(e,i){var a=bn(e);return ua(a,qi(i,0,a.length))}function Bn(e,i,a,u){if(!mt(e))return e;i=Ei(i,e);for(var g=-1,D=i.length,A=D-1,U=e;U!=null&&++g<D;){var q=Jr(i[g]),Z=a;if(q==="__proto__"||q==="constructor"||q==="prototype")return e;if(g!=A){var ee=U[q];Z=u?u(ee,q,U):r,Z===r&&(Z=mt(ee)?ee:ui(i[g+1])?[]:{})}Ln(U,q,Z),U=U[q]}return e}var hh=Ws?function(e,i){return Ws.set(e,i),e}:pr,t0=Ks?function(e,i){return Ks(e,"toString",{configurable:!0,enumerable:!1,value:oc(i),writable:!0})}:pr;function r0(e){return ua(bn(e))}function Pr(e,i,a){var u=-1,g=e.length;i<0&&(i=-i>g?0:g+i),a=a>g?g:a,a<0&&(a+=g),g=i>a?0:a-i>>>0,i>>>=0;for(var D=V(g);++u<g;)D[u]=e[u+i];return D}function i0(e,i){var a;return bi(e,function(u,g,D){return a=i(u,g,D),!a}),!!a}function ea(e,i,a){var u=0,g=e==null?u:e.length;if(typeof i=="number"&&i===i&&g<=ae){for(;u<g;){var D=u+g>>>1,A=e[D];A!==null&&!br(A)&&(a?A<=i:A<i)?u=D+1:g=D}return g}return Fo(e,i,pr,a)}function Fo(e,i,a,u){var g=0,D=e==null?0:e.length;if(D===0)return 0;i=a(i);for(var A=i!==i,U=i===null,q=br(i),Z=i===r;g<D;){var ee=ks((g+D)/2),ne=a(e[ee]),ue=ne!==r,ye=ne===null,Ee=ne===ne,Be=br(ne);if(A)var De=u||Ee;else Z?De=Ee&&(u||ue):U?De=Ee&&ue&&(u||!ye):q?De=Ee&&ue&&!ye&&(u||!Be):ye||Be?De=!1:De=u?ne<=i:ne<i;De?g=ee+1:D=ee}return Jt(D,be)}function lh(e,i){for(var a=-1,u=e.length,g=0,D=[];++a<u;){var A=e[a],U=i?i(A):A;if(!a||!Br(U,q)){var q=U;D[g++]=A===0?0:A}}return D}function fh(e){return typeof e=="number"?e:br(e)?J:+e}function mr(e){if(typeof e=="string")return e;if(Ne(e))return _t(e,mr)+"";if(br(e))return Ku?Ku.call(e):"";var i=e+"";return i=="0"&&1/e==-X?"-0":i}function wi(e,i,a){var u=-1,g=Us,D=e.length,A=!0,U=[],q=U;if(a)A=!1,g=uo;else if(D>=o){var Z=i?null:p0(e);if(Z)return Fs(Z);A=!1,g=Tn,q=new ji}else q=i?[]:U;e:for(;++u<D;){var ee=e[u],ne=i?i(ee):ee;if(ee=a||ee!==0?ee:0,A&&ne===ne){for(var ue=q.length;ue--;)if(q[ue]===ne)continue e;i&&q.push(ne),U.push(ee)}else g(q,ne,a)||(q!==U&&q.push(ne),U.push(ee))}return U}function $o(e,i){return i=Ei(i,e),e=qh(e,i),e==null||delete e[Jr(Tr(i))]}function dh(e,i,a,u){return Bn(e,i,a(Bi(e,i)),u)}function ta(e,i,a,u){for(var g=e.length,D=u?g:-1;(u?D--:++D<g)&&i(e[D],D,e););return a?Pr(e,u?0:D,u?D+1:g):Pr(e,u?D+1:0,u?g:D)}function ph(e,i){var a=e;return a instanceof Ye&&(a=a.value()),ho(i,function(u,g){return g.func.apply(g.thisArg,_i([u],g.args))},a)}function Lo(e,i,a){var u=e.length;if(u<2)return u?wi(e[0]):[];for(var g=-1,D=V(u);++g<u;)for(var A=e[g],U=-1;++U<u;)U!=g&&(D[g]=Mn(D[g]||A,e[U],i,a));return wi(Wt(D,1),i,a)}function gh(e,i,a){for(var u=-1,g=e.length,D=i.length,A={};++u<g;){var U=u<D?i[u]:r;a(A,e[u],U)}return A}function Mo(e){return Pt(e)?e:[]}function jo(e){return typeof e=="function"?e:pr}function Ei(e,i){return Ne(e)?e:Go(e,i)?[e]:Kh(it(e))}var n0=Ke;function Di(e,i,a){var u=e.length;return a=a===r?u:a,!i&&a>=u?e:Pr(e,i,a)}var yh=Vp||function(e){return Xe.clearTimeout(e)};function _h(e,i){if(i)return e.slice();var a=e.length,u=Mu?Mu(a):new e.constructor(a);return e.copy(u),u}function qo(e){var i=new e.constructor(e.byteLength);return new Bs(i).set(new Bs(e)),i}function s0(e,i){var a=i?qo(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.byteLength)}function a0(e){var i=new e.constructor(e.source,Sr.exec(e));return i.lastIndex=e.lastIndex,i}function o0(e){return $n?ut($n.call(e)):{}}function vh(e,i){var a=i?qo(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.length)}function mh(e,i){if(e!==i){var a=e!==r,u=e===null,g=e===e,D=br(e),A=i!==r,U=i===null,q=i===i,Z=br(i);if(!U&&!Z&&!D&&e>i||D&&A&&q&&!U&&!Z||u&&A&&q||!a&&q||!g)return 1;if(!u&&!D&&!Z&&e<i||Z&&a&&g&&!u&&!D||U&&a&&g||!A&&g||!q)return-1}return 0}function c0(e,i,a){for(var u=-1,g=e.criteria,D=i.criteria,A=g.length,U=a.length;++u<A;){var q=mh(g[u],D[u]);if(q){if(u>=U)return q;var Z=a[u];return q*(Z=="desc"?-1:1)}}return e.index-i.index}function bh(e,i,a,u){for(var g=-1,D=e.length,A=a.length,U=-1,q=i.length,Z=zt(D-A,0),ee=V(q+Z),ne=!u;++U<q;)ee[U]=i[U];for(;++g<A;)(ne||g<D)&&(ee[a[g]]=e[g]);for(;Z--;)ee[U++]=e[g++];return ee}function wh(e,i,a,u){for(var g=-1,D=e.length,A=-1,U=a.length,q=-1,Z=i.length,ee=zt(D-U,0),ne=V(ee+Z),ue=!u;++g<ee;)ne[g]=e[g];for(var ye=g;++q<Z;)ne[ye+q]=i[q];for(;++A<U;)(ue||g<D)&&(ne[ye+a[A]]=e[g++]);return ne}function lr(e,i){var a=-1,u=e.length;for(i||(i=V(u));++a<u;)i[a]=e[a];return i}function Yr(e,i,a,u){var g=!a;a||(a={});for(var D=-1,A=i.length;++D<A;){var U=i[D],q=u?u(a[U],e[U],U,a,e):r;q===r&&(q=e[U]),g?ai(a,U,q):Ln(a,U,q)}return a}function u0(e,i){return Yr(e,Wo(e),i)}function h0(e,i){return Yr(e,Rh(e),i)}function ra(e,i){return function(a,u){var g=Ne(a)?gp:Ng,D=i?i():{};return g(a,e,me(u,2),D)}}function yn(e){return Ke(function(i,a){var u=-1,g=a.length,D=g>1?a[g-1]:r,A=g>2?a[2]:r;for(D=e.length>3&&typeof D=="function"?(g--,D):r,A&&ir(a[0],a[1],A)&&(D=g<3?r:D,g=1),i=ut(i);++u<g;){var U=a[u];U&&e(i,U,u,D)}return i})}function Eh(e,i){return function(a,u){if(a==null)return a;if(!fr(a))return e(a,u);for(var g=a.length,D=i?g:-1,A=ut(a);(i?D--:++D<g)&&u(A[D],D,A)!==!1;);return a}}function Dh(e){return function(i,a,u){for(var g=-1,D=ut(i),A=u(i),U=A.length;U--;){var q=A[e?U:++g];if(a(D[q],q,D)===!1)break}return i}}function l0(e,i,a){var u=i&L,g=zn(e);function D(){var A=this&&this!==Xe&&this instanceof D?g:e;return A.apply(u?a:this,arguments)}return D}function Sh(e){return function(i){i=it(i);var a=un(i)?jr(i):r,u=a?a[0]:i.charAt(0),g=a?Di(a,1).join(""):i.slice(1);return u[e]()+g}}function _n(e){return function(i){return ho(El(wl(i).replace(Cn,"")),e,"")}}function zn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var a=gn(e.prototype),u=e.apply(a,i);return mt(u)?u:a}}function f0(e,i,a){var u=zn(e);function g(){for(var D=arguments.length,A=V(D),U=D,q=vn(g);U--;)A[U]=arguments[U];var Z=D<3&&A[0]!==q&&A[D-1]!==q?[]:vi(A,q);if(D-=Z.length,D<a)return Ch(e,i,ia,g.placeholder,r,A,Z,r,r,a-D);var ee=this&&this!==Xe&&this instanceof g?u:e;return Ht(ee,this,A)}return g}function Ih(e){return function(i,a,u){var g=ut(i);if(!fr(i)){var D=me(a,3);i=Kt(i),a=function(U){return D(g[U],U,g)}}var A=e(i,a,u);return A>-1?g[D?i[A]:A]:r}}function xh(e){return ci(function(i){var a=i.length,u=a,g=Ar.prototype.thru;for(e&&i.reverse();u--;){var D=i[u];if(typeof D!="function")throw new Or(m);if(g&&!A&&oa(D)=="wrapper")var A=new Ar([],!0)}for(u=A?u:a;++u<a;){D=i[u];var U=oa(D),q=U=="wrapper"?Vo(D):r;q&&Yo(q[0])&&q[1]==(c|b|v|_)&&!q[4].length&&q[9]==1?A=A[oa(q[0])].apply(A,q[3]):A=D.length==1&&Yo(D)?A[U]():A.thru(D)}return function(){var Z=arguments,ee=Z[0];if(A&&Z.length==1&&Ne(ee))return A.plant(ee).value();for(var ne=0,ue=a?i[ne].apply(this,Z):ee;++ne<a;)ue=i[ne].call(this,ue);return ue}})}function ia(e,i,a,u,g,D,A,U,q,Z){var ee=i&c,ne=i&L,ue=i&Q,ye=i&(b|y),Ee=i&K,Be=ue?r:zn(e);function De(){for(var We=arguments.length,Qe=V(We),wr=We;wr--;)Qe[wr]=arguments[wr];if(ye)var nr=vn(De),Er=Sp(Qe,nr);if(u&&(Qe=bh(Qe,u,g,ye)),D&&(Qe=wh(Qe,D,A,ye)),We-=Er,ye&&We<Z){var Tt=vi(Qe,nr);return Ch(e,i,ia,De.placeholder,a,Qe,Tt,U,q,Z-We)}var zr=ne?a:this,fi=ue?zr[e]:e;return We=Qe.length,U?Qe=N0(Qe,U):Ee&&We>1&&Qe.reverse(),ee&&q<We&&(Qe.length=q),this&&this!==Xe&&this instanceof De&&(fi=Be||zn(fi)),fi.apply(zr,Qe)}return De}function Oh(e,i){return function(a,u){return qg(a,e,i(u),{})}}function na(e,i){return function(a,u){var g;if(a===r&&u===r)return i;if(a!==r&&(g=a),u!==r){if(g===r)return u;typeof a=="string"||typeof u=="string"?(a=mr(a),u=mr(u)):(a=fh(a),u=fh(u)),g=e(a,u)}return g}}function Bo(e){return ci(function(i){return i=_t(i,vr(me())),Ke(function(a){var u=this;return e(i,function(g){return Ht(g,u,a)})})})}function sa(e,i){i=i===r?" ":mr(i);var a=i.length;if(a<2)return a?Ro(i,e):i;var u=Ro(i,Vs(e/hn(i)));return un(i)?Di(jr(u),0,e).join(""):u.slice(0,e)}function d0(e,i,a,u){var g=i&L,D=zn(e);function A(){for(var U=-1,q=arguments.length,Z=-1,ee=u.length,ne=V(ee+q),ue=this&&this!==Xe&&this instanceof A?D:e;++Z<ee;)ne[Z]=u[Z];for(;q--;)ne[Z++]=arguments[++U];return Ht(ue,g?a:this,ne)}return A}function Ah(e){return function(i,a,u){return u&&typeof u!="number"&&ir(i,a,u)&&(a=u=r),i=li(i),a===r?(a=i,i=0):a=li(a),u=u===r?i<a?1:-1:li(u),Qg(i,a,u,e)}}function aa(e){return function(i,a){return typeof i=="string"&&typeof a=="string"||(i=Nr(i),a=Nr(a)),e(i,a)}}function Ch(e,i,a,u,g,D,A,U,q,Z){var ee=i&b,ne=ee?A:r,ue=ee?r:A,ye=ee?D:r,Ee=ee?r:D;i|=ee?v:p,i&=~(ee?p:v),i&d||(i&=~(L|Q));var Be=[e,i,g,ye,ne,Ee,ue,U,q,Z],De=a.apply(r,Be);return Yo(e)&&Bh(De,Be),De.placeholder=u,zh(De,e,i)}function zo(e){var i=Bt[e];return function(a,u){if(a=Nr(a),u=u==null?0:Jt(Me(u),292),u&&zu(a)){var g=(it(a)+"e").split("e"),D=i(g[0]+"e"+(+g[1]+u));return g=(it(D)+"e").split("e"),+(g[0]+"e"+(+g[1]-u))}return i(a)}}var p0=dn&&1/Fs(new dn([,-0]))[1]==X?function(e){return new dn(e)}:hc;function Ph(e){return function(i){var a=Xt(i);return a==Ie?vo(i):a==xe?Tp(i):Dp(i,e(i))}}function oi(e,i,a,u,g,D,A,U){var q=i&Q;if(!q&&typeof e!="function")throw new Or(m);var Z=u?u.length:0;if(Z||(i&=~(v|p),u=g=r),A=A===r?A:zt(Me(A),0),U=U===r?U:Me(U),Z-=g?g.length:0,i&p){var ee=u,ne=g;u=g=r}var ue=q?r:Vo(e),ye=[e,i,a,u,g,ee,ne,D,A,U];if(ue&&C0(ye,ue),e=ye[0],i=ye[1],a=ye[2],u=ye[3],g=ye[4],U=ye[9]=ye[9]===r?q?0:e.length:zt(ye[9]-Z,0),!U&&i&(b|y)&&(i&=~(b|y)),!i||i==L)var Ee=l0(e,i,a);else i==b||i==y?Ee=f0(e,i,U):(i==v||i==(L|v))&&!g.length?Ee=d0(e,i,a,u):Ee=ia.apply(r,ye);var Be=ue?hh:Bh;return zh(Be(Ee,ye),e,i)}function Th(e,i,a,u){return e===r||Br(e,fn[a])&&!nt.call(u,a)?i:e}function Nh(e,i,a,u,g,D){return mt(e)&&mt(i)&&(D.set(i,e),Zs(e,i,r,Nh,D),D.delete(i)),e}function g0(e){return Vn(e)?r:e}function Uh(e,i,a,u,g,D){var A=a&N,U=e.length,q=i.length;if(U!=q&&!(A&&q>U))return!1;var Z=D.get(e),ee=D.get(i);if(Z&&ee)return Z==i&&ee==e;var ne=-1,ue=!0,ye=a&z?new ji:r;for(D.set(e,i),D.set(i,e);++ne<U;){var Ee=e[ne],Be=i[ne];if(u)var De=A?u(Be,Ee,ne,i,e,D):u(Ee,Be,ne,e,i,D);if(De!==r){if(De)continue;ue=!1;break}if(ye){if(!lo(i,function(We,Qe){if(!Tn(ye,Qe)&&(Ee===We||g(Ee,We,a,u,D)))return ye.push(Qe)})){ue=!1;break}}else if(!(Ee===Be||g(Ee,Be,a,u,D))){ue=!1;break}}return D.delete(e),D.delete(i),ue}function y0(e,i,a,u,g,D,A){switch(a){case Ce:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Se:return!(e.byteLength!=i.byteLength||!D(new Bs(e),new Bs(i)));case B:case F:case ze:return Br(+e,+i);case T:return e.name==i.name&&e.message==i.message;case je:case Ue:return e==i+"";case Ie:var U=vo;case xe:var q=u&N;if(U||(U=Fs),e.size!=i.size&&!q)return!1;var Z=A.get(e);if(Z)return Z==i;u|=z,A.set(e,i);var ee=Uh(U(e),U(i),u,g,D,A);return A.delete(e),ee;case Re:if($n)return $n.call(e)==$n.call(i)}return!1}function _0(e,i,a,u,g,D){var A=a&N,U=Ho(e),q=U.length,Z=Ho(i),ee=Z.length;if(q!=ee&&!A)return!1;for(var ne=q;ne--;){var ue=U[ne];if(!(A?ue in i:nt.call(i,ue)))return!1}var ye=D.get(e),Ee=D.get(i);if(ye&&Ee)return ye==i&&Ee==e;var Be=!0;D.set(e,i),D.set(i,e);for(var De=A;++ne<q;){ue=U[ne];var We=e[ue],Qe=i[ue];if(u)var wr=A?u(Qe,We,ue,i,e,D):u(We,Qe,ue,e,i,D);if(!(wr===r?We===Qe||g(We,Qe,a,u,D):wr)){Be=!1;break}De||(De=ue=="constructor")}if(Be&&!De){var nr=e.constructor,Er=i.constructor;nr!=Er&&"constructor"in e&&"constructor"in i&&!(typeof nr=="function"&&nr instanceof nr&&typeof Er=="function"&&Er instanceof Er)&&(Be=!1)}return D.delete(e),D.delete(i),Be}function ci(e){return Xo(jh(e,r,Gh),e+"")}function Ho(e){return Zu(e,Kt,Wo)}function Ko(e){return Zu(e,dr,Rh)}var Vo=Ws?function(e){return Ws.get(e)}:hc;function oa(e){for(var i=e.name+"",a=pn[i],u=nt.call(pn,i)?a.length:0;u--;){var g=a[u],D=g.func;if(D==null||D==e)return g.name}return i}function vn(e){var i=nt.call(E,"placeholder")?E:e;return i.placeholder}function me(){var e=E.iteratee||cc;return e=e===cc?rh:e,arguments.length?e(arguments[0],arguments[1]):e}function ca(e,i){var a=e.__data__;return I0(i)?a[typeof i=="string"?"string":"hash"]:a.map}function ko(e){for(var i=Kt(e),a=i.length;a--;){var u=i[a],g=e[u];i[a]=[u,g,Lh(g)]}return i}function zi(e,i){var a=Ap(e,i);return th(a)?a:r}function v0(e){var i=nt.call(e,Li),a=e[Li];try{e[Li]=r;var u=!0}catch{}var g=js.call(e);return u&&(i?e[Li]=a:delete e[Li]),g}var Wo=bo?function(e){return e==null?[]:(e=ut(e),yi(bo(e),function(i){return qu.call(e,i)}))}:lc,Rh=bo?function(e){for(var i=[];e;)_i(i,Wo(e)),e=zs(e);return i}:lc,Xt=rr;(wo&&Xt(new wo(new ArrayBuffer(1)))!=Ce||Un&&Xt(new Un)!=Ie||Eo&&Xt(Eo.resolve())!=dt||dn&&Xt(new dn)!=xe||Rn&&Xt(new Rn)!=Ae)&&(Xt=function(e){var i=rr(e),a=i==Le?e.constructor:r,u=a?Hi(a):"";if(u)switch(u){case eg:return Ce;case tg:return Ie;case rg:return dt;case ig:return xe;case ng:return Ae}return i});function m0(e,i,a){for(var u=-1,g=a.length;++u<g;){var D=a[u],A=D.size;switch(D.type){case"drop":e+=A;break;case"dropRight":i-=A;break;case"take":i=Jt(i,e+A);break;case"takeRight":e=zt(e,i-A);break}}return{start:e,end:i}}function b0(e){var i=e.match(ht);return i?i[1].split($t):[]}function Fh(e,i,a){i=Ei(i,e);for(var u=-1,g=i.length,D=!1;++u<g;){var A=Jr(i[u]);if(!(D=e!=null&&a(e,A)))break;e=e[A]}return D||++u!=g?D:(g=e==null?0:e.length,!!g&&ga(g)&&ui(A,g)&&(Ne(e)||Ki(e)))}function w0(e){var i=e.length,a=new e.constructor(i);return i&&typeof e[0]=="string"&&nt.call(e,"index")&&(a.index=e.index,a.input=e.input),a}function $h(e){return typeof e.constructor=="function"&&!Hn(e)?gn(zs(e)):{}}function E0(e,i,a){var u=e.constructor;switch(i){case Se:return qo(e);case B:case F:return new u(+e);case Ce:return s0(e,a);case He:case Oe:case ke:case Ge:case et:case tt:case Je:case Zt:case ur:return vh(e,a);case Ie:return new u;case ze:case Ue:return new u(e);case je:return a0(e);case xe:return new u;case Re:return o0(e)}}function D0(e,i){var a=i.length;if(!a)return e;var u=a-1;return i[u]=(a>1?"& ":"")+i[u],i=i.join(a>2?", ":" "),e.replace(It,`{
/* [wrapped with `+i+`] */
`)}function S0(e){return Ne(e)||Ki(e)||!!(Bu&&e&&e[Bu])}function ui(e,i){var a=typeof e;return i=i??k,!!i&&(a=="number"||a!="symbol"&&Ya.test(e))&&e>-1&&e%1==0&&e<i}function ir(e,i,a){if(!mt(a))return!1;var u=typeof i;return(u=="number"?fr(a)&&ui(i,a.length):u=="string"&&i in a)?Br(a[i],e):!1}function Go(e,i){if(Ne(e))return!1;var a=typeof e;return a=="number"||a=="symbol"||a=="boolean"||e==null||br(e)?!0:Ut.test(e)||!yt.test(e)||i!=null&&e in ut(i)}function I0(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function Yo(e){var i=oa(e),a=E[i];if(typeof a!="function"||!(i in Ye.prototype))return!1;if(e===a)return!0;var u=Vo(a);return!!u&&e===u[0]}function x0(e){return!!Lu&&Lu in e}var O0=Ls?hi:fc;function Hn(e){var i=e&&e.constructor,a=typeof i=="function"&&i.prototype||fn;return e===a}function Lh(e){return e===e&&!mt(e)}function Mh(e,i){return function(a){return a==null?!1:a[e]===i&&(i!==r||e in ut(a))}}function A0(e){var i=da(e,function(u){return a.size===O&&a.clear(),u}),a=i.cache;return i}function C0(e,i){var a=e[1],u=i[1],g=a|u,D=g<(L|Q|c),A=u==c&&a==b||u==c&&a==_&&e[7].length<=i[8]||u==(c|_)&&i[7].length<=i[8]&&a==b;if(!(D||A))return e;u&L&&(e[2]=i[2],g|=a&L?0:d);var U=i[3];if(U){var q=e[3];e[3]=q?bh(q,U,i[4]):U,e[4]=q?vi(e[3],I):i[4]}return U=i[5],U&&(q=e[5],e[5]=q?wh(q,U,i[6]):U,e[6]=q?vi(e[5],I):i[6]),U=i[7],U&&(e[7]=U),u&c&&(e[8]=e[8]==null?i[8]:Jt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=g,e}function P0(e){var i=[];if(e!=null)for(var a in ut(e))i.push(a);return i}function T0(e){return js.call(e)}function jh(e,i,a){return i=zt(i===r?e.length-1:i,0),function(){for(var u=arguments,g=-1,D=zt(u.length-i,0),A=V(D);++g<D;)A[g]=u[i+g];g=-1;for(var U=V(i+1);++g<i;)U[g]=u[g];return U[i]=a(A),Ht(e,this,U)}}function qh(e,i){return i.length<2?e:Bi(e,Pr(i,0,-1))}function N0(e,i){for(var a=e.length,u=Jt(i.length,a),g=lr(e);u--;){var D=i[u];e[u]=ui(D,a)?g[D]:r}return e}function Jo(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var Bh=Hh(hh),Kn=Wp||function(e,i){return Xe.setTimeout(e,i)},Xo=Hh(t0);function zh(e,i,a){var u=i+"";return Xo(e,D0(u,U0(b0(u),a)))}function Hh(e){var i=0,a=0;return function(){var u=Xp(),g=de-(u-a);if(a=u,g>0){if(++i>=ce)return arguments[0]}else i=0;return e.apply(r,arguments)}}function ua(e,i){var a=-1,u=e.length,g=u-1;for(i=i===r?u:i;++a<i;){var D=Uo(a,g),A=e[D];e[D]=e[a],e[a]=A}return e.length=i,e}var Kh=A0(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Rt,function(a,u,g,D){i.push(g?D.replace(Ha,"$1"):u||a)}),i});function Jr(e){if(typeof e=="string"||br(e))return e;var i=e+"";return i=="0"&&1/e==-X?"-0":i}function Hi(e){if(e!=null){try{return Ms.call(e)}catch{}try{return e+""}catch{}}return""}function U0(e,i){return xr(we,function(a){var u="_."+a[0];i&a[1]&&!Us(e,u)&&e.push(u)}),e.sort()}function Vh(e){if(e instanceof Ye)return e.clone();var i=new Ar(e.__wrapped__,e.__chain__);return i.__actions__=lr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function R0(e,i,a){(a?ir(e,i,a):i===r)?i=1:i=zt(Me(i),0);var u=e==null?0:e.length;if(!u||i<1)return[];for(var g=0,D=0,A=V(Vs(u/i));g<u;)A[D++]=Pr(e,g,g+=i);return A}function F0(e){for(var i=-1,a=e==null?0:e.length,u=0,g=[];++i<a;){var D=e[i];D&&(g[u++]=D)}return g}function $0(){var e=arguments.length;if(!e)return[];for(var i=V(e-1),a=arguments[0],u=e;u--;)i[u-1]=arguments[u];return _i(Ne(a)?lr(a):[a],Wt(i,1))}var L0=Ke(function(e,i){return Pt(e)?Mn(e,Wt(i,1,Pt,!0)):[]}),M0=Ke(function(e,i){var a=Tr(i);return Pt(a)&&(a=r),Pt(e)?Mn(e,Wt(i,1,Pt,!0),me(a,2)):[]}),j0=Ke(function(e,i){var a=Tr(i);return Pt(a)&&(a=r),Pt(e)?Mn(e,Wt(i,1,Pt,!0),r,a):[]});function q0(e,i,a){var u=e==null?0:e.length;return u?(i=a||i===r?1:Me(i),Pr(e,i<0?0:i,u)):[]}function B0(e,i,a){var u=e==null?0:e.length;return u?(i=a||i===r?1:Me(i),i=u-i,Pr(e,0,i<0?0:i)):[]}function z0(e,i){return e&&e.length?ta(e,me(i,3),!0,!0):[]}function H0(e,i){return e&&e.length?ta(e,me(i,3),!0):[]}function K0(e,i,a,u){var g=e==null?0:e.length;return g?(a&&typeof a!="number"&&ir(e,i,a)&&(a=0,u=g),$g(e,i,a,u)):[]}function kh(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var g=a==null?0:Me(a);return g<0&&(g=zt(u+g,0)),Rs(e,me(i,3),g)}function Wh(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var g=u-1;return a!==r&&(g=Me(a),g=a<0?zt(u+g,0):Jt(g,u-1)),Rs(e,me(i,3),g,!0)}function Gh(e){var i=e==null?0:e.length;return i?Wt(e,1):[]}function V0(e){var i=e==null?0:e.length;return i?Wt(e,X):[]}function k0(e,i){var a=e==null?0:e.length;return a?(i=i===r?1:Me(i),Wt(e,i)):[]}function W0(e){for(var i=-1,a=e==null?0:e.length,u={};++i<a;){var g=e[i];u[g[0]]=g[1]}return u}function Yh(e){return e&&e.length?e[0]:r}function G0(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var g=a==null?0:Me(a);return g<0&&(g=zt(u+g,0)),cn(e,i,g)}function Y0(e){var i=e==null?0:e.length;return i?Pr(e,0,-1):[]}var J0=Ke(function(e){var i=_t(e,Mo);return i.length&&i[0]===e[0]?Ao(i):[]}),X0=Ke(function(e){var i=Tr(e),a=_t(e,Mo);return i===Tr(a)?i=r:a.pop(),a.length&&a[0]===e[0]?Ao(a,me(i,2)):[]}),Q0=Ke(function(e){var i=Tr(e),a=_t(e,Mo);return i=typeof i=="function"?i:r,i&&a.pop(),a.length&&a[0]===e[0]?Ao(a,r,i):[]});function Z0(e,i){return e==null?"":Yp.call(e,i)}function Tr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function e1(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var g=u;return a!==r&&(g=Me(a),g=g<0?zt(u+g,0):Jt(g,u-1)),i===i?Up(e,i,g):Rs(e,Cu,g,!0)}function t1(e,i){return e&&e.length?ah(e,Me(i)):r}var r1=Ke(Jh);function Jh(e,i){return e&&e.length&&i&&i.length?No(e,i):e}function i1(e,i,a){return e&&e.length&&i&&i.length?No(e,i,me(a,2)):e}function n1(e,i,a){return e&&e.length&&i&&i.length?No(e,i,r,a):e}var s1=ci(function(e,i){var a=e==null?0:e.length,u=So(e,i);return uh(e,_t(i,function(g){return ui(g,a)?+g:g}).sort(mh)),u});function a1(e,i){var a=[];if(!(e&&e.length))return a;var u=-1,g=[],D=e.length;for(i=me(i,3);++u<D;){var A=e[u];i(A,u,e)&&(a.push(A),g.push(u))}return uh(e,g),a}function Qo(e){return e==null?e:Zp.call(e)}function o1(e,i,a){var u=e==null?0:e.length;return u?(a&&typeof a!="number"&&ir(e,i,a)?(i=0,a=u):(i=i==null?0:Me(i),a=a===r?u:Me(a)),Pr(e,i,a)):[]}function c1(e,i){return ea(e,i)}function u1(e,i,a){return Fo(e,i,me(a,2))}function h1(e,i){var a=e==null?0:e.length;if(a){var u=ea(e,i);if(u<a&&Br(e[u],i))return u}return-1}function l1(e,i){return ea(e,i,!0)}function f1(e,i,a){return Fo(e,i,me(a,2),!0)}function d1(e,i){var a=e==null?0:e.length;if(a){var u=ea(e,i,!0)-1;if(Br(e[u],i))return u}return-1}function p1(e){return e&&e.length?lh(e):[]}function g1(e,i){return e&&e.length?lh(e,me(i,2)):[]}function y1(e){var i=e==null?0:e.length;return i?Pr(e,1,i):[]}function _1(e,i,a){return e&&e.length?(i=a||i===r?1:Me(i),Pr(e,0,i<0?0:i)):[]}function v1(e,i,a){var u=e==null?0:e.length;return u?(i=a||i===r?1:Me(i),i=u-i,Pr(e,i<0?0:i,u)):[]}function m1(e,i){return e&&e.length?ta(e,me(i,3),!1,!0):[]}function b1(e,i){return e&&e.length?ta(e,me(i,3)):[]}var w1=Ke(function(e){return wi(Wt(e,1,Pt,!0))}),E1=Ke(function(e){var i=Tr(e);return Pt(i)&&(i=r),wi(Wt(e,1,Pt,!0),me(i,2))}),D1=Ke(function(e){var i=Tr(e);return i=typeof i=="function"?i:r,wi(Wt(e,1,Pt,!0),r,i)});function S1(e){return e&&e.length?wi(e):[]}function I1(e,i){return e&&e.length?wi(e,me(i,2)):[]}function x1(e,i){return i=typeof i=="function"?i:r,e&&e.length?wi(e,r,i):[]}function Zo(e){if(!(e&&e.length))return[];var i=0;return e=yi(e,function(a){if(Pt(a))return i=zt(a.length,i),!0}),yo(i,function(a){return _t(e,fo(a))})}function Xh(e,i){if(!(e&&e.length))return[];var a=Zo(e);return i==null?a:_t(a,function(u){return Ht(i,r,u)})}var O1=Ke(function(e,i){return Pt(e)?Mn(e,i):[]}),A1=Ke(function(e){return Lo(yi(e,Pt))}),C1=Ke(function(e){var i=Tr(e);return Pt(i)&&(i=r),Lo(yi(e,Pt),me(i,2))}),P1=Ke(function(e){var i=Tr(e);return i=typeof i=="function"?i:r,Lo(yi(e,Pt),r,i)}),T1=Ke(Zo);function N1(e,i){return gh(e||[],i||[],Ln)}function U1(e,i){return gh(e||[],i||[],Bn)}var R1=Ke(function(e){var i=e.length,a=i>1?e[i-1]:r;return a=typeof a=="function"?(e.pop(),a):r,Xh(e,a)});function Qh(e){var i=E(e);return i.__chain__=!0,i}function F1(e,i){return i(e),e}function ha(e,i){return i(e)}var $1=ci(function(e){var i=e.length,a=i?e[0]:0,u=this.__wrapped__,g=function(D){return So(D,e)};return i>1||this.__actions__.length||!(u instanceof Ye)||!ui(a)?this.thru(g):(u=u.slice(a,+a+(i?1:0)),u.__actions__.push({func:ha,args:[g],thisArg:r}),new Ar(u,this.__chain__).thru(function(D){return i&&!D.length&&D.push(r),D}))});function L1(){return Qh(this)}function M1(){return new Ar(this.value(),this.__chain__)}function j1(){this.__values__===r&&(this.__values__=fl(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function q1(){return this}function B1(e){for(var i,a=this;a instanceof Ys;){var u=Vh(a);u.__index__=0,u.__values__=r,i?g.__wrapped__=u:i=u;var g=u;a=a.__wrapped__}return g.__wrapped__=e,i}function z1(){var e=this.__wrapped__;if(e instanceof Ye){var i=e;return this.__actions__.length&&(i=new Ye(this)),i=i.reverse(),i.__actions__.push({func:ha,args:[Qo],thisArg:r}),new Ar(i,this.__chain__)}return this.thru(Qo)}function H1(){return ph(this.__wrapped__,this.__actions__)}var K1=ra(function(e,i,a){nt.call(e,a)?++e[a]:ai(e,a,1)});function V1(e,i,a){var u=Ne(e)?Ou:Fg;return a&&ir(e,i,a)&&(i=r),u(e,me(i,3))}function k1(e,i){var a=Ne(e)?yi:Xu;return a(e,me(i,3))}var W1=Ih(kh),G1=Ih(Wh);function Y1(e,i){return Wt(la(e,i),1)}function J1(e,i){return Wt(la(e,i),X)}function X1(e,i,a){return a=a===r?1:Me(a),Wt(la(e,i),a)}function Zh(e,i){var a=Ne(e)?xr:bi;return a(e,me(i,3))}function el(e,i){var a=Ne(e)?yp:Ju;return a(e,me(i,3))}var Q1=ra(function(e,i,a){nt.call(e,a)?e[a].push(i):ai(e,a,[i])});function Z1(e,i,a,u){e=fr(e)?e:bn(e),a=a&&!u?Me(a):0;var g=e.length;return a<0&&(a=zt(g+a,0)),ya(e)?a<=g&&e.indexOf(i,a)>-1:!!g&&cn(e,i,a)>-1}var ey=Ke(function(e,i,a){var u=-1,g=typeof i=="function",D=fr(e)?V(e.length):[];return bi(e,function(A){D[++u]=g?Ht(i,A,a):jn(A,i,a)}),D}),ty=ra(function(e,i,a){ai(e,a,i)});function la(e,i){var a=Ne(e)?_t:ih;return a(e,me(i,3))}function ry(e,i,a,u){return e==null?[]:(Ne(i)||(i=i==null?[]:[i]),a=u?r:a,Ne(a)||(a=a==null?[]:[a]),oh(e,i,a))}var iy=ra(function(e,i,a){e[a?0:1].push(i)},function(){return[[],[]]});function ny(e,i,a){var u=Ne(e)?ho:Tu,g=arguments.length<3;return u(e,me(i,4),a,g,bi)}function sy(e,i,a){var u=Ne(e)?_p:Tu,g=arguments.length<3;return u(e,me(i,4),a,g,Ju)}function ay(e,i){var a=Ne(e)?yi:Xu;return a(e,pa(me(i,3)))}function oy(e){var i=Ne(e)?ku:Zg;return i(e)}function cy(e,i,a){(a?ir(e,i,a):i===r)?i=1:i=Me(i);var u=Ne(e)?Pg:e0;return u(e,i)}function uy(e){var i=Ne(e)?Tg:r0;return i(e)}function hy(e){if(e==null)return 0;if(fr(e))return ya(e)?hn(e):e.length;var i=Xt(e);return i==Ie||i==xe?e.size:Po(e).length}function ly(e,i,a){var u=Ne(e)?lo:i0;return a&&ir(e,i,a)&&(i=r),u(e,me(i,3))}var fy=Ke(function(e,i){if(e==null)return[];var a=i.length;return a>1&&ir(e,i[0],i[1])?i=[]:a>2&&ir(i[0],i[1],i[2])&&(i=[i[0]]),oh(e,Wt(i,1),[])}),fa=kp||function(){return Xe.Date.now()};function dy(e,i){if(typeof i!="function")throw new Or(m);return e=Me(e),function(){if(--e<1)return i.apply(this,arguments)}}function tl(e,i,a){return i=a?r:i,i=e&&i==null?e.length:i,oi(e,c,r,r,r,r,i)}function rl(e,i){var a;if(typeof i!="function")throw new Or(m);return e=Me(e),function(){return--e>0&&(a=i.apply(this,arguments)),e<=1&&(i=r),a}}var ec=Ke(function(e,i,a){var u=L;if(a.length){var g=vi(a,vn(ec));u|=v}return oi(e,u,i,a,g)}),il=Ke(function(e,i,a){var u=L|Q;if(a.length){var g=vi(a,vn(il));u|=v}return oi(i,u,e,a,g)});function nl(e,i,a){i=a?r:i;var u=oi(e,b,r,r,r,r,r,i);return u.placeholder=nl.placeholder,u}function sl(e,i,a){i=a?r:i;var u=oi(e,y,r,r,r,r,r,i);return u.placeholder=sl.placeholder,u}function al(e,i,a){var u,g,D,A,U,q,Z=0,ee=!1,ne=!1,ue=!0;if(typeof e!="function")throw new Or(m);i=Nr(i)||0,mt(a)&&(ee=!!a.leading,ne="maxWait"in a,D=ne?zt(Nr(a.maxWait)||0,i):D,ue="trailing"in a?!!a.trailing:ue);function ye(Tt){var zr=u,fi=g;return u=g=r,Z=Tt,A=e.apply(fi,zr),A}function Ee(Tt){return Z=Tt,U=Kn(We,i),ee?ye(Tt):A}function Be(Tt){var zr=Tt-q,fi=Tt-Z,Il=i-zr;return ne?Jt(Il,D-fi):Il}function De(Tt){var zr=Tt-q,fi=Tt-Z;return q===r||zr>=i||zr<0||ne&&fi>=D}function We(){var Tt=fa();if(De(Tt))return Qe(Tt);U=Kn(We,Be(Tt))}function Qe(Tt){return U=r,ue&&u?ye(Tt):(u=g=r,A)}function wr(){U!==r&&yh(U),Z=0,u=q=g=U=r}function nr(){return U===r?A:Qe(fa())}function Er(){var Tt=fa(),zr=De(Tt);if(u=arguments,g=this,q=Tt,zr){if(U===r)return Ee(q);if(ne)return yh(U),U=Kn(We,i),ye(q)}return U===r&&(U=Kn(We,i)),A}return Er.cancel=wr,Er.flush=nr,Er}var py=Ke(function(e,i){return Yu(e,1,i)}),gy=Ke(function(e,i,a){return Yu(e,Nr(i)||0,a)});function yy(e){return oi(e,K)}function da(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Or(m);var a=function(){var u=arguments,g=i?i.apply(this,u):u[0],D=a.cache;if(D.has(g))return D.get(g);var A=e.apply(this,u);return a.cache=D.set(g,A)||D,A};return a.cache=new(da.Cache||si),a}da.Cache=si;function pa(e){if(typeof e!="function")throw new Or(m);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function _y(e){return rl(2,e)}var vy=n0(function(e,i){i=i.length==1&&Ne(i[0])?_t(i[0],vr(me())):_t(Wt(i,1),vr(me()));var a=i.length;return Ke(function(u){for(var g=-1,D=Jt(u.length,a);++g<D;)u[g]=i[g].call(this,u[g]);return Ht(e,this,u)})}),tc=Ke(function(e,i){var a=vi(i,vn(tc));return oi(e,v,r,i,a)}),ol=Ke(function(e,i){var a=vi(i,vn(ol));return oi(e,p,r,i,a)}),my=ci(function(e,i){return oi(e,_,r,r,r,i)});function by(e,i){if(typeof e!="function")throw new Or(m);return i=i===r?i:Me(i),Ke(e,i)}function wy(e,i){if(typeof e!="function")throw new Or(m);return i=i==null?0:zt(Me(i),0),Ke(function(a){var u=a[i],g=Di(a,0,i);return u&&_i(g,u),Ht(e,this,g)})}function Ey(e,i,a){var u=!0,g=!0;if(typeof e!="function")throw new Or(m);return mt(a)&&(u="leading"in a?!!a.leading:u,g="trailing"in a?!!a.trailing:g),al(e,i,{leading:u,maxWait:i,trailing:g})}function Dy(e){return tl(e,1)}function Sy(e,i){return tc(jo(i),e)}function Iy(){if(!arguments.length)return[];var e=arguments[0];return Ne(e)?e:[e]}function xy(e){return Cr(e,R)}function Oy(e,i){return i=typeof i=="function"?i:r,Cr(e,R,i)}function Ay(e){return Cr(e,P|R)}function Cy(e,i){return i=typeof i=="function"?i:r,Cr(e,P|R,i)}function Py(e,i){return i==null||Gu(e,i,Kt(i))}function Br(e,i){return e===i||e!==e&&i!==i}var Ty=aa(Oo),Ny=aa(function(e,i){return e>=i}),Ki=eh(function(){return arguments}())?eh:function(e){return xt(e)&&nt.call(e,"callee")&&!qu.call(e,"callee")},Ne=V.isArray,Uy=tr?vr(tr):Bg;function fr(e){return e!=null&&ga(e.length)&&!hi(e)}function Pt(e){return xt(e)&&fr(e)}function Ry(e){return e===!0||e===!1||xt(e)&&rr(e)==B}var Si=Gp||fc,Fy=Mr?vr(Mr):zg;function $y(e){return xt(e)&&e.nodeType===1&&!Vn(e)}function Ly(e){if(e==null)return!0;if(fr(e)&&(Ne(e)||typeof e=="string"||typeof e.splice=="function"||Si(e)||mn(e)||Ki(e)))return!e.length;var i=Xt(e);if(i==Ie||i==xe)return!e.size;if(Hn(e))return!Po(e).length;for(var a in e)if(nt.call(e,a))return!1;return!0}function My(e,i){return qn(e,i)}function jy(e,i,a){a=typeof a=="function"?a:r;var u=a?a(e,i):r;return u===r?qn(e,i,r,a):!!u}function rc(e){if(!xt(e))return!1;var i=rr(e);return i==T||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!Vn(e)}function qy(e){return typeof e=="number"&&zu(e)}function hi(e){if(!mt(e))return!1;var i=rr(e);return i==oe||i==fe||i==H||i==pt}function cl(e){return typeof e=="number"&&e==Me(e)}function ga(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=k}function mt(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function xt(e){return e!=null&&typeof e=="object"}var ul=Ir?vr(Ir):Kg;function By(e,i){return e===i||Co(e,i,ko(i))}function zy(e,i,a){return a=typeof a=="function"?a:r,Co(e,i,ko(i),a)}function Hy(e){return hl(e)&&e!=+e}function Ky(e){if(O0(e))throw new Pe(l);return th(e)}function Vy(e){return e===null}function ky(e){return e==null}function hl(e){return typeof e=="number"||xt(e)&&rr(e)==ze}function Vn(e){if(!xt(e)||rr(e)!=Le)return!1;var i=zs(e);if(i===null)return!0;var a=nt.call(i,"constructor")&&i.constructor;return typeof a=="function"&&a instanceof a&&Ms.call(a)==zp}var ic=Wr?vr(Wr):Vg;function Wy(e){return cl(e)&&e>=-k&&e<=k}var ll=Pn?vr(Pn):kg;function ya(e){return typeof e=="string"||!Ne(e)&&xt(e)&&rr(e)==Ue}function br(e){return typeof e=="symbol"||xt(e)&&rr(e)==Re}var mn=$i?vr($i):Wg;function Gy(e){return e===r}function Yy(e){return xt(e)&&Xt(e)==Ae}function Jy(e){return xt(e)&&rr(e)==Fe}var Xy=aa(To),Qy=aa(function(e,i){return e<=i});function fl(e){if(!e)return[];if(fr(e))return ya(e)?jr(e):lr(e);if(Nn&&e[Nn])return Pp(e[Nn]());var i=Xt(e),a=i==Ie?vo:i==xe?Fs:bn;return a(e)}function li(e){if(!e)return e===0?e:0;if(e=Nr(e),e===X||e===-X){var i=e<0?-1:1;return i*W}return e===e?e:0}function Me(e){var i=li(e),a=i%1;return i===i?a?i-a:i:0}function dl(e){return e?qi(Me(e),0,ie):0}function Nr(e){if(typeof e=="number")return e;if(br(e))return J;if(mt(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=mt(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Nu(e);var a=ka.test(e);return a||Ga.test(e)?Te(e.slice(2),a?2:8):Va.test(e)?J:+e}function pl(e){return Yr(e,dr(e))}function Zy(e){return e?qi(Me(e),-k,k):e===0?e:0}function it(e){return e==null?"":mr(e)}var e_=yn(function(e,i){if(Hn(i)||fr(i)){Yr(i,Kt(i),e);return}for(var a in i)nt.call(i,a)&&Ln(e,a,i[a])}),gl=yn(function(e,i){Yr(i,dr(i),e)}),_a=yn(function(e,i,a,u){Yr(i,dr(i),e,u)}),t_=yn(function(e,i,a,u){Yr(i,Kt(i),e,u)}),r_=ci(So);function i_(e,i){var a=gn(e);return i==null?a:Wu(a,i)}var n_=Ke(function(e,i){e=ut(e);var a=-1,u=i.length,g=u>2?i[2]:r;for(g&&ir(i[0],i[1],g)&&(u=1);++a<u;)for(var D=i[a],A=dr(D),U=-1,q=A.length;++U<q;){var Z=A[U],ee=e[Z];(ee===r||Br(ee,fn[Z])&&!nt.call(e,Z))&&(e[Z]=D[Z])}return e}),s_=Ke(function(e){return e.push(r,Nh),Ht(yl,r,e)});function a_(e,i){return Au(e,me(i,3),Gr)}function o_(e,i){return Au(e,me(i,3),xo)}function c_(e,i){return e==null?e:Io(e,me(i,3),dr)}function u_(e,i){return e==null?e:Qu(e,me(i,3),dr)}function h_(e,i){return e&&Gr(e,me(i,3))}function l_(e,i){return e&&xo(e,me(i,3))}function f_(e){return e==null?[]:Qs(e,Kt(e))}function d_(e){return e==null?[]:Qs(e,dr(e))}function nc(e,i,a){var u=e==null?r:Bi(e,i);return u===r?a:u}function p_(e,i){return e!=null&&Fh(e,i,Lg)}function sc(e,i){return e!=null&&Fh(e,i,Mg)}var g_=Oh(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=js.call(i)),e[i]=a},oc(pr)),y_=Oh(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=js.call(i)),nt.call(e,i)?e[i].push(a):e[i]=[a]},me),__=Ke(jn);function Kt(e){return fr(e)?Vu(e):Po(e)}function dr(e){return fr(e)?Vu(e,!0):Gg(e)}function v_(e,i){var a={};return i=me(i,3),Gr(e,function(u,g,D){ai(a,i(u,g,D),u)}),a}function m_(e,i){var a={};return i=me(i,3),Gr(e,function(u,g,D){ai(a,g,i(u,g,D))}),a}var b_=yn(function(e,i,a){Zs(e,i,a)}),yl=yn(function(e,i,a,u){Zs(e,i,a,u)}),w_=ci(function(e,i){var a={};if(e==null)return a;var u=!1;i=_t(i,function(D){return D=Ei(D,e),u||(u=D.length>1),D}),Yr(e,Ko(e),a),u&&(a=Cr(a,P|$|R,g0));for(var g=i.length;g--;)$o(a,i[g]);return a});function E_(e,i){return _l(e,pa(me(i)))}var D_=ci(function(e,i){return e==null?{}:Jg(e,i)});function _l(e,i){if(e==null)return{};var a=_t(Ko(e),function(u){return[u]});return i=me(i),ch(e,a,function(u,g){return i(u,g[0])})}function S_(e,i,a){i=Ei(i,e);var u=-1,g=i.length;for(g||(g=1,e=r);++u<g;){var D=e==null?r:e[Jr(i[u])];D===r&&(u=g,D=a),e=hi(D)?D.call(e):D}return e}function I_(e,i,a){return e==null?e:Bn(e,i,a)}function x_(e,i,a,u){return u=typeof u=="function"?u:r,e==null?e:Bn(e,i,a,u)}var vl=Ph(Kt),ml=Ph(dr);function O_(e,i,a){var u=Ne(e),g=u||Si(e)||mn(e);if(i=me(i,4),a==null){var D=e&&e.constructor;g?a=u?new D:[]:mt(e)?a=hi(D)?gn(zs(e)):{}:a={}}return(g?xr:Gr)(e,function(A,U,q){return i(a,A,U,q)}),a}function A_(e,i){return e==null?!0:$o(e,i)}function C_(e,i,a){return e==null?e:dh(e,i,jo(a))}function P_(e,i,a,u){return u=typeof u=="function"?u:r,e==null?e:dh(e,i,jo(a),u)}function bn(e){return e==null?[]:_o(e,Kt(e))}function T_(e){return e==null?[]:_o(e,dr(e))}function N_(e,i,a){return a===r&&(a=i,i=r),a!==r&&(a=Nr(a),a=a===a?a:0),i!==r&&(i=Nr(i),i=i===i?i:0),qi(Nr(e),i,a)}function U_(e,i,a){return i=li(i),a===r?(a=i,i=0):a=li(a),e=Nr(e),jg(e,i,a)}function R_(e,i,a){if(a&&typeof a!="boolean"&&ir(e,i,a)&&(i=a=r),a===r&&(typeof i=="boolean"?(a=i,i=r):typeof e=="boolean"&&(a=e,e=r)),e===r&&i===r?(e=0,i=1):(e=li(e),i===r?(i=e,e=0):i=li(i)),e>i){var u=e;e=i,i=u}if(a||e%1||i%1){var g=Hu();return Jt(e+g*(i-e+ot("1e-"+((g+"").length-1))),i)}return Uo(e,i)}var F_=_n(function(e,i,a){return i=i.toLowerCase(),e+(a?bl(i):i)});function bl(e){return ac(it(e).toLowerCase())}function wl(e){return e=it(e),e&&e.replace(ri,Ip).replace(oo,"")}function $_(e,i,a){e=it(e),i=mr(i);var u=e.length;a=a===r?u:qi(Me(a),0,u);var g=a;return a-=i.length,a>=0&&e.slice(a,g)==i}function L_(e){return e=it(e),e&&gt.test(e)?e.replace(Ti,xp):e}function M_(e){return e=it(e),e&&Ft.test(e)?e.replace(Dt,"\\$&"):e}var j_=_n(function(e,i,a){return e+(a?"-":"")+i.toLowerCase()}),q_=_n(function(e,i,a){return e+(a?" ":"")+i.toLowerCase()}),B_=Sh("toLowerCase");function z_(e,i,a){e=it(e),i=Me(i);var u=i?hn(e):0;if(!i||u>=i)return e;var g=(i-u)/2;return sa(ks(g),a)+e+sa(Vs(g),a)}function H_(e,i,a){e=it(e),i=Me(i);var u=i?hn(e):0;return i&&u<i?e+sa(i-u,a):e}function K_(e,i,a){e=it(e),i=Me(i);var u=i?hn(e):0;return i&&u<i?sa(i-u,a)+e:e}function V_(e,i,a){return a||i==null?i=0:i&&(i=+i),Qp(it(e).replace(St,""),i||0)}function k_(e,i,a){return(a?ir(e,i,a):i===r)?i=1:i=Me(i),Ro(it(e),i)}function W_(){var e=arguments,i=it(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var G_=_n(function(e,i,a){return e+(a?"_":"")+i.toLowerCase()});function Y_(e,i,a){return a&&typeof a!="number"&&ir(e,i,a)&&(i=a=r),a=a===r?ie:a>>>0,a?(e=it(e),e&&(typeof i=="string"||i!=null&&!ic(i))&&(i=mr(i),!i&&un(e))?Di(jr(e),0,a):e.split(i,a)):[]}var J_=_n(function(e,i,a){return e+(a?" ":"")+ac(i)});function X_(e,i,a){return e=it(e),a=a==null?0:qi(Me(a),0,e.length),i=mr(i),e.slice(a,a+i.length)==i}function Q_(e,i,a){var u=E.templateSettings;a&&ir(e,i,a)&&(i=r),e=it(e),i=_a({},i,u,Th);var g=_a({},i.imports,u.imports,Th),D=Kt(g),A=_o(g,D),U,q,Z=0,ee=i.interpolate||en,ne="__p += '",ue=mo((i.escape||en).source+"|"+ee.source+"|"+(ee===vt?Ka:en).source+"|"+(i.evaluate||en).source+"|$","g"),ye="//# sourceURL="+(nt.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++co+"]")+`
`;e.replace(ue,function(De,We,Qe,wr,nr,Er){return Qe||(Qe=wr),ne+=e.slice(Z,Er).replace(Ja,Op),We&&(U=!0,ne+=`' +
__e(`+We+`) +
'`),nr&&(q=!0,ne+=`';
`+nr+`;
__p += '`),Qe&&(ne+=`' +
((__t = (`+Qe+`)) == null ? '' : __t) +
'`),Z=Er+De.length,De}),ne+=`';
`;var Ee=nt.call(i,"variable")&&i.variable;if(!Ee)ne=`with (obj) {
`+ne+`
}
`;else if(za.test(Ee))throw new Pe(f);ne=(q?ne.replace(Vr,""):ne).replace(er,"$1").replace(ti,"$1;"),ne="function("+(Ee||"obj")+`) {
`+(Ee?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(U?", __e = _.escape":"")+(q?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ne+`return __p
}`;var Be=Dl(function(){return rt(D,ye+"return "+ne).apply(r,A)});if(Be.source=ne,rc(Be))throw Be;return Be}function Z_(e){return it(e).toLowerCase()}function ev(e){return it(e).toUpperCase()}function tv(e,i,a){if(e=it(e),e&&(a||i===r))return Nu(e);if(!e||!(i=mr(i)))return e;var u=jr(e),g=jr(i),D=Uu(u,g),A=Ru(u,g)+1;return Di(u,D,A).join("")}function rv(e,i,a){if(e=it(e),e&&(a||i===r))return e.slice(0,$u(e)+1);if(!e||!(i=mr(i)))return e;var u=jr(e),g=Ru(u,jr(i))+1;return Di(u,0,g).join("")}function iv(e,i,a){if(e=it(e),e&&(a||i===r))return e.replace(St,"");if(!e||!(i=mr(i)))return e;var u=jr(e),g=Uu(u,jr(i));return Di(u,g).join("")}function nv(e,i){var a=G,u=se;if(mt(i)){var g="separator"in i?i.separator:g;a="length"in i?Me(i.length):a,u="omission"in i?mr(i.omission):u}e=it(e);var D=e.length;if(un(e)){var A=jr(e);D=A.length}if(a>=D)return e;var U=a-hn(u);if(U<1)return u;var q=A?Di(A,0,U).join(""):e.slice(0,U);if(g===r)return q+u;if(A&&(U+=q.length-U),ic(g)){if(e.slice(U).search(g)){var Z,ee=q;for(g.global||(g=mo(g.source,it(Sr.exec(g))+"g")),g.lastIndex=0;Z=g.exec(ee);)var ne=Z.index;q=q.slice(0,ne===r?U:ne)}}else if(e.indexOf(mr(g),U)!=U){var ue=q.lastIndexOf(g);ue>-1&&(q=q.slice(0,ue))}return q+u}function sv(e){return e=it(e),e&&bt.test(e)?e.replace(pi,Rp):e}var av=_n(function(e,i,a){return e+(a?" ":"")+i.toUpperCase()}),ac=Sh("toUpperCase");function El(e,i,a){return e=it(e),i=a?r:i,i===r?Cp(e)?Lp(e):bp(e):e.match(i)||[]}var Dl=Ke(function(e,i){try{return Ht(e,r,i)}catch(a){return rc(a)?a:new Pe(a)}}),ov=ci(function(e,i){return xr(i,function(a){a=Jr(a),ai(e,a,ec(e[a],e))}),e});function cv(e){var i=e==null?0:e.length,a=me();return e=i?_t(e,function(u){if(typeof u[1]!="function")throw new Or(m);return[a(u[0]),u[1]]}):[],Ke(function(u){for(var g=-1;++g<i;){var D=e[g];if(Ht(D[0],this,u))return Ht(D[1],this,u)}})}function uv(e){return Rg(Cr(e,P))}function oc(e){return function(){return e}}function hv(e,i){return e==null||e!==e?i:e}var lv=xh(),fv=xh(!0);function pr(e){return e}function cc(e){return rh(typeof e=="function"?e:Cr(e,P))}function dv(e){return nh(Cr(e,P))}function pv(e,i){return sh(e,Cr(i,P))}var gv=Ke(function(e,i){return function(a){return jn(a,e,i)}}),yv=Ke(function(e,i){return function(a){return jn(e,a,i)}});function uc(e,i,a){var u=Kt(i),g=Qs(i,u);a==null&&!(mt(i)&&(g.length||!u.length))&&(a=i,i=e,e=this,g=Qs(i,Kt(i)));var D=!(mt(a)&&"chain"in a)||!!a.chain,A=hi(e);return xr(g,function(U){var q=i[U];e[U]=q,A&&(e.prototype[U]=function(){var Z=this.__chain__;if(D||Z){var ee=e(this.__wrapped__),ne=ee.__actions__=lr(this.__actions__);return ne.push({func:q,args:arguments,thisArg:e}),ee.__chain__=Z,ee}return q.apply(e,_i([this.value()],arguments))})}),e}function _v(){return Xe._===this&&(Xe._=Hp),this}function hc(){}function vv(e){return e=Me(e),Ke(function(i){return ah(i,e)})}var mv=Bo(_t),bv=Bo(Ou),wv=Bo(lo);function Sl(e){return Go(e)?fo(Jr(e)):Xg(e)}function Ev(e){return function(i){return e==null?r:Bi(e,i)}}var Dv=Ah(),Sv=Ah(!0);function lc(){return[]}function fc(){return!1}function Iv(){return{}}function xv(){return""}function Ov(){return!0}function Av(e,i){if(e=Me(e),e<1||e>k)return[];var a=ie,u=Jt(e,ie);i=me(i),e-=ie;for(var g=yo(u,i);++a<e;)i(a);return g}function Cv(e){return Ne(e)?_t(e,Jr):br(e)?[e]:lr(Kh(it(e)))}function Pv(e){var i=++Bp;return it(e)+i}var Tv=na(function(e,i){return e+i},0),Nv=zo("ceil"),Uv=na(function(e,i){return e/i},1),Rv=zo("floor");function Fv(e){return e&&e.length?Xs(e,pr,Oo):r}function $v(e,i){return e&&e.length?Xs(e,me(i,2),Oo):r}function Lv(e){return Pu(e,pr)}function Mv(e,i){return Pu(e,me(i,2))}function jv(e){return e&&e.length?Xs(e,pr,To):r}function qv(e,i){return e&&e.length?Xs(e,me(i,2),To):r}var Bv=na(function(e,i){return e*i},1),zv=zo("round"),Hv=na(function(e,i){return e-i},0);function Kv(e){return e&&e.length?go(e,pr):0}function Vv(e,i){return e&&e.length?go(e,me(i,2)):0}return E.after=dy,E.ary=tl,E.assign=e_,E.assignIn=gl,E.assignInWith=_a,E.assignWith=t_,E.at=r_,E.before=rl,E.bind=ec,E.bindAll=ov,E.bindKey=il,E.castArray=Iy,E.chain=Qh,E.chunk=R0,E.compact=F0,E.concat=$0,E.cond=cv,E.conforms=uv,E.constant=oc,E.countBy=K1,E.create=i_,E.curry=nl,E.curryRight=sl,E.debounce=al,E.defaults=n_,E.defaultsDeep=s_,E.defer=py,E.delay=gy,E.difference=L0,E.differenceBy=M0,E.differenceWith=j0,E.drop=q0,E.dropRight=B0,E.dropRightWhile=z0,E.dropWhile=H0,E.fill=K0,E.filter=k1,E.flatMap=Y1,E.flatMapDeep=J1,E.flatMapDepth=X1,E.flatten=Gh,E.flattenDeep=V0,E.flattenDepth=k0,E.flip=yy,E.flow=lv,E.flowRight=fv,E.fromPairs=W0,E.functions=f_,E.functionsIn=d_,E.groupBy=Q1,E.initial=Y0,E.intersection=J0,E.intersectionBy=X0,E.intersectionWith=Q0,E.invert=g_,E.invertBy=y_,E.invokeMap=ey,E.iteratee=cc,E.keyBy=ty,E.keys=Kt,E.keysIn=dr,E.map=la,E.mapKeys=v_,E.mapValues=m_,E.matches=dv,E.matchesProperty=pv,E.memoize=da,E.merge=b_,E.mergeWith=yl,E.method=gv,E.methodOf=yv,E.mixin=uc,E.negate=pa,E.nthArg=vv,E.omit=w_,E.omitBy=E_,E.once=_y,E.orderBy=ry,E.over=mv,E.overArgs=vy,E.overEvery=bv,E.overSome=wv,E.partial=tc,E.partialRight=ol,E.partition=iy,E.pick=D_,E.pickBy=_l,E.property=Sl,E.propertyOf=Ev,E.pull=r1,E.pullAll=Jh,E.pullAllBy=i1,E.pullAllWith=n1,E.pullAt=s1,E.range=Dv,E.rangeRight=Sv,E.rearg=my,E.reject=ay,E.remove=a1,E.rest=by,E.reverse=Qo,E.sampleSize=cy,E.set=I_,E.setWith=x_,E.shuffle=uy,E.slice=o1,E.sortBy=fy,E.sortedUniq=p1,E.sortedUniqBy=g1,E.split=Y_,E.spread=wy,E.tail=y1,E.take=_1,E.takeRight=v1,E.takeRightWhile=m1,E.takeWhile=b1,E.tap=F1,E.throttle=Ey,E.thru=ha,E.toArray=fl,E.toPairs=vl,E.toPairsIn=ml,E.toPath=Cv,E.toPlainObject=pl,E.transform=O_,E.unary=Dy,E.union=w1,E.unionBy=E1,E.unionWith=D1,E.uniq=S1,E.uniqBy=I1,E.uniqWith=x1,E.unset=A_,E.unzip=Zo,E.unzipWith=Xh,E.update=C_,E.updateWith=P_,E.values=bn,E.valuesIn=T_,E.without=O1,E.words=El,E.wrap=Sy,E.xor=A1,E.xorBy=C1,E.xorWith=P1,E.zip=T1,E.zipObject=N1,E.zipObjectDeep=U1,E.zipWith=R1,E.entries=vl,E.entriesIn=ml,E.extend=gl,E.extendWith=_a,uc(E,E),E.add=Tv,E.attempt=Dl,E.camelCase=F_,E.capitalize=bl,E.ceil=Nv,E.clamp=N_,E.clone=xy,E.cloneDeep=Ay,E.cloneDeepWith=Cy,E.cloneWith=Oy,E.conformsTo=Py,E.deburr=wl,E.defaultTo=hv,E.divide=Uv,E.endsWith=$_,E.eq=Br,E.escape=L_,E.escapeRegExp=M_,E.every=V1,E.find=W1,E.findIndex=kh,E.findKey=a_,E.findLast=G1,E.findLastIndex=Wh,E.findLastKey=o_,E.floor=Rv,E.forEach=Zh,E.forEachRight=el,E.forIn=c_,E.forInRight=u_,E.forOwn=h_,E.forOwnRight=l_,E.get=nc,E.gt=Ty,E.gte=Ny,E.has=p_,E.hasIn=sc,E.head=Yh,E.identity=pr,E.includes=Z1,E.indexOf=G0,E.inRange=U_,E.invoke=__,E.isArguments=Ki,E.isArray=Ne,E.isArrayBuffer=Uy,E.isArrayLike=fr,E.isArrayLikeObject=Pt,E.isBoolean=Ry,E.isBuffer=Si,E.isDate=Fy,E.isElement=$y,E.isEmpty=Ly,E.isEqual=My,E.isEqualWith=jy,E.isError=rc,E.isFinite=qy,E.isFunction=hi,E.isInteger=cl,E.isLength=ga,E.isMap=ul,E.isMatch=By,E.isMatchWith=zy,E.isNaN=Hy,E.isNative=Ky,E.isNil=ky,E.isNull=Vy,E.isNumber=hl,E.isObject=mt,E.isObjectLike=xt,E.isPlainObject=Vn,E.isRegExp=ic,E.isSafeInteger=Wy,E.isSet=ll,E.isString=ya,E.isSymbol=br,E.isTypedArray=mn,E.isUndefined=Gy,E.isWeakMap=Yy,E.isWeakSet=Jy,E.join=Z0,E.kebabCase=j_,E.last=Tr,E.lastIndexOf=e1,E.lowerCase=q_,E.lowerFirst=B_,E.lt=Xy,E.lte=Qy,E.max=Fv,E.maxBy=$v,E.mean=Lv,E.meanBy=Mv,E.min=jv,E.minBy=qv,E.stubArray=lc,E.stubFalse=fc,E.stubObject=Iv,E.stubString=xv,E.stubTrue=Ov,E.multiply=Bv,E.nth=t1,E.noConflict=_v,E.noop=hc,E.now=fa,E.pad=z_,E.padEnd=H_,E.padStart=K_,E.parseInt=V_,E.random=R_,E.reduce=ny,E.reduceRight=sy,E.repeat=k_,E.replace=W_,E.result=S_,E.round=zv,E.runInContext=j,E.sample=oy,E.size=hy,E.snakeCase=G_,E.some=ly,E.sortedIndex=c1,E.sortedIndexBy=u1,E.sortedIndexOf=h1,E.sortedLastIndex=l1,E.sortedLastIndexBy=f1,E.sortedLastIndexOf=d1,E.startCase=J_,E.startsWith=X_,E.subtract=Hv,E.sum=Kv,E.sumBy=Vv,E.template=Q_,E.times=Av,E.toFinite=li,E.toInteger=Me,E.toLength=dl,E.toLower=Z_,E.toNumber=Nr,E.toSafeInteger=Zy,E.toString=it,E.toUpper=ev,E.trim=tv,E.trimEnd=rv,E.trimStart=iv,E.truncate=nv,E.unescape=sv,E.uniqueId=Pv,E.upperCase=av,E.upperFirst=ac,E.each=Zh,E.eachRight=el,E.first=Yh,uc(E,function(){var e={};return Gr(E,function(i,a){nt.call(E.prototype,a)||(e[a]=i)}),e}(),{chain:!1}),E.VERSION=s,xr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){E[e].placeholder=E}),xr(["drop","take"],function(e,i){Ye.prototype[e]=function(a){a=a===r?1:zt(Me(a),0);var u=this.__filtered__&&!i?new Ye(this):this.clone();return u.__filtered__?u.__takeCount__=Jt(a,u.__takeCount__):u.__views__.push({size:Jt(a,ie),type:e+(u.__dir__<0?"Right":"")}),u},Ye.prototype[e+"Right"]=function(a){return this.reverse()[e](a).reverse()}}),xr(["filter","map","takeWhile"],function(e,i){var a=i+1,u=a==S||a==te;Ye.prototype[e]=function(g){var D=this.clone();return D.__iteratees__.push({iteratee:me(g,3),type:a}),D.__filtered__=D.__filtered__||u,D}}),xr(["head","last"],function(e,i){var a="take"+(i?"Right":"");Ye.prototype[e]=function(){return this[a](1).value()[0]}}),xr(["initial","tail"],function(e,i){var a="drop"+(i?"":"Right");Ye.prototype[e]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(pr)},Ye.prototype.find=function(e){return this.filter(e).head()},Ye.prototype.findLast=function(e){return this.reverse().find(e)},Ye.prototype.invokeMap=Ke(function(e,i){return typeof e=="function"?new Ye(this):this.map(function(a){return jn(a,e,i)})}),Ye.prototype.reject=function(e){return this.filter(pa(me(e)))},Ye.prototype.slice=function(e,i){e=Me(e);var a=this;return a.__filtered__&&(e>0||i<0)?new Ye(a):(e<0?a=a.takeRight(-e):e&&(a=a.drop(e)),i!==r&&(i=Me(i),a=i<0?a.dropRight(-i):a.take(i-e)),a)},Ye.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ye.prototype.toArray=function(){return this.take(ie)},Gr(Ye.prototype,function(e,i){var a=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),g=E[u?"take"+(i=="last"?"Right":""):i],D=u||/^find/.test(i);g&&(E.prototype[i]=function(){var A=this.__wrapped__,U=u?[1]:arguments,q=A instanceof Ye,Z=U[0],ee=q||Ne(A),ne=function(We){var Qe=g.apply(E,_i([We],U));return u&&ue?Qe[0]:Qe};ee&&a&&typeof Z=="function"&&Z.length!=1&&(q=ee=!1);var ue=this.__chain__,ye=!!this.__actions__.length,Ee=D&&!ue,Be=q&&!ye;if(!D&&ee){A=Be?A:new Ye(this);var De=e.apply(A,U);return De.__actions__.push({func:ha,args:[ne],thisArg:r}),new Ar(De,ue)}return Ee&&Be?e.apply(this,U):(De=this.thru(ne),Ee?u?De.value()[0]:De.value():De)})}),xr(["pop","push","shift","sort","splice","unshift"],function(e){var i=$s[e],a=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);E.prototype[e]=function(){var g=arguments;if(u&&!this.__chain__){var D=this.value();return i.apply(Ne(D)?D:[],g)}return this[a](function(A){return i.apply(Ne(A)?A:[],g)})}}),Gr(Ye.prototype,function(e,i){var a=E[i];if(a){var u=a.name+"";nt.call(pn,u)||(pn[u]=[]),pn[u].push({name:i,func:a})}}),pn[ia(r,Q).name]=[{name:"wrapper",func:r}],Ye.prototype.clone=sg,Ye.prototype.reverse=ag,Ye.prototype.value=og,E.prototype.at=$1,E.prototype.chain=L1,E.prototype.commit=M1,E.prototype.next=j1,E.prototype.plant=B1,E.prototype.reverse=z1,E.prototype.toJSON=E.prototype.valueOf=E.prototype.value=H1,E.prototype.first=E.prototype.head,Nn&&(E.prototype[Nn]=q1),E},ln=Mp();Ct?((Ct.exports=ln)._=ln,ct._=ln):Xe._=ln}).call(is)})(Gc,Gc.exports);var b2=Object.defineProperty,w2=Object.defineProperties,E2=Object.getOwnPropertyDescriptors,Jf=Object.getOwnPropertySymbols,D2=Object.prototype.hasOwnProperty,S2=Object.prototype.propertyIsEnumerable,Xf=(n,t,r)=>t in n?b2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,ma=(n,t)=>{for(var r in t||(t={}))D2.call(t,r)&&Xf(n,r,t[r]);if(Jf)for(var r of Jf(t))S2.call(t,r)&&Xf(n,r,t[r]);return n},I2=(n,t)=>w2(n,E2(t));function Fr(n,t,r){let s;const o=Yc(n);return t.rpcMap&&(s=t.rpcMap[o]),s||(s=`${m2}?chainId=eip155:${o}&projectId=${r}`),s}function Yc(n){return n.includes("eip155")?Number(n.split(":")[1]):Number(n)}function x2(n,t){if(!t.includes(n))throw new Error(`Chain '${n}' not approved. Please use one of the following: ${t.toString()}`)}function O2(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function A2(n,t){const r=Object.keys(t.namespaces).filter(o=>o.includes(n));if(!r.length)return[];const s=[];return r.forEach(o=>{const l=t.namespaces[o].accounts;s.push(...l)}),s}function C2(n,t={}){const r=Qf(n),s=Qf(t);return Gc.exports.merge(r,s)}function Qf(n){var t,r,s,o;const l={};if(!f2(n))return l;for(const[m,f]of Object.entries(n)){const w=dp(m)?[m]:f.chains,O=f.methods||[],I=f.events||[],P=f.rpcMap||{},$=Da(m);l[$]=I2(ma(ma({},l[$]),f),{chains:Cc(w,(t=l[$])==null?void 0:t.chains),methods:Cc(O,(r=l[$])==null?void 0:r.methods),events:Cc(I,(s=l[$])==null?void 0:s.events),rpcMap:ma(ma({},P),(o=l[$])==null?void 0:o.rpcMap)})}return l}const pp={},Nt=n=>pp[n],Pc=(n,t)=>{pp[n]=t};class P2{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Nt("events"),this.client=Nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Fr(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Fr(t,this.namespace);return typeof s>"u"?void 0:new Ci(new Zi(s,Nt("disableProviderPing")))}}class T2{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Nt("events"),this.client=Nt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){var r;switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return this.handleSwitchChain(t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0"),null;case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){const s=Yc(t);if(!this.httpProviders[s]){const o=r||Fr(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,o)}this.chainId=s,this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||Fr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ci(new Zi(s,Nt("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=Yc(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}handleSwitchChain(t){const r=parseInt(t,16),s=`${this.name}:${r}`;x2(s,this.namespace.chains),this.setDefaultChain(`${r}`)}}class N2{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Nt("events"),this.client=Nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Fr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Fr(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ci(new Zi(s,Nt("disableProviderPing")))}}class U2{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Nt("events"),this.client=Nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Fr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Fr(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ci(new Zi(s,Nt("disableProviderPing")))}}class R2{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Nt("events"),this.client=Nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r);t[r]=this.createHttpProvider(r,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);return typeof s>"u"?void 0:new Ci(new Zi(s,Nt("disableProviderPing")))}}class F2{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Nt("events"),this.client=Nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Fr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Fr(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ci(new Zi(s,Nt("disableProviderPing")))}}class $2{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Nt("events"),this.client=Nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Fr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Fr(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ci(new Zi(s,Nt("disableProviderPing")))}}var L2=Object.defineProperty,M2=Object.defineProperties,j2=Object.getOwnPropertyDescriptors,Zf=Object.getOwnPropertySymbols,q2=Object.prototype.hasOwnProperty,B2=Object.prototype.propertyIsEnumerable,ed=(n,t,r)=>t in n?L2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,ba=(n,t)=>{for(var r in t||(t={}))q2.call(t,r)&&ed(n,r,t[r]);if(Zf)for(var r of Zf(t))B2.call(t,r)&&ed(n,r,t[r]);return n},Tc=(n,t)=>M2(n,j2(t));class Iu{constructor(t){this.events=new Zc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Gf})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new Iu(t);return await r.initialize(),r}async request(t,r){const[s,o]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:ba({},t),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(o=>r(null,o)).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Kf("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(l=>{this.session=l}).catch(l=>{if(l.message!==lp)throw l;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{const[s,o]=this.validateChain(t);this.getProvider(s).setDefaultChain(o,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(l2(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await o2.init({logger:this.providerOpts.logger||Gf,relayUrl:this.providerOpts.relayUrl||y2,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>Da(r)))];Pc("client",this.client),Pc("events",this.events),Pc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=A2(r,this.session),o=O2(s),l=C2(this.namespaces,this.optionalNamespaces),m=Tc(ba({},l[r]),{accounts:s,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new T2({namespace:m});break;case"solana":this.rpcProviders[r]=new N2({namespace:m});break;case"cosmos":this.rpcProviders[r]=new U2({namespace:m});break;case"polkadot":this.rpcProviders[r]=new P2({namespace:m});break;case"cip34":this.rpcProviders[r]=new R2({namespace:m});break;case"elrond":this.rpcProviders[r]=new F2({namespace:m});break;case"multiversx":this.rpcProviders[r]=new $2({namespace:m});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?this.events.emit("accountsChanged",s.data):s.name==="chainChanged"?this.onChainChanged(r.chainId):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:o}=r,l=(s=this.client)==null?void 0:s.session.get(t);this.session=Tc(ba({},l),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Tc(ba({},Kf("USER_DISCONNECTED")),{data:t.topic}))}),this.on(Pi.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:o}=t;if(!r||!Object.keys(r).length)throw new Error("Namespaces must be not empty");this.namespaces=r,this.optionalNamespaces=s,this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(r&&!Object.keys(this.namespaces).map(m=>Da(m)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const o=Da(Object.keys(this.namespaces)[0]),l=this.rpcProviders[o].getDefaultChain();return[o,l]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;const[o,l]=this.validateChain(t);r||this.getProvider(o).setDefaultChain(l),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${l}`]).defaultChain=l,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",l)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Yf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Yf}/${t}`)}}const z2=Iu,H2="wc",K2="ethereum_provider",V2=`${H2}@2:${K2}:`,k2="https://rpc.walletconnect.com/v1/",Jc=["eth_sendTransaction","personal_sign"],dS=["eth_accounts","eth_requestAccounts","eth_call","eth_getBalance","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Xc=["chainChanged","accountsChanged"],pS=["message","disconnect","connect"];var W2=Object.defineProperty,G2=Object.defineProperties,Y2=Object.getOwnPropertyDescriptors,td=Object.getOwnPropertySymbols,J2=Object.prototype.hasOwnProperty,X2=Object.prototype.propertyIsEnumerable,rd=(n,t,r)=>t in n?W2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Nc=(n,t)=>{for(var r in t||(t={}))J2.call(t,r)&&rd(n,r,t[r]);if(td)for(var r of td(t))X2.call(t,r)&&rd(n,r,t[r]);return n},id=(n,t)=>G2(n,Y2(t));function Qc(n){return Number(n[0].split(":")[1])}function Uc(n){return`0x${n.toString(16)}`}function Q2(n){const{chains:t,optionalChains:r,methods:s,optionalMethods:o,events:l,optionalEvents:m,rpcMap:f}=n;if(!qc(t))throw new Error("Invalid chains");const w=t,O=s||Jc,I=l||Xc,P={[Qc(w)]:f[Qc(w)]},$={chains:w,methods:O,events:I,rpcMap:P},R=l==null?void 0:l.filter(Q=>!Xc.includes(Q)),N=s==null?void 0:s.filter(Q=>!Jc.includes(Q));if(!r&&!m&&!o&&!(R!=null&&R.length)&&!(N!=null&&N.length))return{required:$};const z=(R==null?void 0:R.length)&&(N==null?void 0:N.length)||!r,L={chains:[...new Set(z?w.concat(r||[]):r)],methods:[...new Set(O.concat(o||[]))],events:[...new Set(I.concat(m||[]))],rpcMap:f};return{required:$,optional:L}}class xu{constructor(){this.events=new $r.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=V2,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new xu;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=Q2(this.rpc);try{const o=await new Promise(async(m,f)=>{var w;this.rpc.showQrModal&&((w=this.modal)==null||w.subscribeModal(O=>{!O.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(id(Nc({namespaces:{[this.namespace]:r}},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(O=>{m(O)}).catch(O=>{f(new Error(O.message))})});if(!o)return;this.setChainIds(this.rpc.chains);const l=Zb(o.namespaces,[this.namespace]);this.setAccounts(l),this.events.emit("connect",{chainId:Uc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",Uc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",id(Nc({},tw("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}setHttpProvider(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Uc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.setHttpProvider(r)}}parseAccountId(t){const[r,s,o]=t.split(":");return{chainId:`${r}:${s}`,address:o}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;return{chains:((r=t.chains)==null?void 0:r.map(o=>this.formatChainId(o)))||[`${this.namespace}:1`],optionalChains:t.optionalChains?t.optionalChains.map(o=>this.formatChainId(o)):void 0,methods:(t==null?void 0:t.methods)||Jc,events:(t==null?void 0:t.events)||Xc,optionalMethods:(t==null?void 0:t.optionalMethods)||[],optionalEvents:(t==null?void 0:t.optionalEvents)||[],rpcMap:(t==null?void 0:t.rpcMap)||this.buildRpcMap(t.chains.concat(t.optionalChains||[]),t.projectId),showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:(s=t==null?void 0:t.qrModalOptions)!=null?s:void 0,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(o=>{s[o]=this.getRpcUrl(o,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=Qc(this.rpc.chains),this.signer=await z2.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await Gv(()=>import("./index.es-823c8e3f.js").then(o=>o.i),["assets/index.es-823c8e3f.js","assets/index-0fa04194.js","assets/index-f512a740.css","assets/index-3aa13386.js"]);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Nc({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:o}=t;r&&qc(r)&&(this.rpc.chains=r.map(l=>this.formatChainId(l)),r.forEach(l=>{this.rpc.rpcMap[l]=(o==null?void 0:o[l])||this.getRpcUrl(l)})),s&&qc(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(l=>this.formatChainId(l)),s.forEach(l=>{this.rpc.rpcMap[l]=(o==null?void 0:o[l])||this.getRpcUrl(l)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${k2}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`);this.setChainIds(t?[this.formatChainId(t)]:this.session.namespaces[this.namespace].accounts),this.setAccounts(this.session.namespaces[this.namespace].accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const gS=xu;export{gS as EthereumProvider,pS as OPTIONAL_EVENTS,dS as OPTIONAL_METHODS,Xc as REQUIRED_EVENTS,Jc as REQUIRED_METHODS,xu as default};
